(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-08f3211b"],{"10a2":function(e,t,r){"use strict";var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-modal",{attrs:{title:e.title,width:640,maskClosable:!1,visible:e.visible,confirmLoading:e.spinning,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:function(t){e.handleSubmit(t)},cancel:function(){e.$emit("cancel")}}},[r("a-spin",{attrs:{spinning:e.spinning}},[r("a-form",e._b({attrs:{form:e.form},on:{submit:e.handleSubmit}},"a-form",e.formLayout,!1),[r("div",{staticClass:"item"},[r("a-form-item",{attrs:{label:"会员名称"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["teamName",{initialValue:e.member.teamName,rules:[{required:!0,whitespace:!0,max:16,message:"请输入长度不大于16的字符"},{validator:e.checkName}]}],expression:"['teamName', { initialValue: member.teamName, rules: [{ required: true, whitespace: true, max: 16, message: '请输入长度不大于16的字符' }, { validator: checkName }] }]"}],attrs:{placeholder:"给你的Club会员设置专属称号吧","allow-clear":""}})],1),r("a-form-item",{attrs:{label:"划线价格",extra:""}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["originalPrice",{initialValue:e.originalPrice,rules:[{required:!0,whitespace:!0,type:"number",transform:e.transformInputNumber,min:.01,message:"请输入不小于0.01的数字"}]}],expression:"['originalPrice', { initialValue: originalPrice, rules: [\n              { required: true, whitespace: true, type:'number', transform: transformInputNumber, min: 0.01, message: '请输入不小于0.01的数字' }\n            ] }]"}],attrs:{placeholder:"请输入划线价格，最小0.01","allow-clear":"","addon-after":"元"},on:{change:e.onPriceInput}})],1),r("a-form-item",{attrs:{label:"实付价格",extra:""}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["price",{initialValue:e.price,rules:[{required:!0,whitespace:!0,type:"number",transform:e.transformInputNumber,min:.01,message:"请输入不小于0.01的数字"}]}],expression:"['price', { initialValue: price, rules: [\n              { required: true, whitespace: true, type:'number', transform: transformInputNumber, min: 0.01, message: '请输入不小于0.01的数字' }\n            ] }]"}],attrs:{placeholder:"请输入实付价格，最小0.01","allow-clear":"","addon-after":"元"}})],1),10===e.recruitType?r("a-form-item",{attrs:{label:"服务时长"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["serviceExpireDay",{initialValue:e.member.serviceExpireDay,rules:[{required:!0,whitespace:!0,type:"integer",transform:e.transformInputNumber,min:1,message:"请输入大于1的整数"}]}],expression:"['serviceExpireDay', { initialValue: member.serviceExpireDay, rules: [\n              { required: true, whitespace: true, type:'integer', transform: transformInputNumber, min: 1, message: '请输入大于1的整数' }\n            ] }]"}],attrs:{placeholder:"请输入服务天数","allow-clear":"","addon-after":"天"},on:{change:e.onServiceExpireDay}})],1):e._e(),20===e.recruitType?r("a-form-item",{attrs:{label:"到期时间"}},[r("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["serviceEndTime",{initialValue:e.member.serviceEndTime,rules:[{required:!0,message:"必填"},{validator:e.checkInputTime}]}],expression:"['serviceEndTime', { initialValue: member.serviceEndTime, rules: [{ required: true, message: '必填' }, { validator: checkInputTime }] }]"}],ref:"serviceEndTime",staticStyle:{width:"200px"},attrs:{disabled:1===e.editType,placeholder:"请选择到期时间",format:"YYYY-MM-DD HH:mm:ss",valueFormat:"YYYY-MM-DD HH:mm:ss","allow-clear":"","disabled-date":e.disabledDate}})],1):e._e(),r("a-form-item",{attrs:{label:"招募人数",extra:"不填表示不限制人数"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["recruitNumLimit",{initialValue:e.recruitNumLimit,rules:[{required:!1,whitespace:!1,message:"请输入大于等于0的整数"},{validator:e.checkNumber}]}],expression:"['recruitNumLimit', { initialValue: recruitNumLimit, rules: [\n              { required: false, whitespace: false, message: '请输入大于等于0的整数' }, { validator: checkNumber }\n            ] }]"}],attrs:{placeholder:"请输入招募的人数上限","allow-clear":""}})],1),r("a-form-item",{attrs:{label:"会员分组名称"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["inGroupName",{initialValue:e.member.inGroupName,rules:[{required:!0,whitespace:!0,message:"必填"},{validator:e.checkName}]}],expression:"['inGroupName', { initialValue: member.inGroupName, rules: [{ required: true, whitespace: true, message: '必填' }, { validator: checkName }] }]"}],attrs:{placeholder:"请输入会员用户组名称","allow-clear":""},on:{focus:e.onGroupNameFocus}})],1),r("a-form-item",{attrs:{label:"会员到期后移入"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["outGroupId",{initialValue:e.member.outGroupId||0,rules:[{required:!0,message:"必填"}]}],expression:"['outGroupId', { initialValue: member.outGroupId || 0, rules: [{ required: true, message: '必填' }] }]"}],attrs:{placeholder:"请选择",options:e.freeGroupList}})],1),r("a-form-item",{attrs:{label:"开放购买"}},[r("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isOpenPay",{initialValue:e.isOpenPay,rules:[{required:!0,message:"必填"}]}],expression:"['isOpenPay', { initialValue: isOpenPay, rules: [{ required: true, message: '必填' }] }]"}]},[r("a-radio",{key:"2",attrs:{value:1}},[e._v("开启")]),r("a-radio",{key:"1",attrs:{value:0}},[e._v("关闭")])],1)],1)],1),r("a-divider",{staticClass:"title",attrs:{orientation:"left"}},[e._v("续费设置")]),r("a-form-item",{attrs:{label:"开放续费"}},[r("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isRenewal",{initialValue:e.isRenewal,rules:[{required:!0,message:"必填"}]}],expression:"['isRenewal', { initialValue: isRenewal, rules: [{ required: true, message: '必填' }] }]"}],on:{change:e.onRenewalChange}},[r("a-radio",{key:"2",attrs:{value:1}},[e._v("开启")]),r("a-radio",{key:"1",attrs:{value:0}},[e._v("关闭")])],1)],1),e.isRenewal?r("div",[r("a-form-item",e._b({attrs:{label:"续费折扣面值"}},"a-form-item",e.formLayout,!1),[r("a-tooltip",{attrs:{title:e.originalPrice?"":"请先设置【划线价格】"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["renewalDiscountValue",{initialValue:e.discountValue,rules:[{required:!0,whitespace:!0,type:"number",transform:e.transformInputNumber,min:e.discountLimitMin,max:e.discountLimitMax,message:"请输入"+e.discountLimitMin+"~"+e.discountLimitMax+"的数字"}]}],expression:"['renewalDiscountValue', { initialValue: discountValue, rules: [{ required: true, whitespace: true, type:'number', transform: transformInputNumber, min: discountLimitMin, max: discountLimitMax, message: `请输入${discountLimitMin}~${discountLimitMax}的数字` }] }]"}],attrs:{placeholder:"请输入","allow-clear":"",disabled:!e.originalPrice,"addon-before":e.discountTypeStr,"addon-after":e.discountTypeUnit},on:{change:e.onDiscountInput}})],1)],1),r("a-form-item",e._b({attrs:{label:"续费实付价格"}},"a-form-item",e.formLayout,!1),[r("span",[e._v(e._s(e.discountPriceStr))])]),r("a-form-item",{staticClass:"form-item sub-item"},[r("span",{attrs:{slot:"label"},slot:"label"},[e._v(" 开启续费按钮 "),r("a-tooltip",{attrs:{title:"用户可以在会员到期前的N天内通过续费按钮进行续费"}},[r("a-icon",{attrs:{type:"question-circle-o"}})],1)],1),r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["renewalDay",{initialValue:e.member.renewalDay,rules:[e.genValidatorRules({required:!1,type:"integer",min:1,max:e.serviceExpireDay})]}],expression:"['renewalDay', { initialValue: member.renewalDay, rules: [genValidatorRules({ required: false, type: 'integer', min: 1, max: serviceExpireDay })] }]"}],attrs:{placeholder:"请输入","allow-clear":"","addon-before":"会员到期前","addon-after":"天"}})],1)],1):e._e(),e.serviceExpireDay>3?r("div",[r("a-divider",{staticClass:"title",attrs:{orientation:"left"}},[e._v("到期提醒")]),r("a-form-item",{staticClass:"form-item sub-item",staticStyle:{"margin-bottom":"0"}},[r("span",{attrs:{slot:"label"},slot:"label"},[e._v(" 会员到期提醒 "),r("a-tooltip",{attrs:{title:"系统会在用户会员到期前的3、2、1天通过微信推送到期提醒，此外还能最多设置3个提醒时间"}},[r("a-icon",{attrs:{type:"question-circle-o"}})],1)],1),r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["expireDays.0",{initialValue:e.expireDays[0],rules:[e.genValidatorRules({required:!1,type:"integer",min:4,max:e.serviceExpireDay})]}],expression:"['expireDays.0', { initialValue: expireDays[0], rules: [genValidatorRules({ required: false, type: 'integer', min: 4, max: serviceExpireDay })] }]"}],attrs:{placeholder:"请输入","allow-clear":"","addon-before":"会员到期前","addon-after":"天"}})],1),r("a-form-item",{staticClass:"form-item sub-item",staticStyle:{"margin-bottom":"0"},attrs:{label:" ",colon:!1}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["expireDays.1",{initialValue:e.expireDays[1],rules:[e.genValidatorRules({required:!1,type:"integer",min:4,max:e.serviceExpireDay})]}],expression:"['expireDays.1', { initialValue: expireDays[1], rules: [genValidatorRules({ required: false, type: 'integer', min: 4, max: serviceExpireDay })] }]"}],attrs:{placeholder:"请输入","allow-clear":"","addon-before":"会员到期前","addon-after":"天"}})],1),r("a-form-item",{staticClass:"form-item sub-item",attrs:{label:" ",colon:!1}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["expireDays.2",{initialValue:e.expireDays[2],rules:[e.genValidatorRules({required:!1,type:"integer",min:4,max:e.serviceExpireDay})]}],expression:"['expireDays.2', { initialValue: expireDays[2], rules: [genValidatorRules({ required: false, type: 'integer', min: 4, max: serviceExpireDay })] }]"}],attrs:{placeholder:"请输入","allow-clear":"","addon-before":"会员到期前","addon-after":"天"}})],1)],1):e._e(),r("a-divider",{staticClass:"title",attrs:{orientation:"left"}},[e._v("推广设置")]),r("div",{staticClass:"item"},[r("a-form-item",{attrs:{label:"会员宣传页素材",required:""}},[r("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["MemberPoster",{initialValue:e.member.payPosterImg,rules:[{required:!0,message:"请上传宣传页图片素材"}]}],expression:"['MemberPoster', { initialValue: member.payPosterImg, rules: [{ required: true, message: '请上传宣传页图片素材' }] }]"}],staticClass:"avatar-uploader",attrs:{name:"MemberPoster",accept:".jpg,.gif,.png","list-type":"picture-card",showUploadList:!1,beforeUpload:e.beforeUploadPoster}},[e.posterInfo.show?r("div",{staticClass:"img-container"},[r("img",{staticStyle:{"max-width":"420px","max-height":"300px"},attrs:{src:e.posterInfo.img,alt:"海报"}}),e.posterData?r("div",{staticClass:"delete-container row-center-center"},[r("a-icon",{style:{fontSize:"24px",color:"white"},attrs:{type:"delete"},on:{click:function(t){return t.stopPropagation(),e.resetUploadImg(1)}}})],1):e._e()]):r("div",[r("a-icon",{attrs:{type:"plus"}}),r("div",{staticStyle:{"margin-top":"10px",color:"#666"}},[e._v("上传宣传页图片")])],1)])],1),r("a-form-item",{attrs:{label:"付费后引导文案"}},[r("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["copyWriting",{initialValue:e.member.copyWriting,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['copyWriting', { initialValue: member.copyWriting, rules: [{ required: true, whitespace: true, message: '必填' }] }]"}],attrs:{placeholder:"请输入引导文案","allow-clear":""}})],1),r("a-form-item",{attrs:{label:"付费助理微信",required:""}},[r("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["MemberContactWX",{initialValue:e.member.contactQr,rules:[{required:!0,message:"请上传联系人微信二维码"}]}],expression:"['MemberContactWX', { initialValue: member.contactQr, rules: [{ required: true, message: '请上传联系人微信二维码' }] }]"}],staticClass:"avatar-uploader",attrs:{name:"MemberContactWX",accept:".jpg,.gif,.png","list-type":"picture-card",showUploadList:!1,beforeUpload:e.beforeUploadQrCode}},[e.qrCodeInfo.show?r("div",{staticClass:"img-container"},[e.qrCodeInfo.show?r("img",{staticStyle:{"max-width":"300px","max-height":"300px"},attrs:{src:e.qrCodeInfo.img,alt:"二维码"}}):e._e(),e.qrCodeData?r("div",{staticClass:"delete-container row-center-center"},[r("a-icon",{style:{fontSize:"24px",color:"white"},attrs:{type:"delete"},on:{click:function(t){return t.stopPropagation(),e.resetUploadImg(2)}}})],1):e._e()]):r("div",[r("a-icon",{attrs:{type:"plus"}}),r("div",{staticStyle:{"margin-top":"10px",color:"#666"}},[e._v("上传联系人微信二维码")])],1)])],1)],1),r("a-divider",{staticClass:"title",attrs:{orientation:"left"}},[e._v("会员中心设置")]),r("a-form-item",{attrs:{label:"会员权益描述类型"}},[r("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["descShowType",{initialValue:e.descShowType,rules:[{required:!0,message:"必填"}]}],expression:"['descShowType', { initialValue: descShowType, rules: [{ required: true, message: '必填' }] }]"}],on:{change:e.onDescTypeChange}},[r("a-radio",{key:"2",attrs:{value:20}},[e._v("标准模板")]),r("a-radio",{key:"1",attrs:{value:10}},[e._v("海报")])],1)],1),10===e.descShowType?r("a-form-item",{attrs:{label:"会员权益海报"}},[r("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["MemberPoster2",{initialValue:e.member.benefitPosterImg,rules:[{required:!0,message:"请上传宣传页图片素材"}]}],expression:"['MemberPoster2', { initialValue: member.benefitPosterImg, rules: [{ required: true, message: '请上传宣传页图片素材' }] }]"}],staticClass:"avatar-uploader",attrs:{name:"MemberPoster2",accept:".jpg,.gif,.png","list-type":"picture-card",showUploadList:!1,beforeUpload:e.beforeUploadPoster2}},[e.poster2Info.show?r("div",{staticClass:"img-container"},[r("img",{staticStyle:{"max-width":"420px","max-height":"300px"},attrs:{src:e.poster2Info.img,alt:"海报"}}),e.poster2Data?r("div",{staticClass:"delete-container row-center-center"},[r("a-icon",{style:{fontSize:"24px",color:"white"},attrs:{type:"delete"},on:{click:function(t){return t.stopPropagation(),e.resetUploadImg(3)}}})],1):e._e()]):r("div",[r("a-icon",{attrs:{type:"plus"}}),r("div",{staticStyle:{"margin-top":"10px",color:"#666"}},[e._v("上传会员权益海报")])],1)])],1):e._e()],1)],1)],1)},a=[],n=r("1da1"),o=(r("96cf"),r("4de4"),r("d3b7"),r("b680"),r("99af"),r("7db0"),r("caad"),r("2532"),r("a9e3"),r("3ca3"),r("ddb0"),r("d81d"),r("c1df")),s=r.n(o),l=r("88bc"),u=r.n(l),c=r("4282"),d=r("c3ea"),m=r("7858"),p=r("ca00"),f=d["e"],h=["teamName","serviceExpireDay","serviceEndTime","inGroupName","outGroupId","copyWriting"],v={name:"MemberEdit",props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){return this.formLayout={labelCol:{span:6},wrapperCol:{span:18}},this.formItemLayout={labelCol:{span:5},wrapperCol:{span:19}},{form:this.$form.createForm(this),spinning:!1,editType:0,title:"会员信息",submitMethod:"",unlimitedVal:d["i"],member:{},isNew:!0,originalPrice:"",price:"",serviceExpireDay:1,expireDays:[],recruitType:0,recruitNumLimit:"",freeGroupList:[],descShowType:0,couponUseType:d["d"],isOpenPay:1,isRenewal:1,discountValue:"",discountLimitMin:0,discountLimitMax:0,discountTypeVal:0,discountTypeStr:"",discountTypeUnit:"",discountPrice:"",discountPriceStr:"--",poster2Data:null,poster2Img:null,poster2Url:"",posterData:null,posterImg:null,posterUrl:"",qrCodeData:null,qrCodeImg:null,qrCodeUrl:"",qrSize:256,transformInputNumber:function(e){var t=+e;return""===e&&(t=NaN),t},genValidatorRules:p["i"]}},computed:{poster2Info:function(){var e={show:!1,img:""},t=this.poster2Img||this.member.benefitPosterImg;return t&&(e.show=!0,e.img=t),e},posterInfo:function(){var e={show:!1,img:""},t=this.posterImg||this.member.payPosterImg;return t&&(e.show=!0,e.img=t),e},qrCodeInfo:function(){var e={show:!1,img:""},t=this.qrCodeImg||this.member.contactQr;return t&&(e.show=!0,e.img=t),e}},created:function(){var e=this;this.$watch("visible",function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r,i){var a,n,o,s,l,u,c,d,m,p,f,h;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=28;break}if(e.form.resetFields(),e.poster2Data=null,e.poster2Img=null,e.posterData=null,e.posterImg=null,e.qrCodeData=null,e.qrCodeImg=null,a=e.model,n=a.member,o=void 0===n?{}:n,s=a.groupList,l=void 0===s?[]:s,u=a.freeGroupList,c=void 0===u?[]:u,d=a.memberList,m=void 0===d?[]:d,e.member=o,p=o.id,f=o.inGroupId,h=o.teamName,!p){t.next=19;break}return e.editType=1,e.title="修改会员信息",e.submitMethod="updateTeamInfo",t.next=17,e.reqMemberInfo();case 17:t.next=22;break;case 19:e.editType=0,e.title="新增会员",e.submitMethod="addClubTeam";case 22:e.setMemberInfo(),e.setUseTypeAddon(e.discountTypeVal),e.calcDiscountPrice(),e.freeGroupList=c.filter((function(e){return-1!==e.value})),e.groupList=l.filter((function(e){return e.value!==f})),e.memberList=m.filter((function(e){return e!==h}));case 28:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}())},mounted:function(){},methods:{reqMemberInfo:function(){var e=this;this.spinning=!0;var t={teamId:this.member.id};return c["a"].clubTeamInfo(t).then((function(t){var r=t.result,i=r.teamInfo;e.member=i})).catch((function(e){})).finally((function(){e.spinning=!1}))},setMemberInfo:function(){var e=this.member,t=e.id,r=e.originalPrice,i=e.price,a=e.serviceExpireDay,n=e.expireDays,o=void 0===n?"[]":n,s=e.recruitType,l=void 0===s?10:s,c=e.recruitNumLimit,m=void 0===c?"":c,v=e.isOpenPay,b=void 0===v?1:v,y=e.isRenewal,g=void 0===y?1:y,w=e.renewalDiscountType,x=void 0===w?f.cut.value:w,D=e.renewalDiscountValue,I=e.renewalPrice,P=e.descShowType,N=void 0===P?20:P;this.originalPrice=r?(r/100).toFixed(2):"",this.price=i?(i/100).toFixed(2):"",this.serviceExpireDay=a,this.expireDays=JSON.parse(o),this.recruitType=l,this.recruitNumLimit=m===d["i"]?"":m+"",this.isOpenPay=b,this.isRenewal=g,this.discountTypeVal=x,Object(p["p"])(D)?x===f.cut.value?this.discountValue=D/100:this.discountValue=D/10:this.discountValue="",this.discountPrice=I?(I/100).toFixed(2):"",this.descShowType=N,this.form.setFieldsValue({originalPrice:this.originalPrice,price:this.price,recruitNumLimit:this.recruitNumLimit,isOpenPay:this.isOpenPay,isRenewal:this.isRenewal,renewalDiscountType:this.discountTypeVal,renewalDiscountValue:this.discountValue,descShowType:this.descShowType}),t&&this.form.setFieldsValue(u()(this.member,h))},setUseTypeAddon:function(e){var t=this;this.$nextTick((function(){var r=t.form.getFieldsValue(["originalPrice"]),i=r.originalPrice;e===f.cut.value?(t.discountTypeStr="直减",t.discountTypeUnit="元",t.discountLimitMin=0,t.discountLimitMax=(100*i-1)/100):(t.discountTypeStr="减至",t.discountTypeUnit="折",t.discountLimitMin=0,t.discountLimitMax=9.9)}))},calcDiscountPrice:function(){var e=this;this.$nextTick((function(){var t=e.form.getFieldsValue(["originalPrice","renewalDiscountValue"]),r=t.originalPrice,i=t.renewalDiscountValue,a=e.discountTypeVal;if(!Object(p["p"])(r)||!Object(p["p"])(i)||!Object(p["p"])(a))return e.discountPrice="",void(e.discountPriceStr="--");if(a===f.cut.value?e.discountPrice=(r-i).toFixed(2):e.discountPrice=(r*i/10).toFixed(2),(i<e.discountLimitMin||i>e.discountLimitMax)&&(e.discountPrice=""),Object(p["p"])(e.discountPrice)){var n=(e.discountPrice/r*10).toFixed(1);e.discountPriceStr="".concat(e.discountPrice,"元（≈").concat(n,"折）")}else e.discountPriceStr="--"}))},checkName:function(e,t,r){var i=!1;if(this.groupList.find((function(e){return t===e.label}))&&(i=!0),this.memberList.includes(t)&&(i=!0),i){var a="teamName"===e.field?"会员名称":"会员分组名称";r(new Error(a+"不能与其他会员或者会员分组名称重复"))}else r()},checkNumber:function(e,t,r){var i=!0;t>=0&&+t===Math.round(t)&&(i=!1),i?r(new Error("请输入大于等于0的整数")):r()},disabledDate:function(e){return e&&e<s()().endOf("day")},checkInputTime:function(e,t,r){var i="YYYY-MM-DD HH:mm:ss";s()(t,i).valueOf(),s()().valueOf();r()},handleSubmit:function(e){var t=this;this.form.validateFieldsAndScroll((function(e,r){if(!e){var i=Object.assign({},r);t.member.id&&(i.id=t.member.id),10===t.recruitType||t.recruitType;var a=i.expireDays;a&&(a=a.filter((function(e,t,r){return e&&r.indexOf(e,0)===t})),a.sort((function(e,t){return t-e})),i.expireDays=JSON.stringify(a)),i.originalPrice=Math.round(100*i.originalPrice),i.price=Math.round(100*i.price),i.recruitType=t.recruitType,""===i.recruitNumLimit?i.recruitNumLimit=d["i"]:i.recruitNumLimit=Number(i.recruitNumLimit),i.renewalDiscountType=t.discountTypeVal,i.renewalDiscountType===f.cut.value?i.renewalDiscountValue*=100:i.renewalDiscountValue*=10,delete i.MemberContactWX,delete i.MemberPoster,delete i.MemberPoster2,t.uploadPics().then((function(){t.poster2Data&&(i.benefitPosterImg=t.poster2Url),t.posterData&&(i.payPosterImg=t.posterUrl),t.qrCodeData&&(i.contactQr=t.qrCodeUrl);var e=t.submitMethod,r=i;t.spinning=!0,c["a"][e](r).then((function(e){t.poster2Data=null,t.posterData=null,t.qrCodeData=null,t.$message.success("操作成功");var r=i.inGroupName!==t.member.inGroupName;t.$emit("ok",r)})).catch((function(e){})).finally((function(){t.spinning=!1}))})).catch((function(e){}))}}))},onRenewalChange:function(e,t){e=e.target.value,this.isRenewal=e,this.calcDiscountPrice()},onDescTypeChange:function(e,t){e=e.target.value,this.descShowType=e},onDiscountTypeChange:function(e,t){e=e.target.value,this.discountTypeVal=e,this.setUseTypeAddon(e),this.form.setFieldsValue({renewalDiscountValue:""}),this.discountPrice="",this.discountPriceStr="--"},onPriceInput:function(e){var t=e.target.value;this.originalPrice=t,t||this.form.setFieldsValue({renewalDiscountValue:""}),this.setUseTypeAddon(this.discountTypeVal),this.calcDiscountPrice()},onDiscountInput:function(e){e.target.value;this.calcDiscountPrice()},onGroupNameFocus:function(e){var t=this.form.getFieldsValue(["teamName","inGroupName"]);t.teamName&&!t.inGroupName&&this.form.setFieldsValue({inGroupName:t.teamName})},onRecruitTypeChange:function(e){this.recruitType=e.target.value},onServiceExpireDay:function(e){var t=this;this.serviceExpireDay=e.target.value,this.$nextTick((function(){t.form.validateFields(["renewalDay","expireDays.0","expireDays.1","expireDays.2"])}))},beforeUploadPoster2:function(e){this.beforeUpload(e,3)},beforeUploadPoster:function(e){this.beforeUpload(e,1)},beforeUploadQrCode:function(e){this.beforeUpload(e,2)},beforeUpload:function(e,t){var r=e.size/1024/1024<5;return r?(this.handleFile(e,t),!1):(this.$message.error("图片需要小于5MB!"),!1)},handleFile:function(e,t){var r=this;Object(p["j"])(e,(function(i){1===t?(r.posterData=e,r.posterImg=i):2===t?(r.qrCodeData=e,r.qrCodeImg=i):3===t&&(r.poster2Data=e,r.poster2Img=i)}))},uploadPics:function(){var e=this,t=[];return this.poster2Data&&t.push({from:3,data:this.poster2Data,fileName:"member_poster2"+Date.now(),showUrl:"poster2Url",maxW:750}),this.posterData&&t.push({from:1,data:this.posterData,fileName:"member_poster"+Date.now(),showUrl:"posterUrl",maxW:750}),this.qrCodeData&&t.push({from:2,data:this.qrCodeData,fileName:"member_wxQrCode"+Date.now(),showUrl:"qrCodeUrl",maxW:300}),Promise.all(t.map((function(t){return e.uploadPic(t)})))},uploadPic:function(e){var t=this,r=this.$store.state.ta,i=new File([e.data],e.fileName,{type:e.data.type});return this.spinning=!0,Object(m["a"])(i,{key:"taqf/club/".concat(r.clubId,"/").concat(e.fileName),maxW:e.maxW,appId:"weClub"}).then((function(r){t[e.showUrl]=r.url})).catch((function(e){})).finally((function(){}))},resetUploadImg:function(e){1===e?(this.posterData=null,this.posterImg=null,this.posterUrl="",this.form.resetFields(["MemberPoster"])):2===e?(this.qrCodeData=null,this.qrCodeImg=null,this.qrCodeUrl="",this.form.resetFields(["MemberContactWX"])):3===e&&(this.poster2Data=null,this.poster2Img=null,this.poster2Url="",this.form.resetFields(["MemberPoster2"]))}}},b=v,y=r("2877"),g=Object(y["a"])(b,i,a,!1,null,null,null);t["a"]=g.exports},"88bc":function(e,t,r){(function(t){var r=1/0,i=9007199254740991,a="[object Arguments]",n="[object Function]",o="[object GeneratorFunction]",s="[object Symbol]",l="object"==typeof t&&t&&t.Object===Object&&t,u="object"==typeof self&&self&&self.Object===Object&&self,c=l||u||Function("return this")();function d(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function m(e,t){var r=-1,i=e?e.length:0,a=Array(i);while(++r<i)a[r]=t(e[r],r,e);return a}function p(e,t){var r=-1,i=t.length,a=e.length;while(++r<i)e[a+r]=t[r];return e}var f=Object.prototype,h=f.hasOwnProperty,v=f.toString,b=c.Symbol,y=f.propertyIsEnumerable,g=b?b.isConcatSpreadable:void 0,w=Math.max;function x(e,t,r,i,a){var n=-1,o=e.length;r||(r=N),a||(a=[]);while(++n<o){var s=e[n];t>0&&r(s)?t>1?x(s,t-1,r,i,a):p(a,s):i||(a[a.length]=s)}return a}function D(e,t){return e=Object(e),I(e,t,(function(t,r){return r in e}))}function I(e,t,r){var i=-1,a=t.length,n={};while(++i<a){var o=t[i],s=e[o];r(s,o)&&(n[o]=s)}return n}function P(e,t){return t=w(void 0===t?e.length-1:t,0),function(){var r=arguments,i=-1,a=w(r.length-t,0),n=Array(a);while(++i<a)n[i]=r[t+i];i=-1;var o=Array(t+1);while(++i<t)o[i]=r[i];return o[t]=n,d(e,this,o)}}function N(e){return T(e)||q(e)||!!(g&&e&&e[g])}function V(e){if("string"==typeof e||O(e))return e;var t=e+"";return"0"==t&&1/e==-r?"-0":t}function q(e){return R(e)&&h.call(e,"callee")&&(!y.call(e,"callee")||v.call(e)==a)}var T=Array.isArray;function C(e){return null!=e&&L(e.length)&&!S(e)}function R(e){return U(e)&&C(e)}function S(e){var t=M(e)?v.call(e):"";return t==n||t==o}function L(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=i}function M(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function U(e){return!!e&&"object"==typeof e}function O(e){return"symbol"==typeof e||U(e)&&v.call(e)==s}var j=P((function(e,t){return null==e?{}:D(e,m(x(t,1),V))}));e.exports=j}).call(this,r("c8ba"))},c3ea:function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"e",(function(){return n})),r.d(t,"d",(function(){return o})),r.d(t,"i",(function(){return s})),r.d(t,"f",(function(){return l})),r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return c})),r.d(t,"g",(function(){return d})),r.d(t,"h",(function(){return m}));r("b680");var i=r("ca00"),a={buy:{value:10,label:"售卖链接"},renew:{value:20,label:"续费链接"}},n=(Object(i["h"])(a),{cut:{value:10,label:"价格直减"},discount:{value:20,label:"价格折扣"}}),o=Object(i["h"])(n),s=-1e6,l=[{title:"会员名称",dataIndex:"teamName",customRender:function(e){return e||"-"},width:90},{title:"划线价格",dataIndex:"originalPrice",customRender:function(e){return e>=0?Object(i["c"])(e/100,2,"元"):"-"},width:90},{title:"实付价格",dataIndex:"price",customRender:function(e){return e>=0?Object(i["c"])(e/100,2,"元"):"-"},width:90},{title:"招募人数",dataIndex:"limitCountStr",customRender:function(e){return e},width:90,ellipsis:!0},{title:"服务时长",dataIndex:"serviceExpireDay",customRender:p,width:90},{title:"会员分组",dataIndex:"inGroupName",width:90},{title:"购买链接",dataIndex:"payIndexUrl",scopedSlots:{customRender:"payLink"},width:90,ellipsis:!0},{title:"开放购买",dataIndex:"isOpenPay",scopedSlots:{customRender:"available"},width:90,ellipsis:!0},{title:"可否续费",dataIndex:"isRenewal",customRender:f,width:90,ellipsis:!0},{title:"续费价格",dataIndex:"renewalPrice",customRender:function(e){return e>=0?Object(i["c"])(e/100,2,"元"):"-"},width:90},{title:"操作",width:110,scopedSlots:{customRender:"action"}}],u=[{title:"会员名称",dataIndex:"teamName",customRender:function(e){return e||"-"},width:90},{title:"划线价格",dataIndex:"originalPrice",customRender:function(e){return e>=0?Object(i["c"])(e/100,2,"元"):"-"},width:90},{title:"实付价格",dataIndex:"price",customRender:function(e){return e>=0?Object(i["c"])(e/100,2,"元"):"-"},width:90},{title:"开放购买",dataIndex:"isOpenPay",customRender:f,width:90,ellipsis:!0},{title:"操作",width:100,scopedSlots:{customRender:"action"}}],c=[{title:"优惠券名称",dataIndex:"name",customRender:function(e){return e||"-"},width:110},{title:"实付价格",dataIndex:"price",customRender:function(e){return e>=0?Object(i["c"])(e/100,2,"元"):"-"},ellipsis:!0,width:90},{title:"剩余库存",dataIndex:"limitCountStr",customRender:function(e){return e},width:90,ellipsis:!0},{title:"已购数量",dataIndex:"boughtNum",customRender:function(e){return e>=0?e:"-"},width:90,ellipsis:!0},{title:"购买链接",dataIndex:"payIndexUrl",scopedSlots:{customRender:"payLink"},width:90,ellipsis:!0},{title:"开放购买",dataIndex:"isActive",scopedSlots:{customRender:"available"},width:90,ellipsis:!0},{title:"操作",width:110,scopedSlots:{customRender:"action"}}],d=[{title:"会员名称",dataIndex:"teamName",customRender:function(e){return e||"-"},width:90},{title:"划线价格",dataIndex:"originalPrice",customRender:function(e){return e>=0?Object(i["c"])(e/100,2,"元"):"-"},width:90},{title:"实付价格",dataIndex:"price",customRender:function(e){return e>=0?Object(i["c"])(e/100,2,"元"):"-"},width:90},{title:"开放购买",dataIndex:"isOpenPay",customRender:f,width:90,ellipsis:!0},{slots:{title:"customHead_action"},width:90,scopedSlots:{customRender:"action"}}],m=[{title:"关联会员",dataIndex:"teamName",customRender:function(e){return e||"-"},width:90},{title:"划线价格",dataIndex:"originalPrice",customRender:function(e){return e>=0?Object(i["c"])(e/100,2,"元"):"-"},width:90},{title:"折扣",dataIndex:"discountStr",customRender:function(e){return e||"-"},width:90,ellipsis:!0},{title:"实付价格",dataIndex:"payPrice",customRender:function(e){return e>=0?"".concat(e,"元"):"-"},width:90},{title:"角标文案",dataIndex:"iconDesc",customRender:function(e){return e||"-"},width:90,ellipsis:!0},{title:"购买链接",dataIndex:"payIndexUrl",scopedSlots:{customRender:"payLink"},width:90,ellipsis:!0},{title:"操作",width:110,scopedSlots:{customRender:"action"}}];function p(e,t,r,i){var a=t.serviceExpireDay,n=t.serviceEndTime,o="-";return a?o=a+"天":n&&(o=n),o}function f(e){var t="-";return 1===e?t="是":0===e&&(t="否"),t}}}]);
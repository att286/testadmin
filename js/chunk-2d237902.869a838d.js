(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d237902"],{fc3b:function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("page-header-wrapper",{ref:"wrapper",attrs:{title:!1}},[e("a-spin",{attrs:{spinning:t.spinning},on:{scroll:t.onScroll}},[t.showDataIntro?e("data-intro",{ref:"DataIntro",attrs:{overViewData:t.overViewData},on:{cardClick:t.onCardClick}}):t._e(),t.showContentData?e("content-data",{ref:"ContentData"}):t._e(),t.showLiveData?e("alive-data",{ref:"LiveData",attrs:{overViewData:t.overViewData}}):t._e(),t.showBrowseContent?e("browse-content",{ref:"BrowseContent"}):t._e()],1),e("data-detail",{attrs:{visible:t.modalVisible,detailData:t.detailData,title:t.detailTitle},on:{cancel:t.handleCancel,ok:t.handleCancel}})],1)},r=[],i=(e("d3b7"),e("4de4"),e("159b"),function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{height:"260px"}},[t._m(0),e("div",{staticStyle:{"margin-top":"20px"}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:8,sm:24}},[e("data-card",{attrs:{title:"Club用户数",mainValue:t.overViewData.accumulativeUserNum||"0"},on:{click:function(a){return t.$emit("cardClick","1")}}})],1),e("a-col",{attrs:{md:8,sm:24}},[e("data-card",{attrs:{title:"当日Club访问人数",mainValue:t.overViewData.dayActiveUserNum||"0",persent:t.dayActivePersent,extraDatas:t.dayActiveExtra},on:{click:function(a){return t.$emit("cardClick","2")}}})],1),e("a-col",{attrs:{md:8,sm:24}},[e("data-card",{attrs:{title:"当日Club新增用户数",mainValue:t.overViewData.dayAddUserNum||"0",persent:t.dayAddPersent,extraDatas:t.dayAddExtra,tip:"首次加入Club的用户"},on:{click:function(a){return t.$emit("cardClick","3")}}})],1)],1)],1)])}),s=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"row-start-center"},[e("div",{staticStyle:{width:"3px",height:"20px",background:"#F12323","margin-right":"10px"}}),e("span",{staticStyle:{"magin-left":"15px","font-size":"16px",color:"black"}},[t._v("数据概览"),e("span",{staticStyle:{"font-size":"12px"}},[t._v("（点击卡片查看趋势图）")])])])}],o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{width:"350px",height:"auto",cursor:"pointer"},on:{click:function(a){return t.$emit("click")}}},[e("a-card",{attrs:{title:t.title,bodyStyle:{height:"110px"},bordered:!1}},[e("template",{slot:"extra"},[t.tip?e("a-tooltip",{attrs:{title:t.tip,placement:"left"}},[e("a-icon",{staticStyle:{fontSize:"20px"},attrs:{type:"question-circle"}})],1):t._e()],1),e("a-row",[e("a-col",{staticClass:"row-start-bottom",attrs:{span:14}},[""!==t.mainValue?e("a-statistic",{staticStyle:{"margin-right":"20px"},attrs:{title:!1,value:t.mainValue},scopedSlots:t._u([t.unit||t.persent?{key:"suffix",fn:function(){return[t.unit?e("span",{attrs:{title:!1}},[t._v(t._s(t.unit))]):t.persent?e("span",{style:t.persent>=0?{color:"#CF1322"}:{color:"#3F8600"},attrs:{title:!1}},[t._v(t._s((t.persent>=0?"+":"")+t.persent+"%"))]):t._e()]},proxy:!0}:null],null,!0)}):t._e(),t._t("content")],2),t.extraDatas.length?e("a-col",{staticClass:"column-start-left",attrs:{span:10}},t._l(t.extraDatas,(function(a){return e("div",{key:a.label},[t._v(t._s(a.label+"："+a.value))])})),0):t._e()],1)],2)],1)},c=[],l={props:{title:{type:String,default:"title"},mainValue:{type:String,default:""},persent:{type:String,default:""},extraDatas:{type:Array,default:function(){return[]}},unit:{type:String,default:""},tip:{type:String,default:""}},data:function(){return{}}},u=l,d=e("2877"),h=Object(d["a"])(u,o,c,!1,null,null,null),m=h.exports,f={components:{DataCard:m},props:{overViewData:{type:Object,default:function(){return{}}}},data:function(){return{}},created:function(){},computed:{dayActivePersent:function(){var t=parseInt(this.overViewData.dayActiveUserNum||0),a=parseInt(this.overViewData.yesterdayActiveUserNum||0);if(0===a)return 0===t?"0":"100";var e=(t-a)/a;return e=Math.floor(1e4*e)/100,"".concat(e)},dayActiveExtra:function(){var t=[];return t.push({label:"本周",value:this.overViewData.weekActiveUserNum||"0"}),t.push({label:"本月",value:this.overViewData.monthActiveUserNum||"0"}),t.push({label:"近30天",value:this.overViewData.recentMonthActiveUserNum||"0"}),t},dayAddPersent:function(){var t=parseInt(this.overViewData.dayAddUserNum||0),a=parseInt(this.overViewData.yesterdayAddUserNum||0);if(0===a)return 0===t?"0":"100";var e=(t-a)/a;return e=Math.floor(1e4*e)/100,"".concat(e)},dayAddExtra:function(){var t=[];return t.push({label:"本周",value:this.overViewData.weekAddUserNum||"0"}),t.push({label:"本月",value:this.overViewData.monthAddUserNum||"0"}),t.push({label:"近30天",value:this.overViewData.recentMonthAddUserNum||"0"}),t}}},p=f,v=Object(d["a"])(p,i,s,!1,null,null,null),D=v.exports,y=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{height:"auto","margin-bottom":"30px"}},[t._m(0),e("a-spin",{attrs:{spinning:t.spinning}},[e("a-card",{staticStyle:{"margin-top":"20px"},attrs:{bordered:!1}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"数据维度"}},[e("a-select",{attrs:{defaultValue:"1"},model:{value:t.queryParam.dataType,callback:function(a){t.$set(t.queryParam,"dataType",a)},expression:"queryParam.dataType"}},[e("a-select-option",{attrs:{value:"1"}},[t._v("浏览次数")]),e("a-select-option",{attrs:{value:"2"}},[t._v("浏览人数")])],1)],1)],1),e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"模块筛选"}},[e("a-select",{attrs:{options:t.modules,loading:t.modulesLoading,allowClear:"",placeholder:"所有"},model:{value:t.queryParam.moduleId,callback:function(a){t.$set(t.queryParam,"moduleId",a)},expression:"queryParam.moduleId"}})],1)],1),e("a-col",{attrs:{md:7,sm:24}},[e("a-form-item",{attrs:{label:"时间段"}},[e("a-range-picker",{attrs:{value:t.searchTimes,placeholder:["开始时间","结束时间"],format:"YYYY-MM-DD",ranges:{"今天":[t.moment(),t.moment()],"本月":[t.moment().startOf("month"),t.moment().endOf("month")]},disabledDate:t.disabledDate},on:{change:t.handleTimesChange,openChange:t.openDateChange,calendarChange:t.calendarChange}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons"},[e("a-button",{attrs:{type:"primary",icon:"search"},on:{click:t.loadData}},[t._v("查询")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"reload"},on:{click:t.resetQueryParams}},[t._v("重置")])],1)])],1)],1)],1),e("div",{staticClass:"table-page-search-wrapper"},[e("chart",{ref:"chart",attrs:{chartType:"line"}})],1)])],1)],1)},g=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"row-start-center"},[e("div",{staticStyle:{width:"3px",height:"20px",background:"#F12323","margin-right":"10px"}}),e("span",{staticStyle:{"magin-left":"15px","font-size":"16px",color:"black"}},[t._v("内容数据")])])}],w=(e("d81d"),e("7db0"),e("c1df")),b=e.n(w),C=e("f306"),x=e("250c"),S=e("ca00"),Y={components:{Chart:x["a"]},props:{},data:function(){return this.moment=b.a,{spinning:!1,searchTimes:[],modules:[],modulesLoading:!1,queryParam:{dataType:"1"}}},watch:{searchTimes:function(t){t&&(this.queryParam.startDate=t[0]?t[0].format("YYYY-MM-DD"):"",this.queryParam.endDate=t[1]?t[1].format("YYYY-MM-DD"):"")}},created:function(){var t=this;this.modulesLoading=!0,C["a"].getTaContentModuleList(this.queryParam).then((function(a){t.modules=a.moduleList.map((function(t){return{label:t.moduleName,value:t.moduleId}}))})).catch((function(t){})).finally((function(){t.modulesLoading=!1})),this.loadData()},computed:{},methods:{loadData:function(){var t=this;this.spinning=!0,C["a"].getTaModuleAccessStatistics(this.queryParam).then((function(a){a.moduleList.forEach((function(a){a.accessList=t.fillEmptyData(a.accessList)}));var e=a.moduleList.map((function(t){return t.moduleName})),n=a.moduleList[0].accessList.map((function(t){return b()(t.dataDate,"YYYY-MM-DD").format("MM/DD")})),r="1"===t.queryParam.dataType?["次数"]:["人数"],i=[e,n,r];a.moduleList.forEach((function(t){var a=t.accessList.map((function(t){return parseInt(t.accessNumber)||0}));i.push(a)})),t.$refs.chart.setChartOption(i),t.$refs.chart.setEmptyStr("")})).catch((function(a){t.$refs.chart.setEmptyStr("暂无数据")})).finally((function(){t.spinning=!1}))},fillEmptyData:function(t){var a,e=[];return a=this.queryParam.startDate&&this.queryParam.endDate?Object(S["l"])(b()(this.queryParam.startDate,"YYYY-MM-DD"),b()(this.queryParam.endDate,"YYYY-MM-DD")):Object(S["l"])(30),a.forEach((function(a){var n=t.find((function(t){return b()(t.dataDate,"YYYYMMDD").format("YYYY-MM-DD")===a}));n?e.push({accessNumber:n.accessNumber,dataDate:a}):e.push({accessNumber:0,dataDate:a})})),e},handleTimesChange:function(t){this.searchTimes=t},resetQueryParams:function(){this.queryParam={dataType:"1"},this.searchTimes=void 0,this.loadData()},disabledDate:function(t){if(t&&this.startDate){var a=b()(this.startDate).add(-1,"months"),e=b()(this.startDate).add(1,"months");if(b.a.min(t,a)===t||b.a.max(t,e)===t)return!0}return!1},calendarChange:function(t,a){1===t.length&&(this.startDate=t[0])},openDateChange:function(t){t||(this.startDate=void 0)}}},_=Y,T=Object(d["a"])(_,y,g,!1,null,null,null),k=T.exports,M=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{height:"auto","margin-bottom":"30px"}},[t._m(0),e("div",{staticStyle:{"margin-top":"20px",height:"auto"}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:8,sm:24}},[e("data-card",{attrs:{title:"本月直播次数",mainValue:t.overViewData.monthBroadcastRooms||"0",unit:"次"}})],1),e("a-col",{attrs:{md:8,sm:24}},[e("data-card",{attrs:{title:"本月直播时长",mainValue:""},scopedSlots:t._u([{key:"content",fn:function(){return[t.aliveTotalTime.h?e("a-statistic",{staticStyle:{"margin-right":"5px"},attrs:{title:!1,value:t.aliveTotalTime.h},scopedSlots:t._u([{key:"suffix",fn:function(){return[e("span",{attrs:{title:!1}},[t._v("小时")])]},proxy:!0}],null,!1,3683863417)}):t._e(),e("a-statistic",{staticStyle:{"margin-right":"0px"},attrs:{title:!1,value:t.aliveTotalTime.m},scopedSlots:t._u([{key:"suffix",fn:function(){return[e("span",{attrs:{title:!1}},[t._v("分钟")])]},proxy:!0}])})]},proxy:!0}])})],1),e("a-col",{attrs:{md:8,sm:24}},[e("data-card",{attrs:{title:"本月直播听众人次",mainValue:t.overViewData.monthBroadcastListeners||"0",unit:"人次",tip:"听众人次为每个直播间人次累计同一人多次进入同1个房间，记次数1。同一人进入N个房间，记次数N"}})],1)],1)],1),e("a-spin",{attrs:{spinning:t.spinning}},[e("a-card",{staticStyle:{"margin-top":"20px"},attrs:{bordered:!1}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:7,sm:24}},[e("a-form-item",{attrs:{label:"时间段"}},[e("a-range-picker",{attrs:{value:t.searchTimes,placeholder:["开始时间","结束时间"],format:"YYYY-MM-DD",ranges:{"今天":[t.moment(),t.moment()],"本月":[t.moment().startOf("month"),t.moment().endOf("month")]},disabledDate:t.disabledDate},on:{change:t.handleTimesChange,openChange:t.openDateChange,calendarChange:t.calendarChange}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons"},[e("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(a){return t.$refs.table.refresh(!0)}}},[t._v("查询")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"reload"},on:{click:t.resetQueryParams}},[t._v("重置")])],1)])],1)],1)],1),e("s-table",{ref:"table",attrs:{size:"default",rowKey:function(t,a){return a},columns:t.columns,data:t.loadData,pageSize:10,pageSizeOptions:["10"],alert:!1,scroll:{x:t.tableX},showPagination:"auto"}})],1)],1)],1)},$=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"row-start-center"},[e("div",{staticStyle:{width:"3px",height:"20px",background:"#F12323","margin-right":"10px"}}),e("span",{staticStyle:{"magin-left":"15px","font-size":"16px",color:"black"}},[t._v("直播数据")])])}],V=e("2af9"),E=[{title:"直播主题",dataIndex:"roomName",width:300,esplise:!0},{title:"直播创建时间",dataIndex:"createTime",width:300,esplise:!0},{title:"直播时长",dataIndex:"roomTime",width:300,esplise:!0,customRender:P},{title:"听众人数",dataIndex:"roomNum",width:300,esplise:!0}];function P(t){var a="",e=Math.round(t/60),n=Math.floor(e/60);return n&&(a+="".concat(n,"小时")),e%=60,a+="".concat(e,"分钟"),a}var I={components:{DataCard:m,STable:V["c"]},props:{overViewData:{type:Object,default:function(){return{}}}},data:function(){var t=this;return this.columns=E,this.moment=b.a,this.getTimeStr=P,{spinning:!1,searchTimes:[],queryParam:{},loadData:function(a){var e=Object.assign({},a,t.queryParam);return e.pageNum=a.pageNo,delete e.pageNo,C["a"].getTaRoomStatistics(e).then((function(t){return t.totalCount=+t.total,t.pageNo=+a.pageNo,t.data=t.roomList,t})).catch((function(){}))}}},watch:{searchTimes:function(t){t&&(this.queryParam.startDate=t[0]?t[0].format("YYYY-MM-DD"):"",this.queryParam.endDate=t[1]?t[1].format("YYYY-MM-DD"):"")}},created:function(){var t=this;this.$root.eventHub.$on("refreshView",(function(){t.$refs.table&&t.$refs.table.refresh()}))},beforeRouteLeave:function(t,a,e){this.$root.eventHub.$off("refreshView"),e()},computed:{tableX:function(){var t=0;return this.columns.forEach((function(a){t+=a.width})),t},aliveTotalTime:function(){var t=this.overViewData.monthBroadcastDurations||0,a=Math.round(t/60),e=Math.floor(a/60);return a%=60,{h:e,m:a}}},methods:{handleTimesChange:function(t){this.searchTimes=t},resetQueryParams:function(){this.queryParam={},this.searchTimes=void 0,this.$refs.table.refresh(!0)},disabledDate:function(t){if(t&&this.startDate){var a=b()(this.startDate).add(-1,"months"),e=b()(this.startDate).add(1,"months");if(b.a.min(t,a)===t||b.a.max(t,e)===t)return!0}return!1},calendarChange:function(t,a){1===t.length&&(this.startDate=t[0])},openDateChange:function(t){t||(this.startDate=void 0)}}},N=I,L=Object(d["a"])(N,M,$,!1,null,null,null),q=L.exports,A=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{height:"auto","margin-bottom":"30px"}},[t._m(0),e("a-spin",{attrs:{spinning:t.spinning}},[e("a-card",{staticStyle:{"margin-top":"20px"},attrs:{bordered:!1}},[e("div",{staticClass:"table-page-search-wrapper"},[e("p",{staticStyle:{"font-size":"20px","font-weight":"500"}},[t._v("按浏览人数")]),e("chart",{ref:"CountChart",attrs:{chartType:"pie"}}),e("p",{staticStyle:{"font-size":"20px","font-weight":"500","margin-top":"40px"}},[t._v("按浏览次数")]),e("chart",{ref:"NumChart",attrs:{chartType:"pie"}})],1)])],1)],1)},O=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"row-start-center"},[e("div",{staticStyle:{width:"3px",height:"20px",background:"#F12323","margin-right":"10px"}}),e("span",{staticStyle:{"magin-left":"15px","font-size":"16px",color:"black"}},[t._v("近7日TOP20浏览内容")])])}],U={components:{Chart:x["a"]},props:{},data:function(){return{spinning:!1,countData:{},numData:{}}},watch:{searchTimes:function(t){t&&(this.queryParam.startDate=t[0],this.queryParam.endDate=t[1])}},created:function(){this.loadData()},computed:{},methods:{loadData:function(){var t=this;C["a"].getTaContentAccessStatistics({dataType:"1",size:"20"}).then((function(a){a.contentList&&a.contentList.length?t.setChartInfo("1",a.contentList):t.setChartEmpty("1")})).catch((function(a){t.setChartEmpty("1")})).finally((function(){})),C["a"].getTaContentAccessStatistics({dataType:"2",size:"20"}).then((function(a){a.contentList&&a.contentList.length?t.setChartInfo("2",a.contentList):t.setChartEmpty("2")})).catch((function(a){t.setChartEmpty("2")})).finally((function(){}))},setChartInfo:function(t,a){var e="1"===t?this.$refs["CountChart"]:this.$refs["NumChart"],n=a.map((function(t){return t.contentName})),r=a.map((function(t){return t.accessNumber}));e.setChartOption([n,null,null,r]),e.setEmptyStr("")},setChartEmpty:function(t){var a="1"===t?this.$refs["CountChart"]:this.$refs["NumChart"];a.setEmptyStr("暂无数据")}}},j=U,z=Object(d["a"])(j,A,O,!1,null,null,null),B=z.exports,H=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("a-modal",{attrs:{title:t.title,width:960,maskClosable:!1,visible:t.visible,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:function(){t.$emit("ok")},cancel:function(){t.$emit("cancel")}}},[e("a-spin",{attrs:{spinning:t.loading}},[e("chart",{ref:"chart",attrs:{chartType:"line"}})],1)],1)},F=[],K={components:{Chart:x["a"]},props:{visible:{type:Boolean,required:!0},detailData:{type:Array,default:function(){return[]}},title:{type:String,default:""}},data:function(){return{loading:!1}},created:function(){},mounted:function(){},watch:{detailData:function(t){if(t){var a=this.fillEmptyData(t),e=a.map((function(t){return b()(t.activeDate,"YYYY-MM-DD").format("MM/DD")})),n=["人数"],r=a.map((function(t){return parseInt(t.count)}));this.$refs.chart.setChartOption([[this.title],e,n,r])}}},methods:{fillEmptyData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=[],e=Object(S["l"])(30);if("Club用户数"===this.title){var n=0;e.forEach((function(e){var r=t.find((function(t){return b()(t.activeDate,"YYYYMMDD").format("YYYY-MM-DD")===e}));r?(n=r.count>n?r.count:n,a.push({count:n,activeDate:e})):a.push({count:n,activeDate:e})}))}else e.forEach((function(e){var n=t.find((function(t){return b()(t.activeDate,"YYYYMMDD").format("YYYY-MM-DD")===e}));n?a.push({count:n.count,activeDate:e}):a.push({count:0,activeDate:e})}));return a}}},R=K,Q=Object(d["a"])(R,H,F,!1,null,null,null),J=Q.exports,X={components:{DataIntro:D,AliveData:q,ContentData:k,BrowseContent:B,DataDetail:J},data:function(){return{spinning:!1,curShowIdx:0,showDataIntro:!1,showContentData:!1,showLiveData:!1,showBrowseContent:!1,showKeys:["DataIntro","ContentData","LiveData","BrowseContent"],overViewData:{},detailData:[],detailTitle:"",modalVisible:!1}},created:function(){},beforeRouteEnter:function(t,a,e){e((function(t){window.addEventListener("scroll",t.onScroll)}))},beforeRouteLeave:function(t,a,e){window.removeEventListener("scroll",this.onScroll),e()},mounted:function(){var t=this;window.scrollTo(0,0),this.addItems(),this.spinning=!0,C["a"].getTaDataOverview({}).then((function(a){t.overViewData=a})).catch((function(t){})).finally((function(){t.spinning=!1}))},methods:{addItems:function(){var t=this;this.curShowIdx>=this.showKeys.length?window.removeEventListener("scroll",this.onScroll):(this["show"+this.showKeys[this.curShowIdx]]=!0,this.$nextTick((function(){var a=window.innerHeight-88,e=t.showKeys[t.curShowIdx],n=t.$refs[e];n&&a>n.$el.offsetTop+n.$el.clientHeight&&(t.curShowIdx++,t.addItems())})))},onScroll:function(t){var a=this,e=window.innerHeight-88,n=this.showKeys.filter((function(t,e){return e<=a.curShowIdx})),r=0;n.forEach((function(t){a.$refs[t]&&(r+=a.$refs[t].$el.clientHeight)})),r-t.currentTarget.pageYOffset<e&&(this.curShowIdx++,this.addItems())},onCardClick:function(t){var a=this,e="";switch(t){case"1":e="Club用户数";break;case"2":e="当日Club访问人数";break;case"3":e="当日Club新增人数";break;default:break}this.spinning=!0,C["a"].getTaDailyUserStatistics({statisticsType:t}).then((function(t){a.detailTitle=e,a.modalVisible=!0,a.$nextTick((function(){a.detailData=t.userStatisticsList}))})).catch((function(t){})).finally((function(){a.spinning=!1}))},handleCancel:function(){this.modalVisible=!1,this.detailData=[],this.detailTitle=""}}},G=X,W=Object(d["a"])(G,n,r,!1,null,null,null);a["default"]=W.exports}}]);
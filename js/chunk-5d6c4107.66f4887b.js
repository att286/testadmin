(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d6c4107"],{"142e":function(t,e,n){"use strict";n("ebb8")},"609b":function(t,e,n){},9413:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("page-header-wrapper",{attrs:{title:!1}},[n("channel-selector",{on:{change:t.onChannelChange},model:{value:t.curChannelId,callback:function(e){t.curChannelId=e},expression:"curChannelId"}}),n("div",{staticStyle:{width:"100%"}},[t.showSettlementYearData.length?n("div",{staticStyle:{width:"100%"}},[n("a-tooltip",{staticClass:"row-start-center",attrs:{placement:"topLeft",title:"该项目表示2022年9月份以来每年结算额的总和，其中结算额为“-”和“各月合计栏的结算额”，均不计入当年统计。"}},[n("h3",{staticStyle:{margin:"0"}},[t._v("结算总额")]),n("a-icon",{staticStyle:{"margin-left":"6px"},attrs:{type:"question-circle"}})],1),n("div",{staticClass:"totalField row-start-top"},t._l(t.settlementYearData,(function(e,a){return n("a-card",{key:a,staticClass:"totalItem column-start-left",attrs:{bodyStyle:{width:"220px",height:"120px"}}},[n("p",{staticStyle:{"margin-bottom":"20px"}},[t._v(t._s(e.range))]),e.totalSettlement>0?n("a-statistic",{attrs:{value:e.totalSettlement?e.totalSettlement:0,precision:2,suffix:"元",valueStyle:"font-size:24px;"}}):n("a-tooltip",{attrs:{placement:"topLeft",title:"收入总额未超过扣减项目总额，不进行结算。"}},[n("div",[t._v("—")])])],1)})),1)],1):t._e(),n("a-card",[n("a-row",{attrs:{gutter:24,type:"flex",align:"middle",justify:"space-between"}},[n("a-col",{attrs:{span:12}},[n("a-form",{attrs:{layout:"inline"}},[n("a-form-item",{attrs:{label:"选择日期范围",labelAlign:"left"}},[n("a-range-picker",{attrs:{value:t.dataMonth,placeholder:["开始时间","结束时间"],format:"YYYY年MM月",mode:t.pickerMode},on:{panelChange:t.handlePanelChange,change:t.handleChange,openChange:t.handlePickerOpen}})],1)],1)],1),n("a-col",{staticClass:"row-end-center",attrs:{span:8}},[n("a",{staticStyle:{color:"#F12323","text-align":"right",width:"100%"},on:{click:function(e){return t.$router.push("/monthly-list")}}},[t._v("2022年9月前结算数据")])])],1),n("div",[n("br")]),n("a-table",{ref:"table",attrs:{size:"default",rowKey:function(t,e){return e},columns:t.settlementColumns,"data-source":t.dataList,alert:!1,pagination:!1,rowClassName:t.rowClass,scroll:{x:t.tableX}},scopedSlots:t._u([{key:"customTitle",fn:function(){return[n("span",{staticStyle:{color:"#F12323"}},[t._v(t._s()+"A")])]},proxy:!0},{key:"totalSettlement",fn:function(e){return n("span",{},[[e>=0?n("span",[t._v(t._s(parseFloat(e).toFixed(2)))]):n("a-tooltip",{attrs:{title:"该月份的各项目总收入为负数，不进行结算。"}},[n("span",[t._v("—")])])]],2)}},{key:"normalAmount",fn:function(e){return n("span",{},[[n("span",{style:e<=0?"color:#F12323":""},[t._v(t._s(e?parseFloat(e).toFixed(2):"0.00"))])]],2)}},{key:"deductAmount",fn:function(e){return n("span",{},[[e?n("span",{staticStyle:{color:"#F12323"}},[t._v(t._s(parseFloat(e).toFixed(2)))]):n("span",[t._v("0.00")])]],2)}},{key:"settlementDate",fn:function(e,a){return n("span",{},[[!a.isTotal&&(a.totalSettlement||a.memberSettlement||a.brokerASettlement||a.brokerHkSettlement||a.insuranceSettlement||a.otherSettlement||a.deductHistoryAmount)?n("a",{staticStyle:{color:"#F12323"},on:{click:function(e){return t.handleInfo(a)}}},[t._v(t._s(a.settlementDateStr))]):n("span",[t._v(t._s(a.settlementDateStr))])]],2)}},{key:"action",fn:function(e,a){return n("span",{},[[!a.isTotal&&(a.totalSettlement||a.memberSettlement||a.brokerASettlement||a.brokerHkSettlement||a.insuranceSettlement||a.otherSettlement||a.deductHistoryAmount)?n("a",{staticStyle:{color:"#F12323"},on:{click:function(e){return t.handleInfo(a)}}},[t._v("查看明细")]):t._e()]],2)}}])})],1)],1)],1)},o=[],r=(n("159b"),n("4de4"),n("d3b7"),n("b64b"),n("99af"),n("ac8a")),s=n("0970"),i=n("4ae6"),l=n("c1df"),c=n.n(l),m={components:{ChannelSelector:r["a"]},computed:{tableX:function(){var t=0;return this.settlementColumns.forEach((function(e){t+=e.width})),t},showSettlementYearData:function(){return this.showTotalHistory?this.settlementYearData:this.settlementYearData.filter((function(t,e){return 0===e}))}},data:function(){return{spinning:!1,settlementColumns:[],curChannelId:"",totalDatas:[],dataList:[],dataMonth:[],pickerMode:["month","month"],settlementYearData:[],showTotalHistory:!1,initData:{totalSettlement:0,brokerASettlement:0,brokerHkSettlement:0,memberSettlement:0,insuranceSettlement:0,otherSettlement:0,deductHistoryAmount:0}}},created:function(){var t=this;this.$root.eventHub.$on("refreshView",(function(){t.loadData()}))},beforeRouteLeave:function(t,e,n){this.$root.eventHub.$off("refreshView"),n()},methods:{onChannelChange:function(){this.loadData()},handlePickerOpen:function(t){t||this.loadData()},handleChange:function(t){this.dataMonth=t,this.loadData()},handlePanelChange:function(t,e){this.dataMonth=t,this.pickerMode=["date"===e[0]?"month":e[0],"date"===e[1]?"month":e[1]]},loadData:function(){var t=this;this.spinning=!0;var e=this.curChannelId,n=this.dataMonth,a={channelId:"0"===e?"":e};if(n[0]&&n[1]){if(n[0].isBefore("2022-09-01")||n[1].isBefore("2022-09-01"))return this.$message.info("2022年9月前的结算数据请前往旧版查看"),this.spinning=!1,void(this.dataMonth=[]);a.startMonth=n[0].format("YYYYMM"),a.endMonth=n[1].format("YYYYMM")}s["a"].DataCenter_settlementList(a).then((function(e){t.proxyData(e)})).catch((function(e){var n={};t.proxyData(n)})).finally((function(){t.spinning=!1}))},proxyData:function(t){var e=this;if(t.businessState){var n=t.businessState,a=n.aState,o=n.hkState,r=n.memberState,s=n.insuranceState,l=n.otherState;this.settlementColumns=i["y"].filter((function(t){return!("brokerASettlement"===t.dataIndex&&!a||"brokerHkSettlement"===t.dataIndex&&!o||"memberSettlement"===t.dataIndex&&!r||"insuranceSettlement"===t.dataIndex&&!s||"otherSettlement"===t.dataIndex&&!l)}))}this.settlementYearData=t.settlementYearData||[],this.settlementYearData.forEach((function(n,a){n.range=e.getSettlementRange(n,a,t.latestSettlementDate)}));var m=[];t.settlementList&&t.settlementList.forEach((function(t){var n=c()(t.month,"YYYYMM").format("YYYY年MM月渠道结算"),a=t.month,o=Object.assign({},e.initData);if(t.settlementData.length){if(t.settlementData.forEach((function(e,r){var s=Object.assign({},e);if(s.monthStr=n,s.month=a,s.settlementDateStr=c()(e.settlementDate,"YYYYMMDD").format("MM月DD日"),0===r){var i=t.settlementData.length;s.rowSpan=1===i?i:i+1}else s.rowSpan=0;m.push(s),Object.keys(o).forEach((function(t){o[t]+=e[t]}))})),t.settlementData.length>1){var r=Object.assign({},o);r.monthStr=n,r.month=a,r.settlementDateStr="合计",r.isTotal=!0,r.rowSpan=0,r.deductHistoryAmount="",m.push(r)}}else{var s=Object.assign({},e.initData);s.monthStr=n,s.month=a,s.settlementDate=t.firstSettlementDate,s.settlementDateStr=c()(s.settlementDate,"YYYYMMDD").format("MM月DD日"),s.rowSpan=1,m.push(s)}})),m.sort((function(t,e){return e.month-t.month})),this.dataList=m},getSettlementRange:function(t,e,n){var a=t.settlementYear,o=c()(n,"YYYYMM"),r=o.format("M"),s=o.format("YYYY"),i=2022===a?"9":"1";return a==s?parseInt(r)<=parseInt(i)?"".concat(a,"年").concat(i,"月"):"".concat(a,"年").concat(i,"月 - ").concat(a,"年").concat(r,"月"):"".concat(a,"年").concat(i,"月 - ").concat(a,"年12月")},showTip:function(t){this.$info({title:t.title,content:t.tip})},handleInfo:function(t){if(!t.isTotal){sessionStorage.setItem("SettlementDetailParams",JSON.stringify({channel:this.curChannelId,data:t}));var e="/settlement-detail";this.$router.push(e)}},rowClass:function(t){return t.isTotal?"totalRow":""},disabledDate:function(t){var e=c()("20220901","YYYYMMDD"),n=!t.isBefore(e,"day");return[n,n]}}},u=m,h=(n("d314"),n("142e"),n("2877")),f=Object(h["a"])(u,a,o,!1,null,"74be05f5",null);e["default"]=f.exports},d314:function(t,e,n){"use strict";n("609b")},ebb8:function(t,e,n){}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7b81a1bb"],{"0335":function(e,t,a){"use strict";a("ac77")},"0fe9c":function(e,t,a){"use strict";a("1e0b")},"1e0b":function(e,t,a){},"29ca":function(e,t,a){},"2f43":function(e,t,a){"use strict";a("e1d1")},"53e4":function(e,t,a){},"6c80":function(e,t,a){"use strict";a("bcb7")},"7a44":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-header-wrapper",{attrs:{title:!1}},[a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",e._b({},"a-form",e.formLayout,!1),[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"房间名称"}},[a("a-input",{attrs:{"allow-clear":"",placeholder:"请输入","max-length":11},model:{value:e.queryParam.name,callback:function(t){e.$set(e.queryParam,"name",t)},expression:"queryParam.name"}})],1)],1),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"房间状态"}},[a("a-select",{attrs:{options:e.roomStatesList,"allow-clear":"",placeholder:"请选择"},model:{value:e.queryParam.state,callback:function(t){e.$set(e.queryParam,"state",t)},expression:"queryParam.state"}})],1)],1),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{staticClass:"table-page-search-submitButtons",attrs:{wrapperCol:{offset:3}}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"reload"},on:{click:e.resetQueryParams}},[e._v("重置")])],1)],1)],1)],1)],1),a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"setting"},on:{click:e.handlePoster}},[e._v("直播间设置")])],1),a("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",columns:e.columns,data:e.loadData,alert:!1,rowSelection:null,scroll:{x:e.tableX},showPagination:"auto"},scopedSlots:e._u([{key:"avatar",fn:function(e){return a("span",{},[a("a-avatar",{attrs:{size:48,icon:"user",src:e}})],1)}},{key:"state",fn:function(e,t){return a("span",{},[[a("a-badge",{attrs:{status:t._color,text:t._state}})]],2)}},{key:"action",fn:function(t,i){return a("span",{},[[a("a-button",{staticStyle:{color:"#1890ff",padding:"0"},attrs:{type:"link",loading:i.loading},on:{click:function(t){return e.reqChatMsgs(i)}}},[e._v("消息记录")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-button",{style:{color:i._settingColor,padding:0},attrs:{type:"link",disabled:i._end},on:{click:function(t){return e.handleEdit(i)}}},[e._v("直播设置")])]],2)}}])})],1),a("live-edit",{ref:"createModal",attrs:{visible:e.modalVisible,loading:e.confirmLoading,model:e.modalData},on:{cancel:e.onUpdateCancel,ok:e.onUpdateDone}}),a("live-config",{ref:"posterModal",attrs:{visible:e.posterModalVisible,model:e.posterModalData},on:{cancel:e.onPosterDone,ok:e.onPosterDone}})],1)},n=[],o=a("5530"),s=(a("159b"),a("d3b7"),a("b0c0"),a("4282")),r=a("2af9"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:640,maskClosable:!1,visible:e.visible,confirmLoading:e.spinning,okText:"刷新",cancelText:"关闭",centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:function(t){e.reqRoomInfo(t),e.modify=!0},cancel:function(){e.$emit("cancel",e.modify)}}},[a("a-spin",{attrs:{spinning:e.spinning}},[a("a-form",e._b({attrs:{form:e.form,labelAlign:"right"}},"a-form",e.formLayout,!1),[a("div",{staticClass:"item"},[a("a-form-item",{style:e.itemStyle,attrs:{label:"直播名称"}},[a("p",{},[e._v(e._s(e.roomInfo.name))])]),a("a-form-item",{style:e.itemStyle,attrs:{label:"直播主播"}},[a("p",{},[e._v(e._s(e.roomInfo._owners||"点击设置主播"))])]),a("a-form-item",{style:e.itemStyle,attrs:{label:"直播小助理",extra:""}},[a("a-tooltip",{attrs:{placement:"topLeft",title:"点击设置直播小助理"}},[a("p",{staticClass:"p",class:{empty:!e.roomInfo._admins},on:{click:e.showUsers}},[e._v(e._s(e.roomInfo._admins||"点击设置直播小助理"))])])],1),a("a-form-item",{style:e.itemStyle,attrs:{label:"直播嘉宾",extra:""}},[a("a-tooltip",{attrs:{placement:"topLeft",title:"点击设置直播嘉宾"}},[a("p",{staticClass:"p",class:{empty:!e.roomInfo._guests},on:{click:e.showUsers}},[e._v(e._s(e.roomInfo._guests||"点击设置直播嘉宾"))])])],1),a("a-form-item",{style:e.itemStyle,attrs:{label:"主讲人",extra:""}},[a("a-tooltip",{attrs:{placement:"topLeft",title:"点击设置直播主讲人"}},[a("p",{staticClass:"p",class:{empty:!e.roomInfo._presenters},on:{click:e.showUsers}},[e._v(e._s(e.roomInfo._presenters||"点击设置直播主讲人"))])])],1),a("a-form-item",{attrs:{label:"课件设置"}},[a("div",{staticClass:"row-between-center",staticStyle:{"margin-top":"5px","margin-bottom":"10px"}},[a("a-select",{staticStyle:{width:"240px"},attrs:{placeholder:"请选择",options:e.speechFileList},on:{change:e.onFileChange,select:e.onFileSelect},model:{value:e.curSpeechFile,callback:function(t){e.curSpeechFile=t},expression:"curSpeechFile"}}),a("a-button",{staticClass:"btn",attrs:{type:"link",icon:"setting"},on:{click:e.showClassPreview}},[e._v("管理课件")]),a("a-checkbox",{on:{change:e.onClassShow},model:{value:e.classShow,callback:function(t){e.classShow=t},expression:"classShow"}},[e._v("显示课件")])],1),e.curSpeechFile&&e.classShow2?[a("a-carousel",{ref:"carousel",staticClass:"carousel-box",attrs:{arrows:"","after-change":e.onCarouselChange}},[a("div",{staticClass:"custom-slick-arrow",staticStyle:{left:"10px",zIndex:"1"},attrs:{slot:"prevArrow"},slot:"prevArrow"},[a("a-icon",{attrs:{type:"left-circle"}})],1),a("div",{staticClass:"custom-slick-arrow",staticStyle:{right:"10px"},attrs:{slot:"nextArrow"},slot:"nextArrow"},[a("a-icon",{attrs:{type:"right-circle"}})],1),e._l(e.carouselItems,(function(e,t){return a("div",{key:t,staticClass:"carousel-item"},[a("div",{staticClass:"row-center-center"},[a("img",{staticClass:"carousel-img",attrs:{src:e}})])])}))],2),a("div",{staticClass:"row-between-center"},[a("div",[a("span",{staticStyle:{"margin-right":"10px"}},[e._v("跳转")]),a("a-tooltip",{attrs:{title:"输入后按下回车跳转"}},[a("a-input",{directives:[{name:"input",rawName:"v-input:number",arg:"number"}],staticStyle:{width:"40px"},attrs:{size:"small",min:1,max:e.carouselItems.length},on:{pressEnter:e.onJumpEnter},model:{value:e.pageNo,callback:function(t){e.pageNo=t},expression:"pageNo"}})],1),a("span",{staticStyle:{"margin-left":"10px","margin-right":"10px"}},[e._v("页")])],1),a("span",{staticStyle:{"margin-right":"20px",width:"42px","text-align":"right"}},[e._v(e._s(e.curCarousel+"/"+e.carouselItems.length))]),a("a-button",{staticClass:"btn",attrs:{type:"link",icon:"play-circle",loading:1===e.loadingBtn,error:""},on:{click:function(t){return e.reqUpdatePPT()}}},[e._v("设为当前")])],1)]:e._e()],2),a("a-form-item",{attrs:{label:"主播留言"}},[a("a-tooltip",{attrs:{placement:"topLeft",title:"留言仅主播和小助理可见，最多50个字符"}},[a("a-input",{directives:[{name:"input",rawName:"v-input:string",arg:"string"}],attrs:{placeholder:"请输入要给主播发送的信息","allow-clear":"","max-length":50},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}})],1),a("div",{staticClass:"row-end-center"},[a("span",{staticStyle:{"margin-right":"10px"}},[e._v("显示")]),a("a-tooltip",{attrs:{title:"范围5~60秒"}},[a("a-input",{directives:[{name:"input",rawName:"v-input:number",arg:"number"}],staticStyle:{width:"40px"},attrs:{size:"small",min:5,max:60},model:{value:e.msgTime,callback:function(t){e.msgTime=t},expression:"msgTime"}})],1),a("span",{staticStyle:{"margin-left":"10px","margin-right":"10px"}},[e._v("秒")]),a("a-button",{staticClass:"btn",attrs:{type:"link",icon:"notification",loading:2===e.loadingBtn},on:{click:e.sendAnchorMsg}},[e._v("发送留言")])],1)],1),a("a-form-item",{attrs:{label:"公屏弹幕"}},[a("a-tooltip",{attrs:{placement:"topLeft",title:"弹幕所有人可见，最多50个字符"}},[a("a-input",{directives:[{name:"input",rawName:"v-input:string",arg:"string"}],attrs:{placeholder:"请输入要发送的公屏弹幕","allow-clear":"","max-length":50},model:{value:e.danmaku,callback:function(t){e.danmaku=t},expression:"danmaku"}})],1),a("div",{staticClass:"row-end-center"},[a("span",{staticStyle:{"margin-right":"10px"}},[e._v("连播")]),a("a-tooltip",{attrs:{title:"范围1~10"}},[a("a-input",{directives:[{name:"input",rawName:"v-input:number",arg:"number"}],staticStyle:{width:"40px"},attrs:{size:"small",min:1,max:10},model:{value:e.danmakuTimes,callback:function(t){e.danmakuTimes=t},expression:"danmakuTimes"}})],1),a("span",{staticStyle:{"margin-left":"10px","margin-right":"10px"}},[e._v("次")]),a("a-button",{staticClass:"btn",attrs:{type:"link",icon:"message",loading:3===e.loadingBtn},on:{click:e.sendRoomMsg}},[e._v("发送弹幕")])],1)],1)],1)])],1),a("live-users",{ref:"userModal",attrs:{visible:e.modalVisible,model:e.modalData},on:{cancel:e.closeUesrs,ok:e.closeUesrs}}),a("pre-room-class",{ref:"pptModal",attrs:{visible:e.classModalVisible,"room-id":e.roomId,source:1},on:{cancel:e.handleClassClose,ok:e.handleClassClose}})],1)},c=[],u=(a("c740"),a("7db0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:840,maskClosable:!1,visible:e.visible,confirmLoading:e.spinning,okText:"刷新",cancelText:"关闭",centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:function(t){e.$refs.table.refresh(),e.modify=!0},cancel:function(){e.$emit("cancel",e.modify)}}},[a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",e._b({},"a-form",e.formLayout,!1),[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"用户名称"}},[a("a-input",{attrs:{"allow-clear":"",placeholder:"请输入","max-length":30},model:{value:e.queryParam.nickname,callback:function(t){e.$set(e.queryParam,"nickname",t)},expression:"queryParam.nickname"}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"手机号"}},[a("a-input",{attrs:{"allow-clear":"",placeholder:"请输入","max-length":11},model:{value:e.queryParam.mobile,callback:function(t){e.$set(e.queryParam,"mobile",t)},expression:"queryParam.mobile"}})],1)],1),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{staticClass:"table-page-search-submitButtons",attrs:{wrapperCol:{offset:3}}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"reload"},on:{click:e.resetQueryParams}},[e._v("重置")])],1)],1)],1)],1)],1),e.visible?a("s-table",{ref:"table",attrs:{size:"default",rowKey:"userId",columns:e.columns,data:e.loadData,alert:!1,rowSelection:null,scroll:{x:e.tableX},showPagination:"auto"},scopedSlots:e._u([{key:"avatar",fn:function(e){return a("span",{},[a("a-avatar",{attrs:{size:48,icon:"user",src:e}})],1)}},{key:"available",fn:function(t,i,n,o){return a("span",{},[a("a-switch",{attrs:{loading:n===e.switchIndex,checked:e._f("available")(i,t,n,o)},on:{change:function(a){return e.onStatusChange(a,t,i,n,o.dataIndex)}}})],1)}}],null,!1,3672944661)}):e._e()],1)],1)}),m=[],d=(a("a15b"),a("d81d"),a("caad"),a("99af"),a("c1df")),f=a.n(d),p=a("ca00"),h={prepare:{value:10,label:"准备中",color:"default"},live:{value:20,label:"直播中",color:"processing"},end:{value:30,label:"已结束",color:"success"},close:{value:31,label:"已关闭",color:"error"}},g=Object(p["h"])(h),v=[{title:"直播名称",dataIndex:"name",customRender:function(e){return e||"-"},width:100},{title:"开播时间",dataIndex:"_createTime",customRender:function(e){return e||"-"},width:120},{title:"主播",dataIndex:"_owners",customRender:function(e){return e||"-"},width:100},{title:"小助理",dataIndex:"_admins",customRender:function(e){return e||"-"},width:150},{title:"主讲人",dataIndex:"_presenters",customRender:function(e){return e||"-"},width:150},{title:"嘉宾",dataIndex:"_guests",customRender:function(e){return e||"-"},width:150},{title:"直播状态",dataIndex:"_state",scopedSlots:{customRender:"state"},width:100},{title:"操作",width:180,scopedSlots:{customRender:"action"}}],b=[{title:"用户名",dataIndex:"nickname",customRender:function(e){return e||"-"},ellipsis:!0},{title:"手机号",dataIndex:"mobile",customRender:function(e){return e||"-"},width:140,ellipsis:!0},{title:"设为小助理",dataIndex:"isAdmin",scopedSlots:{customRender:"available"},ellipsis:!0},{title:"设为嘉宾",dataIndex:"isGuest",scopedSlots:{customRender:"available"},ellipsis:!0},{title:"设为主讲人",dataIndex:"isPresenter",scopedSlots:{customRender:"available"},ellipsis:!0}];function y(e){var t=e.owners,a=void 0===t?[]:t,i=e.admins,n=void 0===i?[]:i,o=e.anchors,s=void 0===o?[]:o,r=e.guests,l=void 0===r?[]:r,c=e.presenters,u=void 0===c?[]:c,m=e.state;if(e._owners=a.map((function(e){return e.nickname})).join(" | "),e._anchors=s.map((function(e){return e.nickname})).join(" | "),e._admins=n.map((function(e){return e.nickname})).join(" | "),e._guests=l.map((function(e){return e.nickname})).join(" | "),e._presenters=u.map((function(e){return e.nickname})).join(" | "),e._createTime=f()(e.createTime).format("YYYY-MM-DD HH:mm:ss"),e._state=h.close.label,e._color=h.close.color,e._settingColor="#d9d9d9",m){var d=g.find((function(e){return e.value===m}));e._state=d.label,e._color=d.color,e._end=!0,[10,20].includes(m)&&(e._settingColor="#1890ff",e._end=!1)}}function w(e){e.forEach((function(e){e.title=e.fileName,e.value=e.id,e.imgs=[];for(var t=1;t<=e.pageCount;t++)e.imgs.push("".concat(e.fileUrl,"/").concat(t,".png"))}))}var x={name:"LiveUsers",components:{STable:r["c"]},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){return this.formLayout={labelCol:{md:{span:7}},wrapperCol:{md:{span:17}}},this.columns=b,{spinning:!1,editType:0,title:"设置直播间用户权限",queryParam:{},loadData:this.reqLiveUsers,selectedRowKeys:[],selectedRows:[],switchIndex:"",modify:!1}},filters:{available:function(e,t,a,i){return 1===t}},computed:{tableX:function(){var e=0;return this.columns.forEach((function(t){e+=t.width||t.minWidth||0})),e},rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},created:function(){var e=this;this.$watch("visible",(function(t,a){if(t){if(e.modify=!1,!e.model.id)throw Error("参数错误，没有roomId");e.editType=1,e.title="设置直播间用户权限",e.submitMethod="",e.roomId=e.model.id}}))},mounted:function(){},methods:{reqLiveUsers:function(e){var t=this,a=Object(o["a"])(Object(o["a"])({roomId:this.roomId},this.queryParam),e);return a.pageNum=e.pageNo,s["a"].liveRoomUsers(a).then((function(t){var a=t.result,i=a.roomInfoList||[];i.forEach((function(e){}));var n={totalCount:a.total,pageNo:e.pageNo,data:i};return n})).catch((function(){})).finally((function(){t.onSelectChange([],[])}))},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},resetQueryParams:function(){this.onSelectChange([],[]),this.queryParam={},this.$refs.table.refresh(!0)},onStatusChange:function(e,t,a,i,n){var o=this;if("isAdmin"===n&&a.isOwner&&a[n])this.$message.error("不能取消主播的小助理权限！");else if("isPresenter"===n&&a.isAdmin&&a[n])this.$message.error("不能取消小助理的主讲人权限！");else{this.switchIndex=i;var r=0;"isAdmin"===n?r=10:"isGuest"===n?r=20:"isPresenter"===n&&(r=30);var l=1===a[n]?0:1,c=l?10:20,u={roomId:this.roomId,targetUserId:a.userId,value:l,action:r,operation:c};s["a"].updateLiveRoomUserRight(u).then((function(e){o.$refs.table.refresh(),o.modify=!0})).catch((function(e){})).finally((function(){o.switchIndex=""}))}}}},I=x,C=(a("a7e3"),a("2877")),S=Object(C["a"])(I,u,m,!1,null,"2a4f0200",null),k=S.exports,_=a("a366"),L={name:"LiveEdit",components:{LiveUsers:k,PreRoomClass:_["a"]},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){return this.formLayout={labelCol:{span:5},wrapperCol:{span:19}},{form:this.$form.createForm(this),spinning:!1,editType:0,title:"直播间管理",submitMethod:"",modalVisible:!1,modalData:{},classModalVisible:!1,itemStyle:{"margin-bottom":"0"},roomId:0,roomInfo:{},classShow:!0,classShow2:!0,speechFileList:[],curSpeechFile:"",carouselItems:[],curCarousel:1,message:"",msgTime:20,danmaku:"",danmakuSpeed:5,danmakuTimes:1,pageNo:"",modify:!1,loadingBtn:0,transformInputNumber:function(e){var t=+e;return""===e&&(t=NaN),t}}},computed:{},created:function(){var e=this;this.$watch("visible",(function(t,a){if(t){if(e.message="",e.msgTime=20,e.pageNo="",e.modify=!1,!e.model.id)throw Error("参数错误，没有roomId");e.editType=1,e.title="直播间管理",e.submitMethod="",e.roomId=e.model.id,e.reqRoomInfo()}}))},mounted:function(){},methods:{reqRoomInfo:function(){var e=this;this.spinning=!0,s["a"].liveRoomInfo({roomId:this.roomId}).then((function(t){var a=t.result;a.roomInfoVo||(a.roomInfoVo={}),a.speechFileList||(a.speechFileList=[]);var i=a.roomInfoVo,n=void 0===i?{}:i,o=a.speechFileList,s=void 0===o?[]:o,r=a.speechFileId,l=void 0===r?0:r,c=a.speechFileNum,u=void 0===c?0:c;if(n.name=e.model.name,y(n),w(s),e.roomInfo=n,e.speechFileList=s,e.classShow=!1,e.classShow2=!1,s.length){var m=0;l&&(m=s.findIndex((function(e){return e.id===l})),e.classShow=!0,e.classShow2=!0),e.curSpeechFile=s[m].id,e.onFileChange(s[m].id),u&&setTimeout((function(){e.curCarousel=u,e.onJumpEnter({target:{value:u}})}),100)}else e.curSpeechFile="",e.carouselItems=[],e.curCarousel=1})).catch((function(e){})).finally((function(){e.spinning=!1}))},updateName:function(){},showUsers:function(){this.modalVisible=!0,this.modalData={id:this.roomId}},closeUesrs:function(e){this.modalVisible=!1,this.modalData={},this.modify=e,e&&this.reqRoomInfo()},onClassShow:function(e){var t=this,a=e.target.checked;if(a&&(!this.curSpeechFile||!this.curCarousel))return this.classShow2=!a,this.classShow=!this.classShow,void this.$message.error("请设置要展示的课件");var i=a?"打开":"关闭";this.$confirm({title:"系统提示",content:"确认要".concat(i,"课件显示吗？"),okText:"确认",cancelText:"取消",onOk:function(){t.classShow2=a;var e=a?1:2;t.reqUpdatePPT(e,(function(e){e||(t.classShow2=!a,t.classShow=!t.classShow)}))},onCancel:function(){t.classShow2=!a,t.classShow=!t.classShow}})},showClassPreview:function(){this.classModalVisible=!0},handleClassClose:function(e){this.classModalVisible=!1,this.modify=e,e&&this.reqRoomInfo()},onFileChange:function(e){var t=this.speechFileList.find((function(t){return t.id===e}));this.carouselItems=t.imgs,this.curCarousel=1},onFileSelect:function(e){},onCarouselChange:function(e){this.curCarousel=e+1},onJumpEnter:function(e){var t=this.$refs["carousel"],a=e.target.value;a<1||a>this.carouselItems.length||t&&a&&t.goTo(a-1)},reqUpdatePPT:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1?arguments[1]:void 0;return this.curSpeechFile&&this.curCarousel?(this.loadingBtn=1,s["a"].updateLiveRoomPPT({roomId:this.roomId,fileId:this.curSpeechFile,pageNo:this.curCarousel,action:t}).then((function(t){return e.$message.success("课件设置成功"),a&&a(t),1})).catch((function(t){return e.$error({title:"错误",content:"课件设置失败: "+t.msg}),a&&a(),0})).finally((function(){e.loadingBtn=0}))):(a&&a(),void this.$message.error("请设置要展示的课件"))},sendAnchorMsg:function(){var e=this;this.message?this.msgTime?(this.loadingBtn=2,s["a"].liveRoomAnchorMsg({roomId:this.roomId,msg:this.message,expire:this.msgTime}).then((function(t){e.$message.success("主播留言发送成功")})).catch((function(t){e.$error({title:"错误",content:"主播留言发送失败: "+t.msg})})).finally((function(){e.loadingBtn=0}))):this.$message.error("请设置主播留言要显示的时长"):this.$message.error("请输入要给主播发送的留言")},sendRoomMsg:function(){var e=this;this.danmaku?this.danmakuSpeed?this.danmakuTimes?(this.loadingBtn=3,s["a"].liveRoomMsg({roomId:this.roomId,msg:this.danmaku,expire:this.danmakuSpeed,times:this.danmakuTimes}).then((function(t){e.$message.success("公屏弹幕发送成功")})).catch((function(t){e.$error({title:"错误",content:"公屏弹幕发送失败: "+t.msg})})).finally((function(){e.loadingBtn=0}))):this.$message.error("请设置公屏弹幕的播放次数"):this.$message.error("请设置公屏弹幕的播放速度"):this.$message.error("请输入要发送的公屏弹幕")}}},$=L,R=(a("6c80"),a("0335"),Object(C["a"])($,l,c,!1,null,"392632d1",null)),U=R.exports,M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:920,maskClosable:!1,visible:e.visible,confirmLoading:e.spinning,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:e.onOk,cancel:e.onCancel}},[a("a-spin",{attrs:{spinning:e.spinning}},[a("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[a("uploader",{attrs:{visible:e.visible,form:e.form,label:"分享海报",exId:"shareImgUrl",listType:"picture-card",accept:".png, .jpg, .jpeg",comCSS:{width:"230px",height:"188px"},imgCSS:{width:"210px",height:"168px"},btnCSS:{width:"210px",height:"168px"},maxCount:1,fileType:"image",required:!1,"url-list":e.imgsShare,exName:"banner",exTip:"图片尺寸为420x336像素",tipMode:1},on:{uploadEvent:e.onUploadEvent}}),a("uploader",{attrs:{visible:e.visible,form:e.form,label:"半身像",exId:"coverMapImgUrl",listType:"picture-card",accept:".png, .jpg, .jpeg",comCSS:{width:"150px",height:"180px"},imgCSS:{width:"130px",height:"160px"},btnCSS:{width:"130px",height:"160px"},maxCount:1,fileType:"image",required:!1,"url-list":e.imgsBody,exName:"banner",exTip:"图片尺寸为260x320像素",tipMode:1},on:{uploadEvent:e.onUploadEvent}}),a("a-form-item",{attrs:{label:"启用半身像"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isCoverMapImg",{initialValue:e.isCoverMapImg,rules:[{required:!1,message:"必选"}]}],expression:"['isCoverMapImg', { initialValue: isCoverMapImg, rules: [{ required: false, message: '必选' }] }]"}],on:{change:e.onUseBodyImg}},[a("a-radio",{attrs:{value:1}},[e._v("是")]),a("a-radio",{attrs:{value:0}},[e._v("否")]),a("span",[e._v("（启用后首页直播banner中会显示半身像，彰显俱乐部IP）")])],1)],1),a("a-form-item",{attrs:{label:"封面图"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["coverIdx",{initialValue:e.coverIdx,rules:[{required:!1,message:"必选"}]}],expression:"['coverIdx', { initialValue: coverIdx, rules: [{ required: false, message: '必选' }] }]"}],on:{change:e.onCoverChange}},e._l(e.coverList,(function(t,i){return a("a-radio",{key:i,staticClass:"radio-cover",attrs:{value:i}},[a("div",{staticClass:"cover",class:e.coverIdx===i?"seletced":""},[a("img",{staticClass:"bg",attrs:{src:t,alt:""}}),e.isCoverMapImg&&e.coverMapImgUrl?a("img",{staticClass:"deco",attrs:{src:e.coverMapImgUrl,alt:""}}):e._e()])])})),1)],1)],1)],1)],1)},P=[],T=a("1da1"),q=(a("ac1f"),a("1276"),a("96cf"),{name:"PosterEdit",components:{Uploader:r["d"]},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){return this.formLayout={labelCol:{md:{span:4},xs:{span:24}},wrapperCol:{md:{span:20},xs:{span:24}}},{form:this.$form.createForm(this),editType:0,title:"直播间设置",spinning:!1,imgsShare:[],imgsBody:[],coverMapImgUrl:"",isCoverMapImg:0,coverList:[],coverIdx:0}},created:function(){var e=this;this.$watch("visible",function(){var t=Object(T["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=11;break}return e.imgsShare=[],e.imgsBody=[],e.shareImgUrl="",e.coverMapImgUrl="",e.isCoverMapImg=0,e.coverList=[],e.coverIdx=0,t.next=10,e.liveCoverList();case 10:e.reqLiveConfig();case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},mounted:function(){},befortDestory:function(){},methods:{onUploadEvent:function(e){var t=e.action,a=e.exId,i=e.file;"uploading"===t?this.spinning=!0:"done"===t?this.spinning=!1:"success"===t&&"coverMapImgUrl"===a&&(this.coverMapImgUrl=i.url)},liveCoverList:function(){var e=this;return this.spinning=!0,this.$store.dispatch("ta/LiveCoverList",!1).then((function(t){e.coverList=t||[]})).catch((function(e){})).finally((function(){}))},reqLiveConfig:function(){var e=this;this.spinning=!0,s["a"].liveConfig({}).then((function(t){var a=t.result.info,i=a.shareImgUrl,n=a.coverMapImgUrl,o=a.isCoverMapImg,s=a.coverImgUrl;if(e.imgsShare=[i],e.imgsBody=[n],e.shareImgUrl=i,e.coverMapImgUrl=n,e.isCoverMapImg=o,s){var r=s.split("?")[0];e.coverIdx=e.coverList.findIndex((function(e){return e.indexOf(r)>-1}))}e.form.setFieldsValue({coverIdx:e.coverIdx})})).catch((function(e){})).finally((function(){e.spinning=!1}))},onUseBodyImg:function(e){var t=e.target.value;this.isCoverMapImg=t},onCoverChange:function(e){var t=e.target.value;this.coverIdx=t},onCancel:function(){this.$emit("cancel")},onOk:function(){var e=this;this.form.validateFieldsAndScroll((function(t,a){if(e.spinning=!0,t)e.spinning=!1;else{var i=Object(o["a"])({clubId:e.$store.getters.taClubId},a);i.coverImgUrl=e.coverList[i.coverIdx],delete i.coverIdx;var n="updateLiveConfig";s["a"][n]({info:i}).then((function(t){e.$message.success("操作成功"),e.$emit("ok")})).catch((function(e){})).finally((function(){e.spinning=!1}))}}))}}}),V=q,F=(a("8d3f"),Object(C["a"])(V,M,P,!1,null,"0acedd5c",null)),D=F.exports,E={name:"Lives",components:{STable:r["c"],LiveEdit:U,LiveConfig:D},data:function(){return this.formLayout={labelCol:{md:{span:7}},wrapperCol:{md:{span:17}}},this.columns=v,{modalVisible:!1,confirmLoading:!1,modalData:{},posterModalVisible:!1,posterModalData:{},queryParam:{},loadData:this.reqLiveRooms,selectedRowKeys:[],selectedRows:[],switchIndex:"",roomStatesList:g}},filters:{available:function(e){return 1===e.isAdmin}},created:function(){var e=this;this.$root.eventHub.$on("refreshView",(function(){e.$refs.table&&e.$refs.table.refresh()}))},beforeRouteLeave:function(e,t,a){this.$root.eventHub.$off("refreshView"),a()},computed:{tableX:function(){var e=0;return this.columns.forEach((function(t){e+=t.width||t.minWidth||0})),e},rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},methods:{reqLiveRooms:function(e){var t=this,a=Object(o["a"])(Object(o["a"])({},this.queryParam),e);return a.pageNum=e.pageNo,s["a"].liveRoomList(a).then((function(t){var a=t.result,i=a.roomInfoList||[];i.forEach((function(e){y(e)}));var n={totalCount:a.total,pageNo:e.pageNo,data:i};return n})).catch((function(e){})).finally((function(){t.onSelectChange([],[])}))},reqChatMsgs:function(e){var t=this;e.loading=!0;var a={roomId:e.id};return s["a"].liveRoomChats(a).then((function(e){var a=e.result,i=a.exportUrl;i?window.open(i,"_blank"):t.$message.error("消息记录暂未生成")})).catch((function(e){})).finally((function(){e.loading=!1}))},handlePoster:function(){this.posterModalData={},this.posterModalVisible=!0},onPosterDone:function(){this.posterModalData={},this.posterModalVisible=!1},handleAdd:function(){this.modalData={},this.modalVisible=!0},handleEdit:function(e){if(e);else{if(!this.selectedRowKeys.length)return;e=this.selectedRows[0]}this.modalVisible=!0,this.modalData=Object(o["a"])(Object(o["a"])({},e),{},{id:e.id,name:e.name})},onUpdateDone:function(){this.confirmLoading=!0,this.$refs.table.refresh(),this.onUpdateCancel()},onUpdateCancel:function(e){this.modalVisible=!1,this.confirmLoading=!1,this.modalData={};var t=this.$refs.createModal.form;t.resetFields(),e&&this.$refs.table.refresh()},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},resetQueryParams:function(){this.onSelectChange([],[]),this.queryParam={},this.$refs.table.refresh(!0)}}},N=E,j=(a("2f43"),Object(C["a"])(N,i,n,!1,null,"4b2000f0",null));t["default"]=j.exports},"8d3f":function(e,t,a){"use strict";a("29ca")},a366:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:500,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,destroyOnClose:!0,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:function(){return e.$emit("ok",e.modify)},cancel:function(){return e.$emit("cancel",e.modify)}}},[a("a-spin",{attrs:{spinning:e.spinning}},[a("uploader",{staticStyle:{margin:"-5px 0",padding:"0"},attrs:{visible:e.visible,exId:"",listType:"text",accept:".ppt, .pptx",fileType:"document",maxCount:5,maxSize:e.pptSize,exName:"preRoomClass/"+this.roomId,showUploadList:!1,noTime:!0},on:{uploadEvent:e.onUploadEvent}},[a("a-button",{attrs:{slot:"btn",type:"primary",icon:"upload",disabled:e.fileList.length>=5},slot:"btn"},[e._v(" 上传课件 ")])],1),a("a-table",{staticStyle:{"margin-top":"20px"},attrs:{columns:e.columns,rowKey:"uid","data-source":e.fileList,pagination:!1,showHeader:!0,locale:{emptyText:"暂无课件"}},scopedSlots:e._u([{key:"name",fn:function(t){return a("span",{},[[a("span",[e._v(e._s(e._f("ellipsis")(t)))])]],2)}},{key:"action",fn:function(t,i){return a("span",{},[[a("a",{staticStyle:{color:"#1890ff"},on:{click:function(t){return e.handlePreView(i)}}},[e._v("预览")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{staticStyle:{color:"#f12323"},on:{click:function(t){return e.handleDelete(i)}}},[e._v("删除课件")])]],2)}}])})],1),a("a-modal",{attrs:{title:"预览",width:1e3,maskClosable:!1,visible:e.preViewVisible,destroyOnClose:!0,centered:!0,bodyStyle:{height:"600",overflowY:"auto"},footer:null},on:{cancel:function(){e.preViewVisible=!1}}},[a("pre-view",{attrs:{imgs:e.preViewImgs}})],1)],1)},n=[],o=(a("a9e3"),a("d3b7"),a("d81d"),a("b0c0"),a("99af"),a("4282")),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-carousel",{ref:"carousel",attrs:{arrows:"","dots-class":"slick-dots slick-thumb","after-change":e.onChange}},[a("div",{staticClass:"custom-slick-arrow",staticStyle:{left:"10px",zIndex:"1"},attrs:{slot:"prevArrow"},slot:"prevArrow"},[a("a-icon",{attrs:{type:"left-circle"}})],1),a("div",{staticClass:"custom-slick-arrow",staticStyle:{right:"10px"},attrs:{slot:"nextArrow"},slot:"nextArrow"},[a("a-icon",{attrs:{type:"right-circle"}})],1),e._l(e.imgs,(function(e,t){return a("div",{key:t},[a("img",{attrs:{src:e}})])}))],2),a("div",{staticClass:"row-center-center"},[a("span",{staticStyle:{"margin-right":"20px"}},[e._v(e._s(e.curIndex+"/"+e.imgs.length))]),a("span",{staticStyle:{"margin-right":"10px"}},[e._v("跳转")]),a("a-input-number",{staticStyle:{width:"80%"},attrs:{size:"small",min:1,max:e.imgs.length},on:{change:e.onJumpChange,pressEnter:e.onJumpEnter}}),a("span",{staticStyle:{"margin-left":"10px"}},[e._v("页")])],1)],1)},r=[],l={props:{imgs:{type:Array,default:function(){}}},data:function(){return{curIndex:1}},methods:{getImgUrl:function(e){return this.imgs[e]},onChange:function(e){this.curIndex=e+1},onJumpChange:function(e){},onJumpEnter:function(e){var t=this.$refs["carousel"],a=e.target.value;a<1||a>this.imgs.length||t&&a&&t.goTo(a-1)}}},c=l,u=(a("0fe9c"),a("2877")),m=Object(u["a"])(c,s,r,!1,null,"65d6e6c1",null),d=m.exports,f=a("2af9"),p=[{title:"课件名称",dataIndex:"name",scopedSlots:{customRender:"name"}},{title:"操作",scopedSlots:{customRender:"action"}}],h={name:"PreRoomClass",components:{PreView:d,Uploader:f["d"]},props:{visible:{type:Boolean,required:!0},roomId:{type:Number,default:0},source:{type:Number,default:0}},data:function(){return this.columns=p,{form:this.$form.createForm(this),title:"课件管理",spinning:!1,loading:!1,fileList:[],preViewImgs:[],preViewVisible:!1,pptSize:30,modify:!1}},watch:{roomId:function(e){}},filters:{ellipsis:function(e){return e.length>20?e.substring(0,17)+"...":e}},created:function(){var e=this;this.$watch("visible",(function(t){t&&(e.modify=!1,e.fileList=[],e.roomId&&e.loadData(e.roomId))}))},mounted:function(){},methods:{loadData:function(e){var t=this,a=this.source,i="preRoomSpeechFileList";a&&(i="liveRoomCourses"),this.spinning=!0,o["a"][i]({preRoomId:e,roomId:e},a).then((function(e){var a=e.result.fileList||e.result.speechFileList;t.fileList=a.map((function(e){return{name:e.fileName,uid:e.id,status:"done",url:e.fileUrl,pageCount:e.pageCount}}))})).catch((function(e){})).finally((function(){t.spinning=!1}))},onUploadEvent:function(e){var t=e.action,a=e.err,i=e.file;"uploading"===t?this.spinning=!0:"done"===t?a&&(this.spinning=!1):"success"===t&&this.updateFileList(i.url,i.name)},updateFileList:function(e,t){var a=this;if(e){var i=this.roomId,n=this.source;this.spinning=!0,o["a"].preRoomSpeechFileUpload({preRoomId:i,roomId:i,fileOssUrl:e,srcType:"pptx"},n).then((function(e){a.modify=!0,a.loadData(a.roomId),a.$message.success("文件已上传")})).catch((function(e){})).finally((function(){a.spinning=!1}))}},handleDelete:function(e){var t=this;this.$confirm({title:"是否删除课件？",content:"删除后课件信息将无法找回。",onOk:function(){t.doDelete(e)},onCancel:function(){}})},doDelete:function(e){var t=this,a=this.roomId,i=this.source,n="adminPreRoomSpeechFileRemove";i&&(n="deleteLiveRoomCourse"),this.spinning=!0,o["a"][n]({preRoomId:a,roomId:a,fileId:e.uid}).then((function(e){t.modify=!0,t.loadData(t.roomId),t.$message.success("文件已删除")})).catch((function(e){})).finally((function(){t.spinning=!1}))},handlePreView:function(e){for(var t=this,a=[],i=1;i<=e.pageCount;i++)a.push("".concat(e.url,"/").concat(i,".png"));this.preViewImgs=a,this.$nextTick((function(){t.preViewVisible=!0}))}}},g=h,v=Object(u["a"])(g,i,n,!1,null,null,null);t["a"]=v.exports},a7e3:function(e,t,a){"use strict";a("53e4")},ac77:function(e,t,a){},bcb7:function(e,t,a){},e1d1:function(e,t,a){}}]);
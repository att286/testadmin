(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["user"],{"0748":function(t,e,a){"use strict";a("a667")},2017:function(t,e,a){"use strict";a("cafe")},"30d4":function(t,e,a){t.exports=a.p+"img/bg_form.f9972ad3.png"},"9ed6":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"login-container"},[o("img",{staticClass:"login-bg",attrs:{src:a("c718"),alt:""}}),o("img",{staticClass:"login-logo",attrs:{src:a("ceca"),alt:""}}),o("img",{staticClass:"login-form-bg",attrs:{src:a("30d4"),alt:""}}),t._m(0),t.showMdy?o("a-form",{ref:"modifyForm",staticClass:"login-form",attrs:{"auto-complete":"off",form:t.form},on:{submit:t.handleModify}},[o("p",{staticClass:"tips"},[t._v("欢迎您使用梧桐客户平台，您的密码为初始密码，建议您进行修改提高账号的安全性。")]),o("a-form-item",{staticStyle:{background:"#F5F7FA"},style:t.inputStyle,attrs:{prop:"username"}},[o("a-input",{ref:"usernameM",attrs:{placeholder:"",name:"usernameM",type:"text","auto-complete":"off",disabled:""},model:{value:t.modifyForm.username,callback:function(e){t.$set(t.modifyForm,"username",e)},expression:"modifyForm.username"}},[o("a-icon",{staticStyle:{color:"rgba(0, 0, 0, .25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),o("a-form-item",{staticStyle:{background:"#F5F7FA"},style:t.inputStyle,attrs:{prop:"phone"}},[o("a-input",{ref:"phoneM",attrs:{placeholder:"",name:"phoneM",type:"text","auto-complete":"off",disabled:""},model:{value:t.modifyForm.phone,callback:function(e){t.$set(t.modifyForm,"phone",e)},expression:"modifyForm.phone"}},[o("a-icon",{staticStyle:{color:"rgba(0, 0, 0, .25)"},attrs:{slot:"prefix",type:"mobile"},slot:"prefix"})],1)],1),o("a-form-item",{style:t.inputStyle,attrs:{prop:"passwordM"}},[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["passwordM",{initialValue:t.modifyForm.password,rules:[{validator:t.validatePassword}]}],expression:"['passwordM', { initialValue: modifyForm.password, rules: [{ validator: validatePassword }] }]"}],ref:"passwordM",attrs:{type:"password",placeholder:"请输入密码",name:"passwordM",tabindex:"4","auto-complete":"off",maxLength:20,"allow-clear":""}},[o("a-icon",{staticStyle:{color:"rgba(0, 0, 0, .25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),o("a-form-item",{style:t.inputStyle,attrs:{prop:"passwordM2"}},[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["passwordM2",{initialValue:t.modifyForm.password2,rules:[{validator:t.validatePassword2}]}],expression:"['passwordM2', { initialValue: modifyForm.password2, rules: [{ validator: validatePassword2 }] }]"}],key:"passwordM2",ref:"passwordM2",attrs:{type:"password",placeholder:"请再次输入密码",name:"passwordM2",tabindex:"5","auto-complete":"off",maxLength:20,"allow-clear":""}},[o("a-icon",{staticStyle:{color:"rgba(0, 0, 0, .25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),o("a-form-item",{style:t.inputStyle,attrs:{prop:"code"}},[o("div",{staticClass:"row-start-center",staticStyle:{position:"relative",height:"100%"}},[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["code",{initialValue:t.modifyForm.code,rules:[{validator:t.validateCode}]}],expression:"['code', { initialValue: modifyForm.code, rules: [{ validator: validateCode }] }]"}],ref:"codeM",attrs:{placeholder:"请输入验证码",name:"codeM",type:"text",tabindex:"6","auto-complete":"off",maxLength:4,"allow-clear":""}},[o("a-icon",{staticStyle:{color:"rgba(0, 0, 0, .25)"},attrs:{slot:"prefix",type:"mail"},slot:"prefix"}),t.smsTimer?o("p",{staticStyle:{color:"#F12323"},attrs:{slot:"suffix"},slot:"suffix"},[t._v(t._s(t.smsCD)+"s")]):o("a",{staticStyle:{color:"#F12323"},attrs:{slot:"suffix"},on:{click:t.getSMSCode},slot:"suffix"},[t._v("获取验证码")])],1)],1)]),o("a-form-item",[o("a-button",{staticClass:"login-button modify-button",attrs:{loading:t.loading,type:"primary",htmlType:"submit"}},[t._v("修改")])],1)],1):o("a-form",{ref:"loginForm",staticClass:"login-form",attrs:{id:"loginForm",form:t.form},on:{submit:t.handleLogin}},[o("div",{staticClass:"title-container"},[o("h3",{staticClass:"title"},[t._v("登录")]),o("div",{staticClass:"decoration"})]),o("a-form-item",{style:t.inputStyle,attrs:{prop:"username"}},[o("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["username",{initialValue:t.loginForm.username,rules:[{validator:t.validateUsername}]}],expression:"['username', { initialValue: loginForm.username, rules: [{ validator: validateUsername }] }]"}],ref:"username",attrs:{placeholder:"请输入账号",name:"username",type:"text",tabindex:"1","auto-complete":"on","allow-clear":""}},[o("a-icon",{staticStyle:{color:"rgba(0, 0, 0, .25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),o("a-form-item",{style:t.inputStyle,attrs:{prop:"password"}},[o("a-input-password",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{initialValue:t.loginForm.password,rules:[{validator:t.validatePassword}]}],expression:"['password', { initialValue: loginForm.password, rules: [{ validator: validatePassword }] }]"}],ref:"password",attrs:{placeholder:"请输入密码",name:"password",tabindex:"2","auto-complete":"on","allow-clear":"","has-feedback":""}},[o("a-icon",{staticStyle:{color:"rgba(0, 0, 0, .25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),o("a-form-item",[o("a-button",{staticClass:"login-button",attrs:{loading:t.loading,type:"primary",htmlType:"submit"}},[t._v("登录")])],1)],1)],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login-bg"},[a("div",{staticClass:"login-info"},[a("div",{staticClass:"line"}),a("p",{staticClass:"title"},[t._v("梧桐栖凤平台")]),a("p",{staticClass:"desc"},[t._v(" © 2021 All Rights Reserved."),a("br"),t._v("Beijing Wutonghuakai Tech Co., Ltd ")])])])}],r=a("5530");a("d3b7");function i(t){return!!t}var n=a("a18c"),l=a("f306"),d={name:"Login",data:function(){return{form:this.$form.createForm(this),showMdy:!1,smsCD:60,smsTimer:null,loginForm:{username:"",password:""},modifyForm:{username:"",phone:"",password:"",password2:"",code:""},loading:!1,inputStyle:{width:"80%","margin-left":"auto","margin-right":"auto"}}},watch:{$route:{handler:function(t){},immediate:!0}},created:function(){Object(n["c"])(this.$router)},mounted:function(){},methods:{validateUsername:function(t,e,a){i(e)?a():a(new Error("请输入用户名"))},validatePassword:function(t,e,a){var o=/^.*(?=.{6,30})(?=.*\d)(?=.*[a-zA-Z]).*/;e?"123456"===e||o.test(e)?a():a(new Error("密码应为6-30位(必须包含字母与数字)")):a(new Error("请输入密码"))},validatePassword2:function(t,e,a){var o=this.$refs.passwordM.value;e?e!==o?a(new Error("两次输入的密码不一致")):a():a(new Error("请再次输入密码"))},validateCode:function(t,e,a){e?4!==e.length?a(new Error("请输入正确的验证码")):a():a(new Error("请输入验证码"))},handleLogin:function(t){var e=this;t.preventDefault(),this.form.validateFields((function(t,a){if(t)return e.loading=!1,!1;e.loading=!0;var o={loginName:a.username,password:a.password};e.$store.dispatch("login",o).then((function(t){e.loginForm=Object(r["a"])({},a),e.onLoginDone(t)})).catch((function(t){})).finally((function(){e.loading=!1}))}))},onLoginDone:function(t){"1"===t.mustResetPasswordFlag?(this.showMdy=!0,this.userId=t.userId,this.modifyForm.username=t.userName,this.modifyForm.phone=t.userPhone,this.loginData=t):this.$router.push({path:this.redirect||"/"}),this.loading=!1,l["a"].recorderRequest({pageId:"200101",clickId:"200001"})},getSMSCode:function(){var t=this;this.showSmsCD();var e={mobile:this.modifyForm.phone};l["a"].smsCode(e).then((function(t){})).catch((function(e){if("string"===typeof e){var a="系统异常";"0001"===e?a="60秒内不能重复获取":"0002"===e?a="今日获取验证码次数已达上限":"0003"===e?a="签名错误":"0004"===e?a="手机号无效":"0004"===e&&(a="发送信息失败"),t.$message({message:a,type:"info",duration:5e3,center:!0})}t.loading=!1}))},showSmsCD:function(){var t=this;this.smsCD--,this.smsTimer=setInterval((function(){t.smsCD--,0===t.smsCD&&t.stopSmsCD()}),1e3)},stopSmsCD:function(){this.smsTimer&&(clearInterval(this.smsTimer),this.smsTimer=null,this.smsCD=60)},handleModify:function(t){var e=this;t.preventDefault(),this.form.validateFields((function(t,a){if(t)return e.loading=!1,!1;e.loading=!0;var o={newPassword:a.passwordM2,smsCode:a.code};l["a"].initPwd(o).then((function(t){e.onModifyDone(t)})).catch((function(t){e.loading=!1}))}))},onModifyDone:function(t){this.loading=!1,"0000"===t.responseCode&&(this.loginData.mustResetPasswordFlag="0",this.loginData.password=this.$refs.passwordM2.value,this.onLoginDone(this.loginData))}}},c=d,m=(a("2017"),a("0748"),a("2877")),p=Object(m["a"])(c,o,s,!1,null,"1ec36ddd",null);e["default"]=p.exports},a667:function(t,e,a){},c718:function(t,e,a){t.exports=a.p+"img/bg_page.c507d0a1.png"},cafe:function(t,e,a){},ceca:function(t,e,a){t.exports=a.p+"img/logo.2c395738.png"}}]);
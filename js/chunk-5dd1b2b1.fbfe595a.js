(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5dd1b2b1"],{"416b":function(e,t,n){"use strict";n("936c")},"936c":function(e,t,n){},9582:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("page-header-wrapper",{attrs:{title:!1}},[n("a-spin",{attrs:{spinning:e.spinning}},[n("a-card",{attrs:{bordered:!1}},[e.allRowKeys.length?n("div",{staticClass:"icon-expand ant-table-row-expand-icon",class:e.expandedAll?"ant-table-row-expanded":"ant-table-row-collapsed",on:{click:e.expandAll}}):e._e(),n("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",columns:e.columns,data:e.loadData,alert:!1,rowSelection:null,scroll:{x:e.tableX},showPagination:!1,expandRowByClick:!1,expandedRowKeys:e.expandedRowKeys,expandIcon:e.customExpandIcon},on:{expand:e.onExpand},scopedSlots:e._u([{key:"expandedRowRender",fn:function(t){return n("span",{},[n("a-table",{staticClass:"custom-table",attrs:{size:"default",rowKey:"id",columns:e.subColumns,"data-source":t.couponInfos,pagination:!1,rowClassName:function(e,t){return"custom-row"}},scopedSlots:e._u([{key:"payLink",fn:function(t,i){return n("span",{},[n("a-popover",{attrs:{title:"原价链接"},on:{visibleChange:function(t){return e.onPopoverVisible(t,i)}},scopedSlots:e._u([{key:"content",fn:function(){return[n("div",{staticClass:"column-start-center",staticStyle:{position:"relative"}},[n("div",{ref:"linkQrCode"+i.id,style:{width:e.qrSize+"px",height:e.qrSize+"px"}}),n("div",{staticClass:"row-center-center"},[e.clipboardEnable?n("a",{ref:"copyQR"+i.id,staticStyle:{color:"#1890ff","margin-top":"16px","margin-right":"16px"},on:{click:function(t){return e.downloadQR(i,1)}}},[e._v("复制二维码")]):e._e(),n("a",{ref:"downloadQR"+i.id,staticStyle:{color:"#1890ff","margin-top":"16px"},on:{click:function(t){return e.downloadQR(i)}}},[e._v("下载二维码")])]),n("a",{staticStyle:{color:"#1890ff","margin-top":"8px"},attrs:{title:t},on:{click:function(n){return e.onShortTxtClick(t)}}},[e._v("复制链接")])])]},proxy:!0}],null,!0)},[n("a",{staticStyle:{color:"#1890ff"},attrs:{title:t},on:{click:function(t){return t.preventDefault(),e.test(t)}}},[e._v("查看")])])],1)}},{key:"available",fn:function(t,i,a,o){return n("span",{},[n("a-switch",{attrs:{loading:i.teamId+"-"+a===e.switchIndex,checked:e._f("available")(t)},on:{change:function(n){return e.onStatusChange(n,t,i,a,o.dataIndex)}}})],1)}},{key:"action",fn:function(i,a){return n("span",{},[[n("a",{staticStyle:{color:"#1890ff"},on:{click:function(n){return e.handleUpdate(2,t,a)}}},[e._v("编辑")]),n("a-divider",{attrs:{type:"vertical"}}),n("a",{staticStyle:{color:"#f12323"},on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除")])]],2)}}],null,!0)})],1)}},{key:"shortTxt",fn:function(t){return n("span",{},[n("a",{staticStyle:{color:"#1890ff"},attrs:{title:t},on:{click:function(n){return e.onShortTxtClick(t)}}},[e._v("点击复制")])])}},{key:"payLink",fn:function(t,i){return n("span",{},[n("a-popover",{attrs:{title:"原价链接"},on:{visibleChange:function(t){return e.onPopoverVisible(t,i)}},scopedSlots:e._u([{key:"content",fn:function(){return[n("div",{staticClass:"column-start-center",staticStyle:{position:"relative"}},[n("div",{ref:"linkQrCode"+i.id,style:{width:e.qrSize+"px",height:e.qrSize+"px"}}),n("div",{staticClass:"row-center-center"},[e.clipboardEnable?n("a",{ref:"copyQR"+i.id,staticStyle:{color:"#1890ff","margin-top":"16px","margin-right":"16px"},on:{click:function(t){return e.downloadQR(i,1)}}},[e._v("复制二维码")]):e._e(),n("a",{ref:"downloadQR"+i.id,staticStyle:{color:"#1890ff","margin-top":"16px"},on:{click:function(t){return e.downloadQR(i)}}},[e._v("下载二维码")])]),n("a",{staticStyle:{color:"#1890ff","margin-top":"8px"},attrs:{title:t},on:{click:function(n){return e.onShortTxtClick(t)}}},[e._v("复制链接")])])]},proxy:!0}],null,!0)},[n("a",{staticStyle:{color:"#1890ff"},attrs:{title:t},on:{click:function(t){return t.preventDefault(),e.test(t)}}},[e._v("查看")])])],1)}},{key:"available",fn:function(t,i,a,o){return n("span",{},[n("a-switch",{attrs:{loading:a===e.switchIndex,checked:e._f("available")(t)},on:{change:function(n){return e.onStatusChange(n,t,i,a,o.dataIndex)}}})],1)}},{key:"action",fn:function(t,i){return n("span",{},[[n("a",{staticStyle:{color:"#1890ff"},on:{click:function(t){return e.handleUpdate(1,i)}}},[e._v("添加优惠券")])]],2)}}])},[n("span",{attrs:{slot:"customHead_expand"},slot:"customHead_expand"},[e.allRowKeys.length?n("div",{staticClass:"ant-table-row-expand-icon",class:e.expandedAll?"ant-table-row-expanded":"ant-table-row-collapsed",on:{click:e.expandAll}}):e._e()]),n("span",{attrs:{slot:"customCell_expand"},slot:"customCell_expand"},[n("div",{staticClass:"ant-table-row-expand-icon ant-table-row-expanded"})])])],1),n("member-edit",{ref:"memberModal",attrs:{visible:1===e.modalVisible,loading:1===e.confirmLoading,model:e.modalData},on:{cancel:e.onUpdateCancel,ok:e.onUpdateDone}}),n("coupon-edit",{ref:"couponModal",attrs:{visible:2===e.modalVisible,loading:2===e.confirmLoading,model:e.modalData},on:{cancel:e.onUpdateCancel,ok:e.onUpdateDone}})],1)],1)},a=[],o=n("ade3"),r=n("5530"),s=n("1da1"),c=(n("96cf"),n("159b"),n("d81d"),n("b0c0"),n("4de4"),n("d3b7"),n("b680"),n("7db0"),n("99af"),n("c740"),n("a434"),n("4360")),l=n("2af9"),u=n("4282"),d=n("ca00"),p=n("10a2"),m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-modal",{attrs:{title:e.title,width:640,maskClosable:!1,visible:e.visible,confirmLoading:e.spinning,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:function(t){e.handleSubmit(t)},cancel:function(){e.$emit("cancel")}}},[n("a-spin",{attrs:{spinning:e.spinning}},[n("a-form",e._b({attrs:{form:e.form},on:{submit:e.handleSubmit}},"a-form",e.formLayout,!1),[n("a-form-item",{attrs:{label:"所属会员"}},[n("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["teamId",{initialValue:e.member.id,rules:[{required:!0,message:"必填"}]}],expression:"['teamId', { initialValue: member.id, rules: [{ required: true, message: '必填' }] }]"}],attrs:{placeholder:"请选择",disabled:!!e.model.member,options:e.allMembers},on:{change:e.onMemberChange}})],1),n("a-form-item",{attrs:{label:"划线价"}},[e._v(" "+e._s(e.member.originalPriceStr?e.member.originalPriceStr+"元":"--")+" ")]),n("a-form-item",e._b({attrs:{label:"优惠券名称"}},"a-form-item",e.formLayout,!1),[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{initialValue:e.coupon.name,rules:[{required:!0,whitespace:!0,max:16,message:"请输入长度不大于16的字符"},{validator:e.checkName}]}],expression:"['name', { initialValue: coupon.name, rules: [{ required: true, whitespace: true, max: 16, message: '请输入长度不大于16的字符' }, { validator: checkName }] }]"}],attrs:{placeholder:"请输入","allow-clear":""}})],1),n("a-form-item",e._b({attrs:{label:"优惠券面值"}},"a-form-item",e.formLayout,!1),[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["discountValue",{initialValue:e.discountValue,rules:[{required:!0,whitespace:!0,type:"number",transform:e.transformInputNumber,min:e.discountLimitMin,max:e.discountLimitMax,message:"请输入"+e.discountLimitMin+"~"+e.discountLimitMax+"的数字"}]}],expression:"['discountValue', { initialValue: discountValue, rules: [{ required: true, whitespace: true, type:'number', transform: transformInputNumber, min: discountLimitMin, max: discountLimitMax, message: `请输入${discountLimitMin}~${discountLimitMax}的数字` }] }]"}],attrs:{placeholder:"请输入","allow-clear":"","addon-before":e.discountTypeStr,"addon-after":e.discountTypeUnit},on:{change:e.onDiscountInput}})],1),n("a-form-item",e._b({attrs:{label:"券后实付价格"}},"a-form-item",e.formLayout,!1),[n("span",[e._v(e._s(e.discountPriceStr))])]),n("a-form-item",{attrs:{label:"库存数量",extra:"不填表示无限库存"}},[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["residueNum",{initialValue:e.residueNum,rules:[{required:!1,whitespace:!0,message:"请输入大于等于0的整数"},{validator:e.checkNumber}]}],expression:"['residueNum', { initialValue: residueNum, rules: [\n            { required: false, whitespace: true, message: '请输入大于等于0的整数' }, { validator: checkNumber }\n          ] }]"}],attrs:{placeholder:"请输入","allow-clear":""}})],1),n("a-form-item",{attrs:{label:"开放购买"}},[n("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isActive",{initialValue:e.coupon.isActive||1,rules:[{required:!0,message:"必填"}]}],expression:"['isActive', { initialValue: coupon.isActive || 1, rules: [{ required: true, message: '必填' }] }]"}]},[n("a-radio",{key:"2",attrs:{value:1}},[e._v("开启")]),n("a-radio",{key:"1",attrs:{value:0}},[e._v("关闭")])],1)],1),n("a-form-item",{attrs:{label:"会员宣传页素材",required:""}},[n("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["MemberPoster",{initialValue:e.coupon.payPosterImg,rules:[{required:!0,message:"请上传宣传页图片素材"}]}],expression:"['MemberPoster', { initialValue: coupon.payPosterImg, rules: [{ required: true, message: '请上传宣传页图片素材' }] }]"}],staticClass:"avatar-uploader",attrs:{name:"MemberPoster",accept:".jpg,.gif,.png","list-type":"picture-card",showUploadList:!1,beforeUpload:e.beforeUploadPoster}},[e.posterInfo.show?n("div",{staticClass:"img-container"},[n("img",{staticStyle:{"max-width":"420px","max-height":"300px"},attrs:{src:e.posterInfo.img,alt:"海报"}}),e.posterData?n("div",{staticClass:"delete-container row-center-center"},[n("a-icon",{style:{fontSize:"24px",color:"white"},attrs:{type:"delete"},on:{click:function(t){return t.stopPropagation(),e.resetUploadImg(1)}}})],1):e._e()]):n("div",[n("a-icon",{attrs:{type:"plus"}}),n("div",{staticStyle:{"margin-top":"10px",color:"#666"}},[e._v("上传宣传页图片")])],1)])],1)],1)],1)],1)},f=[],h=(n("caad"),n("2532"),n("a9e3"),n("3ca3"),n("ddb0"),n("7858")),b=n("c3ea"),v=b["e"],g={name:"CouponEdit",props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){return this.formLayout={labelCol:{span:6},wrapperCol:{span:18}},this.formItemLayout={labelCol:{span:5},wrapperCol:{span:19}},{form:this.$form.createForm(this),spinning:!1,editType:0,title:"优惠券",submitMethod:"",unlimitedVal:b["i"],couponList:[],member:{},coupon:{},allMembers:[],residueNum:"",price:0,couponUseType:b["d"],discountValue:"",discountLimitMin:0,discountLimitMax:0,discountTypeVal:0,discountTypeStr:"",discountTypeUnit:"",discountPrice:"",discountPriceStr:"--",posterData:null,posterImg:null,posterUrl:"",qrCodeData:null,qrCodeImg:null,qrCodeUrl:"",qrSize:256,transformInputNumber:function(e){var t=+e;return""===e&&(t=NaN),t}}},computed:{posterInfo:function(){var e={show:!1,img:""},t=this.posterImg||this.coupon.payPosterImg;return t&&(e.show=!0,e.img=t),e},qrCodeInfo:function(){var e={show:!1,img:""},t=this.qrCodeImg||this.coupon.contact;return t&&(e.show=!0,e.img=t),e}},created:function(){var e=this;this.$watch("visible",(function(t,n){if(t){e.form.resetFields(),e.posterData=null,e.posterImg=null,e.qrCodeData=null,e.qrCodeImg=null,e.price=e.model.price/100;var i=e.model,a=i.member,o=void 0===a?{}:a,r=i.coupon,s=void 0===r?{}:r,c=i.allMembers,l=void 0===c?[]:c;e.member=o,e.coupon=s,e.allMembers=l,s.id?(e.editType=1,e.title="修改优惠券信息",e.submitMethod="updateCoupon"):(e.editType=0,e.title="新增优惠券",e.submitMethod="addCoupon"),e.setMemberInfo(),e.setUseTypeAddon(e.discountTypeVal);var u=o.couponInfos,d=void 0===u?[]:u;e.couponList=d.filter((function(e){return e.name!==s.name})).map((function(e){return e.name}))}}))},mounted:function(){},methods:{setMemberInfo:function(){var e=this.coupon,t=e.useType,n=void 0===t?v.cut.value:t,i=e.discountValue,a=e.price,o=e.residueNum,r=void 0===o?"":o;this.discountTypeVal=n,this.discountValue=i,this.discountPrice=a?(a/100).toFixed(2):"",this.residueNum=r===b["i"]?"":r,this.coupon.id&&(Object(d["p"])(i)?n===v.cut.value?this.discountValue=i/100:this.discountValue=i/10:this.discountValue="",this.calcDiscountPrice())},setUseTypeAddon:function(e){var t=this.member.originalPrice;e===v.cut.value?(this.discountTypeStr="直减",this.discountTypeUnit="元",this.discountLimitMin=.01,this.discountLimitMax=(t-1)/100):(this.discountTypeStr="减至",this.discountTypeUnit="折",this.discountLimitMin=.1,this.discountLimitMax=9.9)},calcDiscountPrice:function(){var e=this;this.$nextTick((function(){var t=e.member.originalPriceStr,n=e.form.getFieldsValue(["discountValue"]),i=n.discountValue,a=e.discountTypeVal;if(!Object(d["p"])(t)||!Object(d["p"])(i)||!Object(d["p"])(a))return e.discountPrice="",void(e.discountPriceStr="--");if(a===v.cut.value?e.discountPrice=(t-i).toFixed(2):e.discountPrice=(t*i/10).toFixed(2),(i<e.discountLimitMin||i>e.discountLimitMax)&&(e.discountPrice=""),Object(d["p"])(e.discountPrice)){var o=(e.discountPrice/t*10).toFixed(1);e.discountPriceStr="".concat(e.discountPrice,"元（≈").concat(o,"折）")}else e.discountPriceStr="--"}))},checkName:function(e,t,n){var i=!1;this.couponList.includes(t)&&(i=!0),i?n(new Error("不能与其他优惠券名称重复")):n()},checkNumber:function(e,t,n){var i=!0;t>=0&&+t===Math.round(t)&&(i=!1),i?n(new Error("请输入大于等于0的整数")):n()},handleSubmit:function(e){var t=this;this.form.validateFieldsAndScroll((function(e,n){if(!e){var i=Object.assign({},n);t.coupon.id&&(i.id=t.coupon.id),i.useType=t.discountTypeVal,i.useType===v.cut.value?i.discountValue*=100:i.discountValue*=10,delete i.MemberContactWX,delete i.MemberPoster,""===i.residueNum?i.residueNum=b["i"]:i.residueNum=Number(i.residueNum),t.uploadPics().then((function(){t.posterData&&(i.payPosterImg=t.posterUrl),t.qrCodeData&&(i.contact=t.qrCodeUrl);var e=t.submitMethod,n=i;i.couponType=b["c"].buy.value,t.spinning=!0,u["a"][e](n).then((function(e){t.spinning=!1,t.posterData=null,t.qrCodeData=null,t.$message.success("操作成功"),t.$emit("ok")})).catch((function(e){t.spinning=!1}))})).catch((function(e){}))}}))},onMemberChange:function(e){this.member=this.allMembers.find((function(t){return t.value===e}))},onDiscountTypeChange:function(e,t){e=e.target.value,this.discountTypeVal=e,this.setUseTypeAddon(e),this.form.setFieldsValue({discountValue:""}),this.discountPrice="",this.discountPriceStr="--"},onDiscountInput:function(e){e.target.value;this.calcDiscountPrice()},beforeUploadPoster:function(e){this.beforeUpload(e,1)},beforeUploadQrCode:function(e){this.beforeUpload(e,2)},beforeUpload:function(e,t){var n=e.size/1024/1024<5;return n?(this.handleFile(e,t),!1):(this.$message.error("图片需要小于5MB!"),!1)},handleFile:function(e,t){var n=this;Object(d["j"])(e,(function(i){1===t?(n.posterData=e,n.posterImg=i):2===t&&(n.qrCodeData=e,n.qrCodeImg=i)}))},uploadPics:function(){var e=this,t=[];return this.posterData&&t.push({from:1,data:this.posterData,fileName:"counpon_poster"+Date.now(),showUrl:"posterUrl",maxW:750}),this.qrCodeData&&t.push({from:2,data:this.qrCodeData,fileName:"coupon_wxQrCode"+Date.now(),showUrl:"qrCodeUrl",maxW:300}),Promise.all(t.map((function(t){return e.uploadPic(t)})))},uploadPic:function(e){var t=this,n=this.$store.state.ta,i=new File([e.data],e.fileName,{type:e.data.type});return this.spinning=!0,Object(h["a"])(i,{key:"taqf/club/".concat(n.clubId,"/").concat(e.fileName),maxW:e.maxW,appId:"weClub"}).then((function(n){t[e.showUrl]=n.url})).catch((function(e){})).finally((function(){}))},resetUploadImg:function(e){1===e?(this.posterData=null,this.posterImg=null,this.posterUrl="",this.form.resetFields(["MemberPoster"])):2===e&&(this.qrCodeData=null,this.qrCodeImg=null,this.qrCodeUrl="",this.form.resetFields(["MemberContactWX"]))}}},y=g,w=n("2877"),x=Object(w["a"])(y,m,f,!1,null,null,null),C=x.exports,S={name:"Coupons",components:{STable:l["c"],MemberEdit:p["a"],CouponEdit:C},data:function(){return this.columns=b["a"],this.subColumns=b["b"],{spinning:!1,modalVisible:0,confirmLoading:0,modalData:{},queryParam:{},loadData:this.reqListData,selectedRowKeys:[],selectedRows:[],switchIndex:"",qrSize:256,linkQrCodeImgs:{},qrImg:"blob:http://localhost:8000/0c5161e0-43dc-4716-b71d-13ff8ddeae92",clipboardEnable:!!window.ClipboardItem,allRowKeys:[],expandedRowKeys:[],expandedAll:!1}},filters:{available:function(e){return 1===e}},created:function(){var e=this;this.$root.eventHub.$on("refreshView",(function(){e.$refs.table&&e.$refs.table.refresh()})),this.groupList=[],this.freeGroupList=[],this.allMembers=[],this.memberList=[],this.needUpdateGroup=!1,this.linkQrCodeObjs={}},beforeRouteLeave:function(e,t,n){this.$root.eventHub.$off("refreshView"),n()},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}},tableX:function(){var e=0;return this.columns.forEach((function(t){e+=t.width||t.minWidth||0})),e}},methods:{test:function(){},reqGroupData:function(){var e=this;return c["a"].dispatch("ta/GetGroups",this.needUpdateGroup).then((function(t){e.needUpdateGroup=!1,e.groupList=t.map((function(e){return{value:e.id,label:e.name,isPay:e.isPay}})),e.freeGroupList=e.groupList.filter((function(e){return 0===e.isPay}))})).catch((function(e){}))},reqListData:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.reqGroupData();case 2:return i=Object(r["a"])(Object(r["a"])({},t.queryParam),{},{teamId:91}),n.abrupt("return",u["a"].couponList(i).then((function(n){var i=n.result,a=i.teamCouponInfos;a.forEach((function(e){var t=e.originalPrice,n=e.price,i=e.couponInfos;e.originalPriceStr=(t/100).toFixed(2),e.priceStr=(n/100).toFixed(2);var a=e.originalPriceStr,o=i;o.forEach((function(t){t.teamName=e.teamName;var n=t.price,i=t.residueNum,o=t.useType,r=t.discountValue;t.priceStr=(n/100).toFixed(2),t.cutValue=0,t.payPrice=0,t.discountStr="",o===b["e"].cut.value?(t.cutValue=(r/100).toFixed(2),t.payPrice=a-t.cutValue,t.discountStr=t.cutValue+"元"):o===b["e"].discount.value&&(t.payPrice=(a*r/100).toFixed(2),t.cutValue=a-t.payPrice,t.discountStr=r/10+"折"),t.limitCountStr=Object(d["p"])(i)?i:"-",i===b["i"]&&(t.limitCountStr="无限制")}))})),t.allMembers=a.map((function(e){var t=e.id,n=e.teamName,i=e.originalPrice,a=e.originalPriceStr;return{value:t,label:n,originalPrice:i,originalPriceStr:a}})),t.memberList=a.map((function(e){return e.teamName})),t.allRowKeys=a.filter((function(e){return e.couponInfos&&e.couponInfos.length})).map((function(e){return e.id})),t.expandedRowKeys=t.expandedRowKeys.filter((function(e){return t.allRowKeys.find((function(t){return t===e}))}));var o={totalCount:i.total,pageNo:e.pageNo,data:a};return o})).catch((function(e){})).finally((function(){t.onSelectChange([],[])})));case 4:case"end":return n.stop()}}),n)})))()},handleUpdate:function(e,t,n){var i=this.groupList,a=this.freeGroupList,o=this.memberList,r=this.allMembers;0===e?(this.modalVisible=1,this.modalData={member:t,groupList:i,freeGroupList:a,memberList:o}):(this.modalVisible=2,this.modalData={coupon:n,member:t,allMembers:r})},onUpdateDone:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.needUpdateGroup=e,this.$refs.table.refresh(),this.onUpdateCancel()},onUpdateCancel:function(){this.modalVisible=0},handleDelete:function(e){var t=this;this.$confirm({title:"系统提示",content:"确认删除？",okText:"确认",cancelText:"取消",onOk:function(){t.doDelete(e)},onCancel:function(){}})},doDelete:function(e){var t=this,n=[];if(e)n=[e.id];else{if(!this.selectedRowKeys.length)return;n=this.selectedRowKeys}n=e.id,this.spinning=!0,u["a"].deleteCoupon({ids:n}).then((function(e){t.$refs.table.refresh().then((function(){t.onSelectChange([],[])})),t.$message.info("删除成功")})).catch((function(e){})).finally((function(){t.spinning=!1}))},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},resetQueryParams:function(){this.queryParam={},this.$refs.table.refresh(!0)},onStatusChange:function(e,t,n,i,a){var r=this;this.switchIndex=i;var s=1===t?0:1,c=Object(o["a"])({id:n.id},a,s),l="updateTeamInfo";"isActive"===a&&(this.switchIndex="".concat(n.teamId,"-").concat(i),l="updateCoupon"),u["a"][l](c).then((function(e){n[a]=s})).catch((function(e){})).finally((function(){r.switchIndex=""}))},onShortTxtClick:function(e){var t=this;this.$copyText(e).then((function(e){t.$message.success("复制完毕")})).catch((function(e){t.$message.error("复制失败")}))},onPopoverVisible:function(e,t){var n=this;if(e){var i=t.id,a=t.payIndexUrl,o=this.linkQrCodeObjs[i];o||this.$nextTick((function(){var e=n.$refs["linkQrCode"+i];o=n.linkQrCodeObjs[i]=Object(d["d"])(a,n.qrSize,e,o),setTimeout((function(){var t=e.lastChild.src;n.linkQrCodeImgs[i]=Object(d["b"])(t)}),100)}))}},downloadQR:function(e,t){var n=e.id,i=e.teamName,a=e.name,r=this.linkQrCodeImgs[n],s=r.blob,c=r.url;if(window.ClipboardItem&&t)navigator.clipboard.write([new window.ClipboardItem(Object(o["a"])({},s.type,s))]),this.$message.success("二维码已复制");else{var l=this.$refs["downloadQR"+n];l.download=a?"".concat(i,"-优惠券-").concat(a,".png"):"".concat(i,"-原价.png"),l.href=c}},expandAll:function(){this.expandedAll?(this.expandedAll=!1,this.expandedRowKeys=[]):(this.expandedRowKeys=this.allRowKeys,this.expandedAll=!0)},onExpand:function(e,t){var n=this.expandedRowKeys,i=t.id,a=n.findIndex((function(e){return e===i}));e&&-1===a?n.push(i):!e&&a>=0&&n.splice(a,1),n.length===this.allRowKeys.length?this.expandedAll=!0:this.expandedAll=!1},customExpandIcon:function(e){var t=this.$createElement;return e.record&&e.record.couponInfos&&e.record.couponInfos.length?e.expanded?t("div",{class:"ant-table-row-expand-icon ant-table-row-expanded",on:{click:function(t){e.onExpand(e.record,t)}}}):t("div",{class:"ant-table-row-expand-icon ant-table-row-collapsed",on:{click:function(t){e.onExpand(e.record,t)}}}):""}}},k=S,I=(n("416b"),Object(w["a"])(k,i,a,!1,null,"3fe30532",null));t["default"]=I.exports}}]);
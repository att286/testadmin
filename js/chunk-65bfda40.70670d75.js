(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65bfda40"],{2642:function(e,t,a){},"350d":function(e,t,a){"use strict";a("2642")},"7ef4":function(e,t,a){"use strict";a("86f5")},"7f38":function(e,t,a){},8405:function(e,t,a){},"86f5":function(e,t,a){},"88bc":function(e,t,a){(function(t){var a=1/0,r=9007199254740991,i="[object Arguments]",o="[object Function]",s="[object GeneratorFunction]",n="[object Symbol]",l="object"==typeof t&&t&&t.Object===Object&&t,d="object"==typeof self&&self&&self.Object===Object&&self,u=l||d||Function("return this")();function c(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function m(e,t){var a=-1,r=e?e.length:0,i=Array(r);while(++a<r)i[a]=t(e[a],a,e);return i}function p(e,t){var a=-1,r=t.length,i=e.length;while(++a<r)e[i+a]=t[a];return e}var f=Object.prototype,g=f.hasOwnProperty,h=f.toString,v=u.Symbol,y=f.propertyIsEnumerable,b=v?v.isConcatSpreadable:void 0,w=Math.max;function x(e,t,a,r,i){var o=-1,s=e.length;a||(a=_),i||(i=[]);while(++o<s){var n=e[o];t>0&&a(n)?t>1?x(n,t-1,a,r,i):p(i,n):r||(i[i.length]=n)}return i}function S(e,t){return e=Object(e),C(e,t,(function(t,a){return a in e}))}function C(e,t,a){var r=-1,i=t.length,o={};while(++r<i){var s=t[r],n=e[s];a(n,s)&&(o[s]=n)}return o}function I(e,t){return t=w(void 0===t?e.length-1:t,0),function(){var a=arguments,r=-1,i=w(a.length-t,0),o=Array(i);while(++r<i)o[r]=a[t+r];r=-1;var s=Array(t+1);while(++r<t)s[r]=a[r];return s[t]=o,c(e,this,s)}}function _(e){return V(e)||N(e)||!!(b&&e&&e[b])}function k(e){if("string"==typeof e||$(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function N(e){return T(e)&&g.call(e,"callee")&&(!y.call(e,"callee")||h.call(e)==i)}var V=Array.isArray;function L(e){return null!=e&&F(e.length)&&!D(e)}function T(e){return q(e)&&L(e)}function D(e){var t=P(e)?h.call(e):"";return t==o||t==s}function F(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}function P(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function q(e){return!!e&&"object"==typeof e}function $(e){return"symbol"==typeof e||q(e)&&h.call(e)==n}var U=I((function(e,t){return null==e?{}:S(e,m(x(t,1),k))}));e.exports=U}).call(this,a("c8ba"))},9701:function(e,t,a){"use strict";a("d85a")},b82b:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.showUIMode?"grid"===e.showUIMode?a("grid-list",{attrs:{strategyType:e.supplierType,supplierCode:e.curSupplierCode,supplierName:e.curSupplierName,organizationCode:e.curOrganizationCode},on:{back:function(){e.showUIMode=""}}}):"plan"===e.showUIMode?a("plan",{attrs:{planType:e.supplierType,supplierCode:e.curSupplierCode,supplierName:e.curSupplierName},on:{back:function(){e.showUIMode=""}}}):"report"===e.showUIMode?a("report",{attrs:{reportType:e.supplierType,supplierCode:e.curSupplierCode,supplierName:e.curSupplierName},on:{back:function(){e.showUIMode=""}}}):e._e():a("div",[a("a-spin",{attrs:{spinning:e.spinning}},[a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("新建专区")])],1),a("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",columns:e.columns,data:e.loadData,alert:!1,rowSelection:null,showPagination:"auto"},scopedSlots:e._u([{key:"available",fn:function(t,r,i){return a("span",{},[a("a-switch",{attrs:{loading:i===e.switchIndex,checked:e._f("available")(r)},on:{change:function(a){return e.onStatusChange(a,t,r,i,"state")}}})],1)}},{key:"action",fn:function(t,r){return a("span",{},[[a("a",{staticStyle:{color:"#1890ff"},on:{click:function(t){return e.handleEdit(r)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{staticStyle:{color:"#1890ff"},on:{click:function(t){return e.handleGridManage(r)}}},[e._v("网格管理")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{staticStyle:{color:"#1890ff"},on:{click:function(t){return e.handlePlan(r)}}},[e._v("方案")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{staticStyle:{color:"#1890ff"},on:{click:function(t){return e.handleReport(r)}}},[e._v("报告")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.handleDelete(r)}}},[e._v("删除")])]],2)}}],null,!1,543685792)})],1)],1),a("edit-supplier",{ref:"createModal",attrs:{visible:e.visibleEdit,model:e.modelData,organizationList:e.organizationList,supplierType:e.supplierType,clubId:e.clubId+""},on:{ok:e.onEditOk,cancel:e.onEditCancel}})],1)},i=[],o=a("5530"),s=a("1da1"),n=(a("96cf"),a("a9e3"),a("d3b7"),a("d81d"),a("159b"),a("2af9"));a("a15b"),a("caad");function l(e){var t="-";return 0===e?t="进行中":1===e?t="已下架":2===e&&(t="已休眠"),t}var d=[{title:"顺序编号",dataIndex:"supplierSort"},{title:"专区名称",dataIndex:"supplierName"},{title:"网格数",dataIndex:"strategyNum"},{title:"预期收益率",dataIndex:"expectYield",customRender:function(e){return e?"".concat(e,"%"):"-"}},{title:"最大回撤",dataIndex:"maxDrawdown",customRender:function(e){return e?"".concat(e,"%"):"-"}},{title:"上架状态",dataIndex:"state",scopedSlots:{customRender:"available"}},{title:"操作",width:380,scopedSlots:{customRender:"action"}}],u=[{title:"网格名称",dataIndex:"name"},{title:"所属专区",dataIndex:"supplierName"},{title:"策略标的",dataIndex:"code",scopedSlots:{customRender:"stock"}},{title:"网格状态",dataIndex:"state",customRender:l},{title:"更新说明",width:180,dataIndex:"updateDesc"},{title:"列表显示",scopedSlots:{customRender:"available2"}},{title:"上架状态",scopedSlots:{customRender:"available"}},{title:"操作",width:140,scopedSlots:{customRender:"action"}}],c=[{title:"方案名称",dataIndex:"planName"},{title:"排序值",dataIndex:"planSort"},{title:"网格名称",dataIndex:"strategyList",customRender:function(e){return e.map((function(e){return e.strategyName})).join(", ")}},{title:"上架状态",dataIndex:"state",scopedSlots:{customRender:"available"}},{title:"操作",width:140,scopedSlots:{customRender:"action"}}],m=[{title:"报告名称",dataIndex:"reportName"},{title:"创建时间",dataIndex:"reportUpdateTime"},{title:"操作",width:140,scopedSlots:{customRender:"action"}}],p=[{label:"即时卖五价",value:"15"},{label:"即时卖四价",value:"14"},{label:"即时卖三价",value:"13"},{label:"即时卖二价",value:"12"},{label:"即时卖一价",value:"11"},{label:"即时买一价",value:"1"},{label:"即时买二价",value:"2"},{label:"即时买三价",value:"3"},{label:"即时买四价",value:"4"},{label:"即时买五价",value:"5"}],f={StrategyDelete:{title:"您当前选择下架，是否推送通知用户？",descTitle:"下架说明"},StrategyUpdate:{title:"您已修改策略参数，是否推送通知用户？",descTitle:"更新说明"}},g={1:"基金",2:"股票",3:"债券"},h=[{label:"星期一",value:1},{label:"星期二",value:2},{label:"星期三",value:3},{label:"星期四",value:4},{label:"星期五",value:5}],v=[{label:"单周",value:1,labelFx:"每周"},{label:"双周",value:2,labelFx:"每两周"},{label:"月度",value:3,labelFx:"每月"}];function y(e){var t=["HBZQ"];return t.includes(e)}var b=a("0970"),w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"编辑专区",width:600,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"},destroyOnClose:!0},on:{ok:e.onOk,cancel:function(){e.$emit("cancel")}}},[a("a-spin",{attrs:{spinning:e.loading}},[a("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[a("a-form-item",{attrs:{label:"归属券商"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["organizationCode",{initialValue:e.model.organizationCode,rules:[{required:!0,message:"必选"}]}],expression:"['organizationCode', { initialValue: model.organizationCode, rules: [{ required: true, message: '必选' }] }]"}],attrs:{"allow-clear":"",labelInValue:!1,options:e.organizationList,showSearch:"",optionFilterProp:"children",placeholder:"无"},on:{change:e.changeOrganization}})],1),a("a-form-item",{attrs:{label:"专区名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["supplierName",{initialValue:e.model.supplierName,rules:[{required:!0,message:"必填"}]}],expression:"['supplierName', { initialValue: model.supplierName, rules: [{ required: true, message: '必填' }] }]"}],attrs:{name:"supplierName","max-length":8,placeholder:"最多8个字","allow-clear":""}})],1),a("a-form-item",{attrs:{label:"预期收益率"}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:14}},[a("a-form-item",[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["expectYield",{initialValue:e.model.expectYield,rules:[{required:!1,message:"必填"}]}],expression:"['expectYield', { initialValue: model.expectYield, rules: [{ required: false, message: '必填' }] }]"}],staticStyle:{width:"180px"},attrs:{name:"expectYield","allow-clear":"",max:9999,min:-9999},on:{focus:e.onExpectYieldFouce}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v("%")])],1)],1),1==e.supplierType?a("a-col",{attrs:{span:10}},[a("a-form-item",[a("a-checkbox",{directives:[{name:"decorator",rawName:"v-decorator",value:["expectYieldInfinity",{valuePropName:"checked",initialValue:1===e.model.expectYieldInfinity,rules:[{required:!1,message:"必填"}]}],expression:"['expectYieldInfinity', { valuePropName:'checked', initialValue: model.expectYieldInfinity===1, rules: [{ required: false, message: '必填' }] }]"}],attrs:{name:"expectYieldInfinity"},on:{change:e.onExpectYieldInfinityChange}},[e._v("∞（成本为负数）")])],1)],1):e._e()],1)],1),a("a-form-item",{attrs:{label:"最大回撤"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["maxDrawdown",{initialValue:e.model.maxDrawdown,rules:[{required:!1,message:"必填"}]}],expression:"['maxDrawdown', { initialValue: model.maxDrawdown, rules: [{ required: false, message: '必填' }] }]"}],staticStyle:{width:"180px"},attrs:{name:"maxDrawdown",max:9999,min:-9999,"allow-clear":""}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v("%")])],1),a("a-form-item",{attrs:{label:"专区宣传语",extra:"位于专区列表中，简单总结专区特色"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["supplierIntro",{initialValue:e.model.supplierIntro,rules:[{required:!0,message:"必填"}]}],expression:"['supplierIntro', { initialValue: model.supplierIntro, rules: [{ required: true, message: '必填' }] }]"}],attrs:{name:"supplierIntro","max-length":15,placeholder:"请输入，最多15个字","allow-clear":""}})],1),a("a-form-item",{attrs:{label:"专区简介",extra:"位于策略列表中，用于介绍该专区的特色"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["supplierDesc",{initialValue:e.model.supplierDesc,rules:[{required:!1,message:"必填"}]}],expression:"['supplierDesc', { initialValue: model.supplierDesc, rules: [{ required: false, message: '必填' }] }]"}],attrs:{name:"supplierDesc","max-length":500,placeholder:"请输入","allow-clear":""}})],1),a("a-form-item",{attrs:{label:"专区logo"}},[a("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["supplierLogo",{initialValue:e.model.supplierLogo,rules:[{required:!0,message:"必传"}]}],expression:"['supplierLogo', { initialValue: model.supplierLogo, rules: [{ required: true, message: '必传' }] }]"}],staticClass:"logoUploader",attrs:{name:"supplierLogo",accept:".png,.jpg,.jpeg","list-type":"picture-card","show-upload-list":!1,"before-upload":e.beforeUpload}},[e.logoUrl?a("img",{staticClass:"logoImg",attrs:{src:e.logoUrl,alt:"logo"}}):a("div",[a("a-icon",{attrs:{type:e.logoLoading?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[e._v(" 上传 ")])],1)])],1),a("a-form-item",{attrs:{label:"是否上架"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["state",{initialValue:e.model.state||0,rules:[{required:!0,message:"必选"}]}],expression:"['state', { initialValue: model.state || 0, rules: [{ required: true, message: '必选' }] }]"}]},[a("a-radio",{attrs:{value:0}},[e._v("是")]),a("a-radio",{attrs:{value:1}},[e._v("否")])],1)],1),a("a-form-item",{attrs:{label:"排序编号"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["supplierSort",{initialValue:e.model.supplierSort,rules:[{required:!0,message:"必填"}]}],expression:"['supplierSort', { initialValue: model.supplierSort, rules: [{ required: true, message: '必填' }] }]"}],attrs:{name:"supplierSort","allow-clear":""}})],1)],1)],1)],1)},x=[],S=(a("99af"),a("b0c0"),a("7db0"),a("88bc")),C=a.n(S),I=a("7858"),_=["supplierCode","supplierName","supplierIntro","supplierDesc","expectYield","expectYieldInfinity","maxDrawdown","supplierSort","state","supplierLogo"],k={components:{},props:{visible:{type:Boolean,required:!0},model:{type:Object,default:function(){}},organizationList:{type:Array,default:function(){return[]}},supplierType:{type:Number,default:function(){return[]}},clubId:{type:String,default:""}},data:function(){return this.formLayout={labelCol:{md:{span:6},xs:{span:24}},wrapperCol:{md:{span:18},xs:{span:24}}},this.formLayout2={labelCol:{md:{span:6},xs:{span:24}},wrapperCol:{md:{span:8},xs:{span:24}}},{loading:!1,form:this.$form.createForm(this),logoLoading:!1,logoUrl:""}},computed:{},created:function(){var e=this;_.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("model",(function(){e.$nextTick((function(){var t;1===(null===(t=e.model)||void 0===t?void 0:t.expectYieldInfinity)?e.model.expectYieldInfinity=!0:e.model.expectYieldInfinity=!1,e.model&&e.form.setFieldsValue(C()(e.model,_)),e.logoUrl=e.form.getFieldValue("supplierLogo")}))}))},mounted:function(){},methods:{beforeUpload:function(e){var t=this,a="image/jpeg"===e.type||"image/png"===e.type;if(!a)return this.$message.error("图片格式错误!"),!1;var r=e.size/1024/1024<2;if(!r)return this.$message.error("上传图片不能超过2MB!"),!1;var i=this.$store.state.user,o="supplier_".concat(Date.now(),"@").concat(e.name);this.logoLoading=!0,Object(I["a"])(e,{key:"taetf/".concat(i.userId,"/").concat(o),appId:"weClub"}).then((function(e){t.logoUrl=e.url,t.form.setFieldsValue({supplierLogo:e.url})})).catch((function(e){})).finally((function(){t.logoLoading=!1}))},changeOrganization:function(e){if(e){var t=this.organizationList.find((function(t){return t.value===e}));t&&this.form.setFieldsValue({supplierName:t.label})}},onOk:function(){var e=this,t=this.form;this.loading=!0,t.validateFields((function(t,a){if(t)e.loading=!1;else{var r=e.model.id,i=r?"updateSupplier":"createSupplier",s=Object(o["a"])(Object(o["a"])({},a),{},{supplierType:e.supplierType,supplierId:r});s.expectYieldInfinity?s.expectYieldInfinity=1:s.expectYieldInfinity=0,"createSupplier"===i&&(s.serviceId="TA",s.businessId=e.clubId),e.doUpdate(i,s)}}))},doUpdate:function(e,t){var a=this;b["a"][e](t).then((function(e){a.loading=!1,a.$message.info("操作成功"),a.$emit("ok")})).catch((function(e){a.loading=!1,a.$message.error(e.responseMsg)}))},onExpectYieldInfinityChange:function(e){e.target.checked&&this.form&&this.form.setFieldsValue({expectYield:""})},onExpectYieldFouce:function(e){this.form&&this.form.setFieldsValue({expectYieldInfinity:!1})}}},N=k,V=(a("cec0"),a("2877")),L=Object(V["a"])(N,w,x,!1,null,"5f19e880",null),T=L.exports,D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-spin",{attrs:{spinning:e.spinning}},[a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"所属专区"}},[a("p",[e._v(e._s(e.supplierName))])])],1)],1)],1)],1),a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"rollback"},on:{click:function(){e.$emit("back")}}},[e._v("返回专区")]),a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("新建网格")])],1),a("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",columns:e.columns,data:e.loadData,alert:!1,rowSelection:null,showPagination:"auto"},scopedSlots:e._u([{key:"stock",fn:function(t){return a("span",{},[[a("span",[e._v(e._s(e.stackName(t)))])]],2)}},{key:"view",fn:function(t,r){return a("span",{},[[r.updateDesc?a("a",{on:{click:function(t){return e.showUpdateDesc(r)}}},[e._v("查看")]):e._e()]],2)}},{key:"available",fn:function(t,r,i,o){return a("span",{},[a("a-switch",{attrs:{loading:i===e.switchIndex,checked:e._f("available")(r)},on:{change:function(a){return e.onStatusChange(a,t,r,i,o.dataIndex)}}})],1)}},{key:"available2",fn:function(t,r,i,o){return a("span",{},[a("a-switch",{attrs:{loading:i===e.switchIndex,checked:e._f("available2")(r)},on:{change:function(a){return e.onStatusChange2(a,t,r,i,o.dataIndex)}}})],1)}},{key:"action",fn:function(t,r){return a("span",{},[[a("a",{staticStyle:{color:"#1890ff"},on:{click:function(t){return e.handleUpdate(r)}}},[e._v("修改")])]],2)}}])})],1)],1),a("update-confirm",{attrs:{visible:e.showConfirm,from:"StrategyDelete"},on:{cancel:function(){return e.showConfirm=!1},ok:e.confirmOk}}),e.showModel?a("edit-strategy",{ref:"createModal",attrs:{visible:e.modalVisible,loading:e.confirmLoading,model:e.modalData,etfList:e.etfList,strategyType:this.strategyType,organizationCode:e.organizationCode},on:{cancel:e.handleCancel,ok:e.handleOk}}):e._e()],1)},F=[],P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"编辑",width:960,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"},destroyOnClose:!0},on:{ok:e.onOk,cancel:function(){e.$emit("cancel")}}},[a("a-spin",{attrs:{spinning:e.loading}},[a("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:11}},[a("h3",[e._v("网格设置")]),a("a-form-item",{staticClass:"formItem",attrs:{label:"网格名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{initialValue:e.model.name,rules:[{required:!0,message:"必填"}]}],expression:"['name', { initialValue: model.name, rules: [{ required: true, message: '必填' }] }]"}],attrs:{name:"name","allow-clear":"",placeholder:"请输入网格名称"}})],1),a("a-form-item",{staticClass:"formItem",attrs:{label:"标的代码"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["code",{initialValue:e.model.code,rules:[{required:!0,message:"必选"}]}],expression:"['code', { initialValue: model.code, rules: [{ required: true, message: '必选' }] }]"}],attrs:{"show-search":"",placeholder:"请选择",optionFilterProp:"children"},on:{change:e.handleStockChange}},e._l(e.etfList,(function(t){return a("a-select-option",{key:t.stockCode,attrs:{value:t.stockCode}},[e._v(e._s(t.stockName+"("+t.stockCode+")")+" ")])})),1)],1),a("a-form-item",{staticClass:"formItem",attrs:{label:"网格简介"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["strategyDesc",{initialValue:e.model.strategyDesc,rules:[{required:!0,message:"必填"}]}],expression:"['strategyDesc', { initialValue: model.strategyDesc, rules: [{ required: true, message: '必填' }] }]"}],attrs:{name:"strategyDesc","allow-clear":"",placeholder:"请输入网格简介，最多300字",autoSize:{minRows:2,maxRows:5},maxLength:300}})],1),e.isHK?a("a-form-item",{staticClass:"formItem",attrs:{label:"底仓金额"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["baseAmount",{initialValue:e.model.baseAmount,rules:[{required:!0,message:"必填"}]}],expression:"['baseAmount', { initialValue: model.baseAmount, rules: [{ required: true, message: '必填' }] }]"}],staticStyle:{width:"120px"},attrs:{name:"baseAmount",min:0,step:100,precision:2,placeholder:"请输入金额"}})],1):e._e(),a("a-form-item",{staticClass:"formItem",attrs:{label:"预估总金额",help:"预估当前网格总的资金占有量，不填写时小程序不展示。"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["totalAmount",{initialValue:e.model.totalAmount,rules:[{required:!1,message:"必填"}]}],expression:"['totalAmount', { initialValue: model.totalAmount, rules: [{ required: false, message: '必填' }] }]"}],staticStyle:{width:"120px"},attrs:{name:"totalAmount",min:0,step:100,precision:2,placeholder:"请输入金额"}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v("元")])],1),e.isA?a("a-form-item",{staticClass:"formItem",attrs:{label:"预估总格数",help:"预估当前网格总格数，不填写时小程序不展示。"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["totalGridSize",{initialValue:e.model.totalGridSize,rules:[{required:!1,message:"必填"}]}],expression:"['totalGridSize', { initialValue: model.totalGridSize, rules: [{ required: false, message: '必填' }] }]"}],staticStyle:{width:"120px"},attrs:{name:"totalGridSize",min:0,step:100,precision:0,placeholder:"请输入格数"}})],1):e._e(),e.isHK?a("h3",[e._v("底仓策略")]):e._e(),e.isHK?a("a-form-item",{staticClass:"formItem",attrs:{label:"底仓策略"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["baseDesc",{initialValue:e.model.baseDesc,rules:[{required:!0,message:"必填"}]}],expression:"['baseDesc', { initialValue: model.baseDesc, rules: [{ required: true, message: '必填' }] }]"}],attrs:{name:"baseDesc","allow-clear":"",placeholder:"请输入仓底策略",autoSize:{minRows:4,maxRows:6},maxLength:500}})],1):e._e(),e.isA?a("h3",[e._v("定投设置")]):e._e(),e.isA?a("a-form-item",{staticClass:"formItem",attrs:{label:"小程序显示"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["showFixed",{initialValue:e.model.showFixed||0,rules:[{required:!0,message:"必选"}]}],expression:"['showFixed', { initialValue: model.showFixed || 0, rules: [{ required: true, message: '必选' }] }]"}]},[a("a-radio",{attrs:{value:0}},[e._v("显示")]),a("a-radio",{attrs:{value:1}},[e._v("不显示")])],1)],1):e._e(),e.isA&&1!=e.form.getFieldValue("showFixed")?a("a-form-item",{staticClass:"formItem",attrs:{label:"是否继续定投"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["fixedState",{initialValue:e.model.fixedState||0,rules:[{required:!0,message:"必选"}]}],expression:"['fixedState', { initialValue: model.fixedState || 0, rules: [{ required: true, message: '必选' }] }]"}]},[a("a-radio",{attrs:{value:0}},[e._v("是")]),a("a-radio",{attrs:{value:1}},[e._v("否")])],1)],1):e._e(),e.isA&&1!=e.form.getFieldValue("showFixed")?a("a-form-item",{staticClass:"formItem",attrs:{label:"默认定投周期"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["defaultFixed",{initialValue:e.model.defaultFixed||1,rules:[{required:!0,message:"必选"}]}],expression:"['defaultFixed', { initialValue: model.defaultFixed || 1, rules: [{ required: true, message: '必选' }] }]"}],on:{change:e.onDefaultFixedChange}},e._l(e.fixedOptions,(function(t){return a("a-radio",{key:t.label+t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1):e._e(),e.isA&&1!=e.form.getFieldValue("showFixed")?a("a-form-item",e._b({staticClass:"formItem",attrs:{label:e.fixedLabel(e.form.getFieldValue("defaultFixed"))}},"a-form-item",e.formLayout2,!1),[3!=e.form.getFieldValue("defaultFixed")?a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["fixedDay",{initialValue:e.model.fixedDay?e.model.fixedDay+"":"1",rules:[{required:!0,message:"必选"}]}],expression:"['fixedDay', { initialValue: model.fixedDay?model.fixedDay+'':'1', rules: [{ required: true, message: '必选' }] }]"}]},e._l(e.daysInWeek,(function(t){return a("a-select-option",{key:t.value,attrs:{value:""+t.value,placeholder:"请选择"}},[e._v(e._s(t.label)+" ")])})),1):a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["fixedDay",{initialValue:e.model.fixedDay?e.model.fixedDay+"":"1",rules:[{required:!0,message:"必选"}]}],expression:"['fixedDay', { initialValue: model.fixedDay?model.fixedDay+'':'1', rules: [{ required: true, message: '必选' }] }]"}],attrs:{valueFormat:"D",format:"D日",inputReadOnly:"",allowClear:!1,disabledDate:e.disabledFixedDate}})],1):e._e(),e.isA&&1!=e.form.getFieldValue("showFixed")?a("a-form-item",{staticClass:"formItem",attrs:{label:"定投策略"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["fixedDesc",{initialValue:e.model.fixedDesc,rules:[{required:!1,message:"必填"}]}],expression:"['fixedDesc', { initialValue: model.fixedDesc, rules: [{ required: false, message: '必填' }] }]"}],attrs:{name:"fixedDesc","allow-clear":"","max-length":20,placeholder:"请输入定投策略"}})],1):e._e(),a("h3",[e._v("回测设置")]),e.isA?a("a-form-item",{staticClass:"formItem",attrs:{label:"小程序显示"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["showBackTest",{initialValue:void 0==e.model.showBackTest?0:e.model.showBackTest,rules:[{required:!0,message:"必选"}]}],expression:"['showBackTest', { initialValue: model.showBackTest==undefined?0:model.showBackTest, rules: [{ required: true, message: '必选' }] }]"}]},[a("a-radio",{attrs:{value:0}},[e._v("显示")]),a("a-radio",{attrs:{value:1}},[e._v("不显示")])],1)],1):e._e(),1!=e.form.getFieldValue("showBackTest")?a("div",[e._l(e.backTestList,(function(t,r){return a("test-data",{key:r,ref:"testData"+r,refInFor:!0,attrs:{showDelete:!0,showAdd:r==e.backTestList.length-1,info:t,title:"回测"+(r+1),stockKind:e.stockKind},on:{delete:function(t){return e.handleRemove(r)},add:e.handleAdd}})})),0==e.backTestList.length?a("a-button",{staticStyle:{height:"24px"},attrs:{block:"",type:"link"},on:{click:e.handleAdd}},[a("a-icon",{attrs:{type:"plus"}}),e._v("添加新的回测用例")],1):e._e()],2):a("div",[a("a-form-item",{staticClass:"formItem",attrs:{label:"网格收益率"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["strategyProfit",{initialValue:e.model.strategyProfit,rules:[{required:!e.form.getFieldValue("strategyProfitInfinity"),message:"必填"}]}],expression:"['strategyProfit', { initialValue: model.strategyProfit, rules: [{ required: !form.getFieldValue('strategyProfitInfinity'), message: '必填' }] }]"}],staticStyle:{width:"120px"},attrs:{precision:2,max:9999,min:-9999},on:{focus:e.onStrategyProfitFouce}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v("%")])],1),a("a-form-item",{staticClass:"formItem",attrs:{label:" ",colon:!1}},[a("a-checkbox",{directives:[{name:"decorator",rawName:"v-decorator",value:["strategyProfitInfinity",{valuePropName:"checked",initialValue:1===e.model.strategyProfitInfinity,rules:[{required:!1,message:"必填"}]}],expression:"['strategyProfitInfinity', { valuePropName:'checked', initialValue: model.strategyProfitInfinity===1, rules: [{ required: false, message: '必填' }] }]"}],attrs:{name:"strategyProfitInfinity"},on:{change:e.onStrategyProfitInfinityChange}},[e._v("∞（成本为负数）")])],1),a("a-form-item",{staticClass:"formItem",attrs:{label:e.stockKindName+"收益率"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["fundProfit",{initialValue:e.model.fundProfit,rules:[{required:!0,message:"必填"}]}],expression:"['fundProfit', { initialValue: model.fundProfit, rules: [{ required: true, message: '必填' }] }]"}],staticStyle:{width:"120px"},attrs:{precision:2,max:9999,min:-9999}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v("%")])],1)],1),e.isXM?a("div",[a("h3",[e._v("网格计划表")]),a("a-form-item",{staticClass:"formItem",attrs:{label:"小程序显示"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["showPlanForm",{initialValue:void 0==e.model.showPlanForm?1:e.model.showPlanForm,rules:[{required:!0,message:"必选"}]}],expression:"['showPlanForm', { initialValue: model.showPlanForm==undefined?1:model.showPlanForm, rules: [{ required: true, message: '必选' }] }]"}]},[a("a-radio",{attrs:{value:0}},[e._v("显示")]),a("a-radio",{attrs:{value:1}},[e._v("不显示")])],1)],1),0==e.form.getFieldValue("showPlanForm")?a("div",[a("uploader",{attrs:{visible:e.visible,form:e.form,label:"网格计划图",exId:"planFormImg",listType:"picture-card",accept:".png, .jpg, .jpeg",comCSS:{width:"120px",height:"100px"},imgCSS:{width:"100px",height:"100px"},btnCSS:{width:"100px",height:"100px"},maxCount:1,fileType:"image",required:!0,"url-list":e.planFormImgUrls,exName:"banner",exTip:"",tipMode:1},on:{uploadEvent:e.onUploadEvent}})],1):e._e(),a("h3",[e._v("交易记录表")]),a("a-form-item",{staticClass:"formItem",attrs:{label:"小程序显示"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["showTradingRecord",{initialValue:void 0==e.model.showTradingRecord?1:e.model.showTradingRecord,rules:[{required:!0,message:"必选"}]}],expression:"['showTradingRecord', { initialValue: model.showTradingRecord==undefined?1:model.showTradingRecord, rules: [{ required: true, message: '必选' }] }]"}]},[a("a-radio",{attrs:{value:0}},[e._v("显示")]),a("a-radio",{attrs:{value:1}},[e._v("不显示")])],1)],1),0==e.form.getFieldValue("showTradingRecord")?a("div",[a("uploader",{attrs:{visible:e.visible,form:e.form,label:"交易记录图",exId:"tradingRecordFormImg",listType:"picture-card",accept:".png, .jpg, .jpeg",comCSS:{width:"120px",height:"100px"},imgCSS:{width:"100px",height:"100px"},btnCSS:{width:"100px",height:"100px"},maxCount:1,fileType:"image",required:!0,"url-list":e.tradingRecordFormImgUrls,exName:"banner",exTip:"",tipMode:1},on:{uploadEvent:e.onUploadEvent}})],1):e._e(),a("h3",[e._v("交易委托参数二维码")]),a("uploader",{attrs:{visible:e.visible,form:e.form,label:"二维码",exId:"entrustParamImg",listType:"picture-card",accept:".png, .jpg, .jpeg",comCSS:{width:"120px",height:"100px"},imgCSS:{width:"100px",height:"100px"},btnCSS:{width:"100px",height:"100px"},maxCount:1,fileType:"image",required:!1,"url-list":e.entrustParamImgUrls,exName:"banner",exTip:"",tipMode:1},on:{uploadEvent:e.onUploadEvent}})],1):e._e()],1),a("a-col",{attrs:{span:1}}),a("a-col",{attrs:{span:11}},[a("h3",[e._v("触发设置")]),a("a-form-item",{staticClass:"formItem",attrs:{label:"基准价"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["startPrice",{initialValue:e.model.startPrice,rules:[{required:!0,message:"必填"}]}],expression:"['startPrice', { initialValue: model.startPrice, rules: [{ required: true, message: '必填' }] }]"}],staticStyle:{width:"120px"},attrs:{name:"startPrice","allow-clear":"",placeholder:"请输入"}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v("元")])],1),a("a-form-item",{staticClass:"formItem",attrs:{label:"网格类型"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["gridType",{initialValue:e.model.gridType||1,rules:[{required:!0,message:"必填"}]}],expression:"['gridType', { initialValue: model.gridType || 1, rules: [{ required: true, message: '必填' }] }]"}]},[a("a-radio",{attrs:{value:1}},[e._v("按比例")]),a("a-radio",{attrs:{value:2}},[e._v("按价差")])],1)],1),a("a-form-item",{staticClass:"formItem",attrs:{label:"波动类型"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["waveType",{initialValue:e.model.waveType||1,rules:[{required:!0,message:"必填"}]}],expression:"['waveType', { initialValue: model.waveType || 1, rules: [{ required: true, message: '必填' }] }]"}]},[a("a-radio",{attrs:{value:1}},[e._v("上涨下跌相同")]),a("a-radio",{attrs:{value:2}},[e._v("上涨下跌不同")])],1)],1),1==e.form.getFieldValue("waveType")?a("a-form-item",e._b({staticClass:"formItem",attrs:{label:"每上涨或下跌"}},"a-form-item",e.formLayout2,!1),[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["gridUpSize",{initialValue:e.model.gridUpSize,rules:[{required:!0,message:"必填"}]}],expression:"['gridUpSize', { initialValue: model.gridUpSize, rules: [{ required: true, message: '必填' }] }]"}],staticStyle:{width:"120px"},attrs:{name:"gridUpSize",min:.001,max:9999,step:1,precision:3,placeholder:1==e.form.getFieldValue("gridType")?"输入百分比":"输入价格"}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v(e._s(1==e.form.getFieldValue("gridType")?"%":"元"))]),a("span",{staticStyle:{"margin-left":"0px"}},[e._v("触发交易")])],1):e._e(),2==e.form.getFieldValue("waveType")?a("div",[a("a-form-item",e._b({staticClass:"formItem",attrs:{label:"上涨"}},"a-form-item",e.formLayout2,!1),[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["gridUpSize",{initialValue:e.model.gridUpSize,rules:[{required:!0,message:"必填"}]}],expression:"['gridUpSize', { initialValue: model.gridUpSize, rules: [{ required: true, message: '必填' }] }]"}],staticStyle:{width:"120px"},attrs:{name:"gridUpSize",min:.001,max:9999,step:1,precision:3,placeholder:1==e.form.getFieldValue("gridType")?"输入百分比":"输入价格"}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v(e._s(1==e.form.getFieldValue("gridType")?"%":"元"))]),a("span",{staticStyle:{"margin-left":"0px"}},[e._v("触发卖出")])],1),a("a-form-item",e._b({staticClass:"formItem",attrs:{label:"下跌"}},"a-form-item",e.formLayout2,!1),[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["gridDownSize",{initialValue:e.model.gridDownSize,rules:[{required:!0,message:"必填"}]}],expression:"['gridDownSize', { initialValue: model.gridDownSize, rules: [{ required: true, message: '必填' }] }]"}],staticStyle:{width:"120px"},attrs:{name:"gridDownSize",min:.001,max:9999,step:1,precision:3,placeholder:1==e.form.getFieldValue("gridType")?"输入百分比":"输入价格"}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v(e._s(1==e.form.getFieldValue("gridType")?"%":"元"))]),a("span",{staticStyle:{"margin-left":"0px"}},[e._v("触发买入")])],1)],1):e._e(),e.isXM?a("a-form-item",{staticClass:"formItem",attrs:{label:"回落卖出",help:"该项为空时，小程序端不显示。"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["pullbackSale",{initialValue:e.model.pullbackSale,rules:[{required:!1,message:"必填"}]}],expression:"['pullbackSale', { initialValue: model.pullbackSale, rules: [{ required: false, message: '必填' }] }]"}],staticStyle:{width:"120px"},attrs:{name:"pullbackSale",min:.001,max:9999,step:1,precision:3,placeholder:1==e.form.getFieldValue("gridType")?"输入百分比":"输入价格"}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v(e._s(1==e.form.getFieldValue("gridType")?"%":"元"))])],1):e._e(),e.isXM?a("a-form-item",{staticClass:"formItem",attrs:{label:"拐点买入",help:"该项为空时，小程序端不显示。"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["spinodalBuy",{initialValue:e.model.spinodalBuy,rules:[{required:!1,message:"必填"}]}],expression:"['spinodalBuy', { initialValue: model.spinodalBuy, rules: [{ required: false, message: '必填' }] }]"}],staticStyle:{width:"120px"},attrs:{name:"spinodalBuy",min:.001,max:9999,step:1,precision:3,placeholder:1==e.form.getFieldValue("gridType")?"输入百分比":"输入价格"}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v(e._s(1==e.form.getFieldValue("gridType")?"%":"元"))])],1):e._e(),a("h3",[e._v("委托设置")]),a("a-form-item",{staticClass:"formItem",attrs:{label:"委托价格"}}),a("a-form-item",e._b({staticClass:"formItem",attrs:{label:"限价买入"}},"a-form-item",e.formLayout2,!1),[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["buyPrice",{initialValue:e.model.buyPrice||"11",rules:[{required:!0,message:"必选"}]}],expression:"['buyPrice', { initialValue: model.buyPrice || '11', rules: [{ required: true, message: '必选' }] }]"}]},e._l(e.priceList,(function(t){return a("a-select-option",{key:t.label+"1",attrs:{value:t.value,placeholder:"请选择"}},[e._v(e._s(t.label)+" ")])})),1)],1),a("a-form-item",e._b({staticClass:"formItem",attrs:{label:"限价卖出"}},"a-form-item",e.formLayout2,!1),[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["sellPrice",{initialValue:e.model.sellPrice||"1",rules:[{required:!0,message:"必选"}]}],expression:"['sellPrice', { initialValue: model.sellPrice || '1', rules: [{ required: true, message: '必选' }] }]"}]},e._l(e.priceList,(function(t){return a("a-select-option",{key:t.label+"2",attrs:{value:t.value,placeholder:"请选择"}},[e._v(e._s(t.label)+" ")])})),1)],1),a("a-form-item",{staticClass:"formItem",attrs:{label:"委托类型"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["tradeType",{initialValue:e.model.tradeType||1,rules:[{required:!0,message:"必选"}]}],expression:"['tradeType', { initialValue: model.tradeType || 1, rules: [{ required: true, message: '必选' }] }]"}]},[a("a-radio",{attrs:{value:1}},[e._v("买卖等量")]),a("a-radio",{attrs:{value:2}},[e._v("买卖不等")])],1)],1),e.isA?a("a-form-item",{staticClass:"formItem",attrs:{label:"委托方式"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["tradeWay",{initialValue:e.model.tradeWay||0,rules:[{required:!0,message:"必选"}]}],expression:"['tradeWay', { initialValue: model.tradeWay || 0, rules: [{ required: true, message: '必选' }] }]"}]},[a("a-radio",{attrs:{value:0}},[e._v("按股数委托")]),a("a-radio",{attrs:{value:1}},[e._v("按金额委托")])],1)],1):e._e(),1==e.form.getFieldValue("tradeType")?a("a-form-item",e._b({staticClass:"formItem",attrs:{label:"无论买卖都委托"}},"a-form-item",e.formLayout2,!1),[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["gridUpNum",{initialValue:e.model.gridUpNum,rules:[{required:!0,message:"必填"}]}],expression:"['gridUpNum', { initialValue: model.gridUpNum, rules: [{ required: true, message: '必填' }] }]"}],staticStyle:{width:"120px"},attrs:{name:"gridUpNum",min:1,step:100,precision:0,placeholder:1==e.form.getFieldValue("tradeWay")?"请输入金额":"请输入股票数量"}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v(e._s(1==e.form.getFieldValue("tradeWay")?"元":"股"))])],1):e._e(),2==e.form.getFieldValue("tradeType")?a("a-form-item",e._b({staticClass:"formItem",attrs:{label:"买入委托"}},"a-form-item",e.formLayout2,!1),[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["gridDownNum",{initialValue:e.model.gridDownNum,rules:[{required:!0,message:"必填"}]}],expression:"['gridDownNum', { initialValue: model.gridDownNum, rules: [{ required: true, message: '必填' }] }]"}],staticStyle:{width:"120px"},attrs:{name:"gridDownNum",min:1,step:100,precision:0,placeholder:1==e.form.getFieldValue("tradeWay")?"请输入金额":"请输入股票数量"}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v(e._s(1==e.form.getFieldValue("tradeWay")?"元":"股"))])],1):e._e(),2==e.form.getFieldValue("tradeType")?a("a-form-item",e._b({staticClass:"formItem",attrs:{label:"卖出委托"}},"a-form-item",e.formLayout2,!1),[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["gridUpNum",{initialValue:e.model.gridUpNum,rules:[{required:!0,message:"必填"}]}],expression:"['gridUpNum', { initialValue: model.gridUpNum, rules: [{ required: true, message: '必填' }] }]"}],staticStyle:{width:"120px"},attrs:{name:"gridUpNum",min:1,step:100,precision:0,placeholder:1==e.form.getFieldValue("tradeWay")?"请输入金额":"请输入股票数量"}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v(e._s(1==e.form.getFieldValue("tradeWay")?"元":"股"))])],1):e._e(),a("a-form-item",{staticClass:"formItem",attrs:{label:"净买入卖出量控制"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["tradeNumControl",{initialValue:e.model.tradeNumControl,rules:[{required:!0,message:"必填"}]}],expression:"['tradeNumControl', { initialValue: model.tradeNumControl, rules: [{ required: true, message: '必填' }] }]"}]},[a("a-radio",{attrs:{value:1}},[e._v("无需开启")]),a("a-radio",{attrs:{value:0}},[e._v("根据资金量自行设置")])],1)],1),a("a-form-item",{staticClass:"formItem",attrs:{label:"监控周期",required:""}},[e.isA?a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:10}},[a("a-form-item",[a("a-checkbox",{attrs:{name:"periodForever"},model:{value:e.periodForever,callback:function(t){e.periodForever=t},expression:"periodForever"}},[e._v("长期有效")])],1)],1),a("a-col",{attrs:{span:14}},[e.periodForever?e._e():a("a-form-item",[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["period",{initialValue:e.model.period,rules:[{required:!0,message:"必填"}]}],expression:"['period', { initialValue: model.period, rules: [{ required: true, message: '必填' }] }]"}],staticStyle:{width:"120px"},attrs:{name:"period",min:1,max:e.isA?180:120,step:1,precision:0,placeholder:e.isA?"最大180天":"最大120天"}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v("天")])],1)],1)],1):e._e()],1),a("a-form-item",{staticClass:"formItem",attrs:{label:"网格范围",required:""}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:10}},[a("a-form-item",[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["lowerLimit",{initialValue:e.model.lowerLimit,rules:[{required:!0,message:"必填"}]}],expression:"['lowerLimit', { initialValue: model.lowerLimit, rules: [{ required: true, message: '必填' }] }]"}],staticStyle:{width:"110px"},attrs:{name:"lowerLimit",min:0,max:9999,step:1,precision:3,placeholder:"价格下限"},on:{blur:e.onLimitBlur}})],1)],1),a("a-col",{attrs:{span:2}},[a("span",{staticStyle:{"margin-left":"0px"}},[e._v(" ~ ")])]),a("a-col",{attrs:{span:10}},[a("a-form-item",[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["upperLimit",{initialValue:e.model.upperLimit,rules:[{required:!0,message:"必填"}]}],expression:"['upperLimit', { initialValue: model.upperLimit, rules: [{ required: true, message: '必填' }] }]"}],staticStyle:{width:"110px"},attrs:{name:"upperLimit",min:0,max:9999,step:1,precision:3,placeholder:"价格上限"},on:{blur:e.onLimitBlur}})],1)],1),a("span",{staticStyle:{"margin-left":"8px"}},[e._v("元")])],1)],1),a("a-form-item",{staticClass:"formItem",attrs:{label:"撤单控制"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["cancelControl",{initialValue:e.model.cancelControl,rules:[{required:!0,message:"必选"}]}],expression:"['cancelControl', { initialValue: model.cancelControl, rules: [{ required: true, message: '必选' }] }]"}]},[a("a-radio",{attrs:{value:0}},[e._v("控制")]),a("a-radio",{attrs:{value:1}},[e._v("不控制")])],1)],1),e.isHK?a("a-form-item",e._b({staticClass:"formItem",attrs:{label:"最小仓底"}},"a-form-item",e.formLayout,!1),[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["minBase",{initialValue:e.model.minBase,rules:[{required:!1,message:"选填"}]}],expression:"['minBase', { initialValue: model.minBase, rules: [{ required: false, message: '选填' }] }]"}],staticStyle:{width:"120px"},attrs:{name:"minBase",min:0,step:100,precision:0,placeholder:"请输入股票数量"}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v("股")])],1):e._e()],1)],1)],1)],1),a("update-confirm",{attrs:{visible:e.showConfirm,from:"StrategyUpdate"},on:{cancel:e.confirmCancel,ok:e.confirmOk}})],1)},q=[],$=(a("4de4"),a("ac1f"),a("5319"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"",width:300,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"},closable:!1,destroyOnClose:!0},on:{ok:e.onOk,cancel:function(){e.$emit("cancel")}}},[a("a-spin",{attrs:{spinning:e.loading}},[a("p",[e._v(e._s(e.confirmContent[e.from].title))]),"StrategyDelete"==e.from?a("a-form-item",{attrs:{label:"下架原因"}},[a("a-input",{attrs:{maxLength:20,placeholder:"请输入原因"},model:{value:e.reason,callback:function(t){e.reason=t},expression:"reason"}})],1):e._e(),a("a-form-item",{attrs:{label:e.confirmContent[e.from].descTitle}},[a("a-textarea",{attrs:{"allow-clear":"",autoSize:{minRows:2,maxRows:5},maxLength:500,placeholder:"请输入"},model:{value:e.desc,callback:function(t){e.desc=t},expression:"desc"}})],1),a("a-form-item",e._b({attrs:{label:"是否推送"}},"a-form-item",e.formLayout,!1),[a("a-switch",{model:{value:e.pushControl,callback:function(t){e.pushControl=t},expression:"pushControl"}})],1),a("p",[a("a-icon",{attrs:{type:"info-circle"}}),e._v(e._s(" 推送前请再次确认参数"))],1)],1)],1)}),U=[],O=(a("498a"),{components:{},props:{visible:{type:Boolean,required:!0},from:{require:!0,type:String,default:""}},data:function(){return this.formLayout={labelCol:{md:{span:6},xs:{span:24}},wrapperCol:{md:{span:18},xs:{span:24}}},{confirmContent:f,loading:!1,reason:"",desc:"",pushControl:!1}},computed:{},created:function(){},methods:{onOk:function(){var e=this.reason,t=this.desc,a=this.pushControl,r=this.from;if("StrategyDelete"===r){if(!e||!e.trim()||!t||!t.trim())return void this.$message.info("下架原因和说明不能为空！")}else if("StrategyUpdate"===r&&a&&(!t||!t.trim()))return void this.$message.info("更新说明不能为空！");this.$emit("ok",{reason:e,desc:t,pushControl:a?0:1})}}}),j=O,A=(a("7ef4"),Object(V["a"])(j,$,U,!1,null,"b85a4f8c",null)),z=A.exports,R=a("c1df"),E=a.n(R),M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{staticStyle:{"margin-bottom":"10px"}},[a("h4",[e._v(e._s(e.title))]),e.showDelete?a("a-icon",{staticClass:"delete",staticStyle:{color:"#F12123"},attrs:{type:"delete"},on:{click:function(){return e.$emit("delete")}}}):e._e(),a("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[a("a-form-item",{staticClass:"formItem",attrs:{label:"用例名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["testName",{initialValue:e.info.testName,rules:[{required:!0,message:"必填"}]}],expression:"['testName', { initialValue: info.testName, rules: [{ required: true, message: '必填' }] }]"}],attrs:{"allow-clear":"",placeholder:"如：近3月"}})],1),a("a-form-item",{staticClass:"formItem",attrs:{label:"回测更新时间"}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["testUpdateDate",{rules:[{initialValue:e.info.testUpdateDate,type:"object",required:!0,message:"请选择更新时间"}]}],expression:"['testUpdateDate', {rules: [{initialValue: info.testUpdateDate, type: 'object', required: true, message: '请选择更新时间' }]}]"}]})],1),a("a-form-item",{staticClass:"formItem",attrs:{label:"回测网格收益率"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["strategyProfit",{initialValue:e.info.strategyProfit,rules:[{required:!0,message:"必填"}]}],expression:"['strategyProfit', { initialValue: info.strategyProfit, rules: [{ required: true, message: '必填' }] }]"}],staticStyle:{width:"120px"},attrs:{precision:2}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v("%")])],1),a("a-form-item",{staticClass:"formItem",attrs:{label:"回测"+e.stockKindName+"收益率"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["fundProfit",{initialValue:e.info.fundProfit,rules:[{required:!0,message:"必填"}]}],expression:"['fundProfit', { initialValue: info.fundProfit, rules: [{ required: true, message: '必填' }] }]"}],staticStyle:{width:"120px"},attrs:{precision:2}}),a("span",{staticStyle:{"margin-left":"8px"}},[e._v("%")])],1),a("a-form-item",{attrs:{label:"回测数据图"}},[a("a-upload",{attrs:{name:"testPic",accept:".png,.jpg,.jpeg",beforeUpload:e.beforeUpload,showUploadList:!1}},[a("a-button",{attrs:{type:"primary",icon:"plus"}},[e._v(e._s(this.testPic?"更新图片":"上传图片"))]),a("div",{staticStyle:{"margin-left":"20px"}},[e._v(e._s(e.fileName))])],1)],1)],1),e.showAdd?a("a-button",{staticStyle:{height:"24px"},attrs:{block:"",type:"link"},on:{click:function(){return e.$emit("add")}}},[a("a-icon",{attrs:{type:"plus"}}),e._v("添加新的回测用例")],1):e._e()],1)},Y=[],B=(a("1276"),["testName","testUpdateDate","strategyProfit","fundProfit"]),K={props:{info:{type:Object,default:function(){}},showDelete:{type:Boolean,default:!0},showAdd:{type:Boolean,default:!0},title:{type:String,default:"回测"},stockKind:{type:String,default:"1"}},data:function(){return this.formLayout={labelCol:{md:{span:10},xs:{span:24}},wrapperCol:{md:{span:14},xs:{span:24}}},{form:this.$form.createForm(this),testPic:""}},computed:{fileName:function(){var e=this.testPic;if(!e)return"";var t=e.split("?")[0];if(t){var a=t.split("@")[1];return a.length>20?a.substring(0,20)+"~.png":a}return""},stockKindName:function(){var e=this.stockKind;return e&&g[e+""]?g[e+""]:"基金"}},created:function(){var e=this;B.forEach((function(t){return e.form.getFieldDecorator(t)})),this.info&&(this.form.setFieldsValue(C()(this.info,B)),this.info.testPic?this.testPic=this.info.testPic:this.testPic=""),this.$watch("info",(function(){try{e.info&&e.form.setFieldsValue(C()(e.info,B))}catch(t){}e.info&&e.info.testPic?e.testPic=e.info.testPic:e.testPic=""}))},methods:{beforeUpload:function(e){var t=this,a=this.$store.state.user,r="backTest_".concat(Date.now(),"@").concat(e.name);this.spinning=!0,Object(I["a"])(e,{key:"taetf-test/".concat(a.userId,"/").concat(r),appId:"weClub"}).then((function(e){t.testPic=e.url})).catch((function(e){})).finally((function(){t.spinning=!1}))}}},H=K,W=(a("9701"),Object(V["a"])(H,M,Y,!1,null,"a055922a",null)),G=W.exports,Q=["name","code","strategyDesc","baseAmount","totalAmount","totalGridSize","baseDesc","startPrice","gridType","waveType","gridUpSize","gridDownSize","tradeType","tradeWay","gridDownNum","gridUpNum","buyPrice","sellPrice","tradeNumControl","period","lowerLimit","upperLimit","cancelControl","minBase","fixedDesc","showFixed","fixedState","defaultFixed","fixedDay","showBackTest","pullbackSale","spinodalBuy","strategyProfit","strategyProfitInfinity","fundProfit","showPlanForm","planFormImg","showTradingRecord","entrustParamImg","planFormImg","tradingRecordFormImg"],X={components:{UpdateConfirm:z,TestData:G,Uploader:n["d"]},props:{visible:{type:Boolean,required:!0},model:{type:Object,default:function(){}},etfList:{type:Array,default:function(){return[]}},supplierList:{type:Array,default:function(){return[]}},strategyType:{type:Number,default:1},organizationCode:{type:String,default:""}},data:function(){return this.formLayout={labelCol:{md:{span:8},xs:{span:24}},wrapperCol:{md:{span:16},xs:{span:24}}},this.formLayout2={labelCol:{md:{span:12},xs:{span:24}},wrapperCol:{md:{span:12},xs:{span:24}},labelAlign:"right"},this.newTestData=function(){return{testName:"",testUpdateDate:void 0,strategyProfit:0,fundProfit:0,testPic:""}},{loading:!1,moment:E.a,priceList:p,daysInWeek:h,fixedOptions:v,form:this.$form.createForm(this),showConfirm:!1,confirmParams:null,stockCode:"",backTestList:[],planFormImgUrls:[],planFormImg:"",tradingRecordFormImgUrls:[],tradingRecordFormImg:"",entrustParamImgUrls:[],entrustParamImg:"",periodForever:!1}},computed:{stockKind:function(){var e=this.stockCode;if(!e)return"";var t=this.etfList.find((function(t){return t.stockCode===e}));return t?t.stockKind+"":""},stockKindName:function(){var e=this.stockKind;return e&&g[e+""]?g[e+""]:"基金"},isA:function(){return 1===this.strategyType},isHK:function(){return 2===this.strategyType},isXM:function(){return y(this.organizationCode)}},mounted:function(){var e=this;window.edit=this,Q.forEach((function(t){return e.form.getFieldDecorator(t)})),this.stockCode=this.model?this.model.code:"",this.$watch("model",(function(){var t,a,r,i,o,s;e.stockCode=e.model?e.model.code:"",e.$nextTick((function(){var t;1===(null===(t=e.model)||void 0===t?void 0:t.strategyProfitInfinity)?e.model.strategyProfitInfinity=!0:e.model.strategyProfitInfinity=!1;try{e.model&&e.form.setFieldsValue(C()(e.model,Q))}catch(a){}})),e.model&&0===e.model.showBackTest&&e.model.backTestList?e.backTestList=e.model.backTestList.map((function(e){return{testName:e.testName,testUpdateDate:E()(e.testUpdateDate,"YYYYMMDD"),strategyProfit:e.strategyProfit,fundProfit:e.fundProfit,testPic:e.testPic}})):e.backTestList=[],0===(null===(t=e.model)||void 0===t?void 0:t.showPlanForm)&&null!==(a=e.model)&&void 0!==a&&a.planFormImg&&(e.planFormImg=e.model.planFormImg,e.planFormImgUrls=[e.model.planFormImg]),0===(null===(r=e.model)||void 0===r?void 0:r.showTradingRecord)&&null!==(i=e.model)&&void 0!==i&&i.tradingRecordFormImg&&(e.tradingRecordFormImg=e.model.tradingRecordFormImg,e.tradingRecordFormImgUrls=[e.model.tradingRecordFormImg]),null!==(o=e.model)&&void 0!==o&&o.entrustParamImg&&(e.entrustParamImg=e.model.entrustParamImg,e.entrustParamImgUrls=[e.model.entrustParamImg]),-1===(null===(s=e.model)||void 0===s?void 0:s.period)&&(e.periodForever=!0,e.$nextTick((function(){e.form.setFieldsValue({period:void 0})})))}))},destroyed:function(){this.backTestList=[]},methods:{fixedLabel:function(e){var t=this.fixedOptions.find((function(t){return t.value===e}));return t?t.labelFx:"每周"},onDefaultFixedChange:function(e){var t=e.target.value;if(1===t||2===t){var a=this.form.getFieldValue("fixedDay");a>this.daysInWeek[this.daysInWeek.length-1].value&&this.form.setFieldsValue({fixedDay:"1"})}},gtZero:function(e,t,a){t<=0?a(new Error("必须大于0")):a()},onOk:function(){var e=this,t=this.form;this.loading=!0,t.validateFields((function(t,a){if(t)e.loading=!1;else{var r=[],i=!1;if(0===a.showBackTest&&e.backTestList.forEach((function(t,a){var s=e.$refs["testData".concat(a)][0],n=s.form;n.validateFields((function(e,t){if(e)i=!0;else{var n=Object(o["a"])({},t);n.testUpdateDate=n.testUpdateDate.format("YYYYMMDD"),n.testPic=s.testPic,n.testId=a+1,r.push(n)}}))})),i)return void(e.loading=!1);var s=Object(o["a"])(Object(o["a"])({},a),{},{backTestList:r,strategyType:e.strategyType});s.supplierCode=e.model.supplierCode,1===s.waveType&&(s.gridDownSize=s.gridUpSize),1===s.tradeType&&(s.gridDownNum=s.gridUpNum),e.periodForever&&(s.period=-1),s.strategyProfitInfinity?s.strategyProfitInfinity=1:s.strategyProfitInfinity=0;var n=e.etfList.find((function(e){return e.stockCode===s.code}));n&&(s.stockType=n.stockType,s.stockName=n.stockName,s.stockKind=n.stockKind,s.shares=n.shares),e.model.id?(s.strategyId=e.model.id,e.gotoConfirm(s)):e.doSubmit(s)}}))},doSubmit:function(e){var t=this,a=this.model.id?"updateStrategy":"createStrategy";b["a"][a](e).then((function(e){t.$emit("ok")})).catch((function(e){})).finally((function(){t.loading=!1}))},confirmOk:function(e){this.showConfirm=!1;var t=this.confirmParams;t.updateDesc=e.desc,t.pushControl=e.pushControl,this.doSubmit(t)},confirmCancel:function(){this.loading=!1,this.showConfirm=!1},gotoConfirm:function(e){this.confirmParams=e,this.showConfirm=!0},onLimitBlur:function(){var e=this.form,t=e.getFieldValue("lowerLimit"),a=e.getFieldValue("upperLimit");t>0&&a>0&&t>a&&e.setFieldsValue({lowerLimit:a,upperLimit:t})},handleAdd:function(){this.backTestList.push(Object(o["a"])({},this.newTestData()))},handleRemove:function(e){this.backTestList=this.backTestList.filter((function(t,a){return a!==e}))},handleStockChange:function(e){this.stockCode=e},disabledFixedDate:function(e){var t=e.date();return t>28},profitformatter:function(e){return e?"".concat(e,"%"):""},profitParser:function(e){return e.replace("%","")},onUploadEvent:function(e){var t=e.action,a=e.exId,r=e.file;"uploading"===t?this.spinning=!0:"done"===t?this.spinning=!1:"success"===t&&("planFormImg"===a?this.planFormImg=r.url:"tradingRecordFormImg"===a?this.tradingRecordFormImg=r.url:"entrustParamImg"===a&&(this.entrustParamImg=r.url))},onStrategyProfitInfinityChange:function(e){e.target.checked&&this.form&&this.form.setFieldsValue({strategyProfit:""})},onStrategyProfitFouce:function(e){this.form&&this.form.setFieldsValue({strategyProfitInfinity:!1})}}},J=X,Z=(a("350d"),Object(V["a"])(J,P,q,!1,null,"7f337918",null)),ee=Z.exports,te={name:"GridList",components:{STable:n["c"],EditStrategy:ee,UpdateConfirm:z},props:{strategyType:{type:Number,default:1},supplierCode:{type:String,default:"xxx"},supplierName:{type:String,default:"xxxxx"},organizationCode:{type:String,default:""}},filters:{available:function(e){return 1!==e.state},available2:function(e){return 1===e.hideState}},data:function(){return{spinning:!1,columns:u,loadData:this.reqStrategy,showModel:!1,modalVisible:!1,confirmLoading:!1,modalData:{},etfList:[],showConfirm:!1,confirmParams:null,supplierList:[],supplierLoading:!1,queryParam:{},switchIndex:""}},created:function(){var e=this;this.$root.eventHub.$on("refreshView",(function(){e.resetQueryParams()}))},beforeRouteLeave:function(e,t,a){this.$root.eventHub.$off("refreshView"),a()},mounted:function(){var e=this;this.spinning=!0;var t=1===this.strategyType?"grid/GetAEtfList":"grid/GetHkEtfList";this.$store.dispatch(t).then((function(t){e.etfList=t})).catch((function(e){})).finally((function(){e.spinning=!1}))},methods:{stackName:function(e){if(this.etfList){var t=this.etfList,a=t.find((function(t){return t.stockCode===e}));return a?"".concat(a.stockName,"(").concat(e,")"):e}return e},getStockName:function(e){if(this.etfList){var t=this.etfList,a=t.find((function(t){return t.stockCode===e}));return a?a.stockName:""}return""},reqStrategy:function(e){var t=Object(o["a"])(Object(o["a"])({},e),{},{supplierCode:this.supplierCode,strategyType:this.strategyType});return t.pageNum=t.pageNo,delete t.pageNo,b["a"].getStrategyList(t).then((function(t){var a={totalCount:t.total,pageNo:e.pageNo,data:t.strategyList};return a})).catch((function(){return{totalCount:0,pageNo:1,data:[]}})).finally((function(){}))},resetQueryParams:function(){this.queryParam={},this.$refs.table&&this.$refs.table.refresh(!0)},handleAdd:function(){var e=this;this.modalData={supplierCode:this.supplierCode,gridType:1,waveType:1,tradeType:1,tradeWay:0,tradeNumControl:1,cancelControl:1,buyPrice:p[4].value,sellPrice:p[5].value},this.showModel=!0,this.$nextTick((function(){e.modalVisible=!0}))},handleOk:function(e){this.handleCancel(),this.$refs.table.refresh()},handleCancel:function(){var e=this;this.modalVisible=!1,this.confirmLoading=!1,this.modalData={};var t=this.$refs.createModal.form;t.resetFields(),this.$nextTick((function(){e.showModel=!1}))},onStatusChange2:function(e,t,a,r,i){var o=this;this.switctIndex=r;var s=Object.assign({},a,{strategyId:a.id,strategyType:this.strategyType,strategyName:a.name,stockCode:a.code,stockName:this.getStockName(a.code)});s.hideState=1===a.hideState?0:1,s.pushControl=0,b["a"].updateStrategy(s).then((function(e){o.$refs.table.refresh()})).catch((function(e){})).finally((function(){o.switctIndex=""}))},onStatusChange:function(e,t,a,r,i){var o=this;this.switctIndex=r;var s=Object.assign({},a,{strategyId:a.id,strategyType:this.strategyType,strategyName:a.name,stockCode:a.code,stockName:this.getStockName(a.code)});1===a.state?(s.state=0,s.pushControl=1,b["a"].updateStrategy(s).then((function(e){o.$message.success("策略已上架"),o.$refs.table.refresh()})).catch((function(e){})).finally((function(){o.switctIndex=""}))):this.gotoConfirm(s)},doDelete:function(e){var t=this;b["a"].deleteStrategy(e).then((function(e){t.$message.success("网格已下架"),t.$refs.table.refresh()})).catch((function(e){})).finally((function(){t.switchIndex=""}))},confirmOk:function(e){this.showConfirm=!1;var t=this.confirmParams;t.delReason=e.reason,t.delDesc=e.desc,t.pushControl=e.pushControl,this.doDelete(t)},gotoConfirm:function(e){this.switchIndex="",this.confirmParams=e,this.showConfirm=!0},handleUpdate:function(e){var t=this;e&&(this.showModel=!0,this.$nextTick((function(){t.modalVisible=!0,e.fixedDay=e.fixedDay?e.fixedDay+"":void 0,t.modalData=Object(o["a"])({},e)})))}}},ae=te,re=Object(V["a"])(ae,D,F,!1,null,null,null),ie=re.exports,oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-spin",{attrs:{spinning:e.spinning}},[a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"所属专区"}},[a("p",[e._v(e._s(e.supplierName))])])],1)],1)],1)],1),a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"rollback"},on:{click:function(){e.$emit("back")}}},[e._v("返回专区")]),a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("新建方案")])],1),a("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",columns:e.columns,data:e.loadData,alert:!1,rowSelection:null,showPagination:"auto"},scopedSlots:e._u([{key:"available",fn:function(t,r,i){return a("span",{},[a("a-switch",{attrs:{loading:i===e.switchIndex,checked:e._f("available")(r)},on:{change:function(a){return e.onStatusChange(a,t,r,i,"state")}}})],1)}},{key:"action",fn:function(t,r){return a("span",{},[[a("a",{staticStyle:{color:"#1890ff"},on:{click:function(t){return e.handleUpdate(r)}}},[e._v("修改")])]],2)}}])})],1)],1),e.showModal?a("edit-plan",{ref:"createModal",attrs:{visible:e.modalVisible,loading:e.confirmLoading,model:e.modalData,supplierCode:e.supplierCode,planType:e.planType,targetStrategyList:e.targetStrategyList},on:{cancel:e.handleCancel,ok:e.handleOk}}):e._e()],1)},se=[],ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"编辑",width:600,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"},destroyOnClose:!0},on:{ok:e.onOk,cancel:function(){e.$emit("cancel")}}},[a("a-spin",{attrs:{spinning:e.loading}},[a("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[a("a-form-item",{attrs:{label:"方案名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["planName",{initialValue:e.model.planName,rules:[{required:!0,message:"必填"}]}],expression:"['planName', { initialValue: model.planName, rules: [{ required: true, message: '必填' }] }]"}],attrs:{name:"planName","max-length":10,placeholder:"最多10个字符","allow-clear":""}})],1),a("a-form-item",{attrs:{label:"排序值"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["planSort",{initialValue:e.model.planSort,rules:[{required:!0,message:"必填"}]}],expression:"['planSort', { initialValue: model.planSort, rules: [{ required: true, message: '必填' }] }]"}],attrs:{name:"planSort","allow-clear":""}})],1),a("a-form-item",{attrs:{label:"提示说明"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["planDes",{initialValue:e.model.planDes,rules:[{required:!1,message:"必填"}]}],expression:"['planDes', { initialValue: model.planDes, rules: [{ required: false, message: '必填' }] }]"}],attrs:{name:"planDes","allow-clear":"",autoSize:{minRows:2,maxRows:3},placeholder:"请输入提示说明"}})],1),a("a-form-item",{attrs:{label:"配置内容"}},[e._l(e.strategyList,(function(t,r){return a("strategy-card",{key:r,ref:"card"+r,refInFor:!0,attrs:{info:t,title:"网格"+(r+1),showDelete:e.strategyList.length>1,targetStrategyList:e.targetStrategyList,strategyType:e.planType},on:{delete:function(t){return e.handleRemove(r)}}})})),a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("添加网格")])],2)],1)],1)],1)},le=[],de=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{staticStyle:{"margin-bottom":"10px"}},[a("h4",[e._v(e._s(e.title))]),e.showDelete?a("a-icon",{staticClass:"delete",staticStyle:{color:"#F12123"},attrs:{type:"delete"},on:{click:function(){return e.$emit("delete")}}}):e._e(),a("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[a("a-form-item",e._b({attrs:{label:"网格"}},"a-form-item",e.formLayout2,!1),[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["strategyId",{initialValue:e.info.strategyId,rules:[{required:!0,message:"必选"}]}],expression:"['strategyId', { initialValue: info.strategyId, rules: [{ required: true, message: '必选' }] }]"}],attrs:{labelInValue:!1,options:e.targetStrategyList,showSearch:"",optionFilterProp:"children",placeholder:"请选择"}})],1),e.isHK?a("a-form-item",{staticClass:"formItem",attrs:{label:"底仓"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["baseAmount",{initialValue:e.info.baseAmount||0,rules:[{required:!0,message:"必填"}]}],expression:"['baseAmount', { initialValue: info.baseAmount || 0, rules: [{ required: true, message: '必填' }] }]"}],attrs:{min:0}})],1):e._e(),e.isA?a("a-form-item",{staticClass:"formItem",attrs:{label:"网格备用金"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["imprest",{initialValue:e.info.imprest||0,rules:[{required:!0,message:"必填"}]}],expression:"['imprest', { initialValue: info.imprest || 0, rules: [{ required: true, message: '必填' }] }]"}],attrs:{min:0}})],1):e._e(),a("a-form-item",{staticClass:"formItem",attrs:{label:"投入总金额"}},[a("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["totalAmount",{initialValue:e.info.totalAmount||0,rules:[{required:!0,message:"必填"}]}],expression:"['totalAmount', { initialValue: info.totalAmount || 0, rules: [ { required: true, message: '必填' } ] }]"}],attrs:{min:0}})],1)],1)],1)},ue=[],ce=["strategyId","baseAmount","imprest","totalAmount"],me={props:{info:{type:Object,default:function(){}},showDelete:{type:Boolean,default:!0},title:{type:String,default:"网格"},targetStrategyList:{type:Array,default:function(){return[]}},strategyType:{type:Number,default:1}},computed:{isA:function(){return 1===this.strategyType},isHK:function(){return 2===this.strategyType}},data:function(){return this.formLayout={labelCol:{md:{span:6},xs:{span:24}},wrapperCol:{md:{span:18},xs:{span:24}}},this.formLayout2={labelCol:{md:{span:6},xs:{span:24}},wrapperCol:{md:{span:12},xs:{span:24}}},{form:this.$form.createForm(this),test:"hhhh"}},created:function(){var e=this;ce.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("info",(function(){e.info&&e.form.setFieldsValue(C()(e.model,ce))}))},methods:{gtBaseAmount:function(e,t,a){var r=this.form.getFieldValue("baseAmount");t?t<=r?(e.message="必须大于仓底",a(new Error("必须大于仓底"))):a():(e.message="必填",a(new Error("必填")))}}},pe=me,fe=(a("cc96"),Object(V["a"])(pe,de,ue,!1,null,"13d1ad8d",null)),ge=fe.exports,he=["planName","planSort","planDes"],ve={components:{StrategyCard:ge},props:{visible:{type:Boolean,required:!0},model:{type:Object,default:function(){}},supplierCode:{type:String,default:""},planType:{type:Number,default:1},targetStrategyList:{type:Array,default:function(){return[]}}},data:function(){return this.formLayout={labelCol:{md:{span:6},xs:{span:24}},wrapperCol:{md:{span:18},xs:{span:24}}},this.formLayout2={labelCol:{md:{span:6},xs:{span:24}},wrapperCol:{md:{span:8},xs:{span:24}}},this.newStrategy=function(){return{strategyId:"",imprest:0,totalAmount:0}},{loading:!1,form:this.$form.createForm(this),tipSwitch:!0,strategyList:[Object(o["a"])({},this.newStrategy())]}},computed:{},created:function(){var e=this;he.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("model",(function(){e.model&&e.form.setFieldsValue(C()(e.model,he)),e.model&&e.model.strategyList?e.strategyList=e.model.strategyList:e.strategyList=[Object(o["a"])({},e.newStrategy())]}))},mounted:function(){this.model&&this.model.strategyList?this.strategyList=this.model.strategyList:this.strategyList=[Object(o["a"])({},this.newStrategy())]},methods:{onOk:function(){var e=this,t=this.form,a=this.supplierCode,r=this.planType;this.loading=!0,t.validateFields((function(t,i){if(t)e.loading=!1;else{var s=[],n=!1;if(e.strategyList.forEach((function(t,a){var r=e.$refs["card".concat(a)][0].form;r.validateFields((function(e,t){e?n=!0:s.push(t)}))})),n)return void(e.loading=!1);var l=e.model.id,d=l?"updatePlan":"createPlan",u=Object(o["a"])(Object(o["a"])({},i),{},{strategyList:s,supplierCode:a,planType:r});l&&(u.planId=l),"updatePlan"===d?e.$confirm({title:"提示",content:"您已更新方案数据，是否确认？",onOk:function(){e.doUpdate(d,u)},onCancel:function(){e.loading=!1}}):e.doUpdate(d,u)}}))},doUpdate:function(e,t){var a=this;b["a"][e](t).then((function(e){a.$message.info("操作成功"),a.$emit("ok")})).catch((function(e){a.loading=!1,"20100006"===e.responseCode?a.$message.error("网格不存在！"):a.$message.error(e.responseMsg)}))},handleAdd:function(){this.strategyList.push(Object(o["a"])({},this.newStrategy()))},handleRemove:function(e){this.strategyList=this.strategyList.filter((function(t,a){return a!==e}))}}},ye=ve,be=(a("de53"),Object(V["a"])(ye,ne,le,!1,null,"9175d4d6",null)),we=be.exports,xe={name:"Plan",components:{STable:n["c"],EditPlan:we},props:{planType:{type:Number,default:1},supplierCode:{type:String,default:""},supplierName:{type:String,default:""}},filters:{available:function(e){return 0===e.state}},data:function(){return{spinning:!1,columns:c,loadData:this.reqPlan,modalVisible:!1,showModal:!1,confirmLoading:!1,modalData:{},planList:[],supplierLoading:!1,targetStrategyList:[],queryParam:{},switchIndex:""}},computed:{activePlanNum:function(){var e=this.planList.filter((function(e){return 0===e.state}));return e.length}},mounted:function(){},methods:{loadTargetStrategyList:function(){var e=this,t=this.supplierCode,a=this.planType,r={supplierCode:t,strategyType:a,pageNum:0,pageSize:100};return new Promise((function(t,a){e.targetStrategyList.length?t():(e.loading=!0,b["a"].getStrategyList(r).then((function(a){e.targetStrategyList=a.strategyList.map((function(e){return{label:e.name,value:e.id}})),t()})).catch((function(t){e.targetStrategyList=[],e.$message.error("暂无可选的网格，请先创建网格！"),a(new Error("No targetStrategyList!"))})).finally((function(){e.loading=!1})))}))},reqPlan:function(e){var t=this,a=Object(o["a"])(Object(o["a"])({},e),{},{supplierCode:this.supplierCode,planType:this.planType});return a.pageNum=a.pageNo,delete a.pageNo,b["a"].getPlanList(a).then((function(a){var r={totalCount:a.total,pageNo:e.pageNo,data:a.planList};return t.planList=a.planList,r})).catch((function(){return t.planList=[],{totalCount:0,pageNo:1,data:[]}})).finally((function(){}))},resetQueryParams:function(){this.queryParam={},this.$refs.table.refresh(!0)},handleAdd:function(){var e=this;this.activePlanNum>=5?this.$message.info("最多上架5个方案，您可以先下架其他方案再新建！"):this.loadTargetStrategyList().then((function(){e.modalData={planSort:e.planList.length,planType:e.planType},e.showModal=!0,e.modalVisible=!0}))},handleOk:function(e){this.handleCancel(),this.$refs.table.refresh()},handleCancel:function(){this.showModal=!1,this.modalVisible=!1,this.confirmLoading=!1,this.modalData={};var e=this.$refs.createModal.form;e.resetFields()},onStatusChange:function(e,t,a,r,i){var s=this;this.switctIndex=r;var n=Object(o["a"])({},a);n.state=0===n.state?1:0,n.planId=n.id,n.planType=a.planType,b["a"].updatePlan(n).then((function(e){s.$refs.table.refresh()})).catch((function(e){"20100001"===e.responseCode?s.$message.error("最多上架5个方案，您可以先下架其他方案！"):s.$message.error(e.responseMsg)})).finally((function(){s.switctIndex=""}))},handleChangeState:function(e){var t=this;this.spinning=!1;var a=Object(o["a"])({},e);a.state=0===a.state?1:0,a.planId=a.id,a.planType=e.planType,b["a"].updatePlan(a).then((function(e){t.$refs.table.refresh()})).catch((function(e){"20100001"===e.responseCode?t.$message.error("最多上架5个方案，您可以先下架其他方案！"):t.$message.error(e.responseMsg)})).finally((function(){t.spinning=!1}))},handleUpdate:function(e){var t=this;e&&this.loadTargetStrategyList().then((function(){t.showModal=!0,t.modalVisible=!0,t.modalData=Object(o["a"])({},e)}))}}},Se=xe,Ce=Object(V["a"])(Se,oe,se,!1,null,null,null),Ie=Ce.exports,_e=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-spin",{attrs:{spinning:e.spinning}},[a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"所属专区"}},[a("p",[e._v(e._s(e.supplierName))])])],1)],1)],1)],1),a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"rollback"},on:{click:function(){e.$emit("back")}}},[e._v("返回专区")]),a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("新建报告")])],1),a("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",columns:e.columns,data:e.loadData,alert:!1,rowSelection:null,showPagination:"auto"},scopedSlots:e._u([{key:"action",fn:function(t,r){return a("span",{},[[a("a",{staticStyle:{color:"#1890ff"},on:{click:function(t){return e.handleUpdate(r)}}},[e._v("更新")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.handleDelete(r)}}},[e._v("删除")])]],2)}}])})],1)],1),a("edit-report",{ref:"createModal",attrs:{visible:e.modalVisible,loading:e.confirmLoading,model:e.modalData},on:{cancel:e.handleCancel,ok:e.handleOk}})],1)},ke=[],Ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"编辑",width:560,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:e.onOk,cancel:function(){e.$emit("cancel")}}},[a("a-spin",{attrs:{spinning:e.loading}},[a("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[a("a-form-item",{attrs:{label:"报告名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["reportName",{initialValue:e.model.reportName,rules:[{required:!0,message:"必填"}]}],expression:"['reportName', { initialValue: model.reportName, rules: [{ required: true, message: '必填' }] }]"}],attrs:{name:"reportName",placeholder:"请输入报告","allow-clear":""}})],1),a("a-form-item",{attrs:{label:"报告"}},[a("a-upload",{attrs:{name:"reportUrl",accept:".pdf",beforeUpload:e.beforeUpload,showUploadList:!1}},[a("a-button",{attrs:{type:"primary",icon:"plus"}},[e._v(e._s(this.reportUrl?"更新报告":"上传报告"))]),a("span",{staticStyle:{"margin-left":"20px"}},[e._v(e._s(e.fileName))])],1)],1)],1)],1)],1)},Ve=[],Le=["reportName"],Te={components:{},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}},supplierList:{type:Array,default:function(){return[]}},markets:{type:Array,default:function(){return[]}}},data:function(){return this.formLayout={labelCol:{md:{span:6},xs:{span:24}},wrapperCol:{md:{span:18},xs:{span:24}}},this.formLayout2={labelCol:{md:{span:6},xs:{span:24}},wrapperCol:{md:{span:8},xs:{span:24}}},{form:this.$form.createForm(this),reportUrl:""}},computed:{fileName:function(){var e=this.reportUrl;if(!e)return"";var t=e.split("?")[0];if(t){var a=t.split("@")[1];return a.length>20?a.substring(0,20)+"~.png":a}return""}},created:function(){var e=this;Le.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("model",(function(){e.model&&e.form.setFieldsValue(C()(e.model,Le)),e.model&&e.model.reportUrl?e.reportUrl=e.model.reportUrl:e.reportUrl=""}))},methods:{beforeUpload:function(e){var t=this,a=this.$store.state.user,r="report_".concat(Date.now(),"@").concat(e.name);this.spinning=!0,Object(I["a"])(e,{key:"taetf/".concat(a.userId,"/").concat(r),appId:"weClub"}).then((function(e){t.reportUrl=e.url})).catch((function(e){})).finally((function(){t.spinning=!1}))},onOk:function(){this.reportUrl?this.$emit("ok",{reportUrl:this.reportUrl}):this.$message.info("请上传报告")}}},De=Te,Fe=Object(V["a"])(De,Ne,Ve,!1,null,null,null),Pe=Fe.exports,qe={name:"Report",components:{STable:n["c"],EditReport:Pe},props:{reportType:{type:Number,default:1},supplierCode:{type:String,default:""},supplierName:{type:String,default:""}},data:function(){return{spinning:!1,columns:m,loadData:this.reqReports,modalVisible:!1,confirmLoading:!1,modalData:{},supplierList:[],supplierLoading:!1,queryParam:{}}},mounted:function(){},methods:{reqReports:function(e){var t=Object(o["a"])(Object(o["a"])({},e),{},{supplierCode:this.supplierCode,reportType:this.reportType});return t.pageNum=t.pageNo,delete t.pageNo,b["a"].getReports(t).then((function(t){var a={totalCount:t.total,pageNo:e.pageNo,data:t.reportList};return a})).catch((function(){return{totalCount:0,pageNo:1,data:[]}})).finally((function(){}))},resetQueryParams:function(){this.queryParam={},this.$refs.table.refresh(!0)},handleAdd:function(){this.modalData={},this.modalVisible=!0},handleOk:function(e){var t=this,a=this.$refs.createModal.form;this.confirmLoading=!0,a.validateFields((function(a,r){if(a)t.confirmLoading=!1;else{var i=t.modalData.id,s=i?"updateReport":"uploadReport",n=Object(o["a"])(Object(o["a"])({},r),{},{supplierCode:t.supplierCode,reportType:t.reportType});n.reportUrl=e.reportUrl,i&&(n.reportId=i),b["a"][s](n).then((function(e){t.$message.info("操作成功"),t.handleCancel(),t.$refs.table.refresh()})).catch((function(){t.confirmLoading=!1}))}}))},handleCancel:function(){this.modalVisible=!1,this.confirmLoading=!1,this.modalData={};var e=this.$refs.createModal.form;e.resetFields()},handleDelete:function(e){var t=this;this.$confirm({title:"系统提示",content:"确认要删除该报告？删除后将不能恢复。",okText:"确认",cancelText:"取消",onOk:function(){t.doDelete(e)},onCancel:function(){}})},doDelete:function(e){var t=this;this.spinning=!1,b["a"].deleteReport({reportId:e.id,recordType:e.recordType}).then((function(e){t.$message.success("报告已下架"),t.$refs.table.refresh()})).catch((function(e){})).finally((function(){t.spinning=!1}))},handleUpdate:function(e){e&&(this.modalVisible=!0,this.modalData=Object(o["a"])({},e))}}},$e=qe,Ue=Object(V["a"])($e,_e,ke,!1,null,null,null),Oe=Ue.exports,je={components:{STable:n["c"],EditSupplier:T,GridList:ie,Plan:Ie,Report:Oe},props:{supplierType:{type:Number,default:1}},computed:{clubId:function(){return this.$store.getters.taClubId}},filters:{available:function(e){return 0===e.state}},data:function(){return{isXM:y,spinning:!1,columns:d,loadData:this.loadSupplierList,switchIndex:"",visibleEdit:!1,modelData:{},organizationList:[],newSortNum:1,showUIMode:"",curSupplierCode:"",curSupplierName:"",curOrganizationCode:""}},created:function(){var e=this;this.$root.eventHub.$on("refreshView",(function(){e.$refs.table&&e.$refs.table.refresh(!0)})),this.init()},beforeRouteLeave:function(e,t,a){this.$root.eventHub.$off("refreshView"),a()},methods:{init:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("ta/GetToken");case 2:e.loadOrganizationList(),e.$refs.table&&e.$refs.table.refresh(!0);case 4:case"end":return t.stop()}}),t)})))()},loadOrganizationList:function(){var e=this;this.$store.dispatch("grid/GetOrganizationList",{refresh:!0,organizationType:this.supplierType}).then((function(t){e.organizationList=t.map((function(e){return{label:e.organizationName,value:e.organizationCode}}))})).catch((function(t){e.organizationList=[]})).finally((function(){}))},loadSupplierList:function(e){var t=this;if(!this.clubId)return new Promise((function(e,t){return e({}),{}}));var a=Object(o["a"])(Object(o["a"])(Object(o["a"])({},e),this.queryParam),{},{supplierType:this.supplierType,serviceId:"TA",businessId:this.clubId});return a.pageNum=a.pageNo,delete a.pageNo,b["a"].getSupplierInfoList(a).then((function(a){var r={totalCount:a.total,pageNo:e.pageNo,data:a.supplierList},i=1;return a.supplierList.forEach((function(e){e.supplierSort>=i&&(i=e.supplierSort+1)})),t.newSortNum=i,r})).catch((function(){return t.newSortNum=2,{totalCount:0,pageNo:1,data:[]}})).finally((function(){}))},handleAdd:function(){this.modelData={supplierSort:this.newSortNum},this.visibleEdit=!0},handleEdit:function(e){this.modelData=e,this.visibleEdit=!0},onEditOk:function(){this.$refs.table.refresh(!0),this.onEditCancel()},onEditCancel:function(){var e=this.$refs.createModal.form;e.resetFields(),this.visibleEdit=!1},handleGridManage:function(e){this.curSupplierCode=e.supplierCode,this.curSupplierName=e.supplierName,this.curOrganizationCode=e.organizationCode,this.showUIMode="grid"},handlePlan:function(e){this.curSupplierCode=e.supplierCode,this.curSupplierName=e.supplierName,this.showUIMode="plan"},handleReport:function(e){this.curSupplierCode=e.supplierCode,this.curSupplierName=e.supplierName,this.showUIMode="report"},handleDelete:function(e){var t=this;this.$confirm({title:"系统提示",content:"确认要删除该专区吗？删除后数据将不能恢复。",okText:"确认",cancelText:"取消",onOk:function(){t.doDelete(e)},onCancel:function(){}})},doDelete:function(e){var t=this;b["a"].deleteSupplier({supplierId:e.id}).then((function(e){t.$refs.table.refresh(),t.$message.info("删除成功")}))},onStatusChange:function(e,t,a,r,i){var o=this;this.switchIndex=r;var s={supplierId:a.id,state:1===a[i]?0:1};b["a"].updateSupplier(s).then((function(e){a[i]=1===a[i]?0:1})).catch((function(e){})).finally((function(){o.switchIndex=""}))}}},Ae=je,ze=Object(V["a"])(Ae,r,i,!1,null,null,null);t["a"]=ze.exports},c3c3:function(e,t,a){},cc96:function(e,t,a){"use strict";a("c3c3")},cec0:function(e,t,a){"use strict";a("7f38")},d85a:function(e,t,a){},de53:function(e,t,a){"use strict";a("8405")}}]);
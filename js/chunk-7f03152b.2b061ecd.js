(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7f03152b"],{"5db2":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-header-wrapper",{attrs:{title:!1}},[a("a-spin",{attrs:{spinning:e.spinning}},[a("a-card",[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"客户姓名"}},[a("a-input",{attrs:{"allow-clear":"",placeholder:""},model:{value:e.queryParam.customerName,callback:function(t){e.$set(e.queryParam,"customerName",t)},expression:"queryParam.customerName"}})],1)],1),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"客户电话"}},[a("a-input",{attrs:{"allow-clear":"",placeholder:""},model:{value:e.queryParam.customerPhone,callback:function(t){e.$set(e.queryParam,"customerPhone",t)},expression:"queryParam.customerPhone"}})],1)],1),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"选择省份"}},[a("a-select",{attrs:{options:e.cityData,loading:e.areaLoading,showSearch:"",allowClear:"",placeholder:"请选择"},on:{change:e.onProvinceChange},model:{value:e.queryParam.province,callback:function(t){e.$set(e.queryParam,"province",t)},expression:"queryParam.province"}})],1)],1),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"选择城市"}},[a("a-select",{attrs:{options:e.cityList,loading:e.areaLoading,showSearch:"",allowClear:"",filterOption:e.onCitySearch,placeholder:"请选择"},on:{change:e.onCityChange},model:{value:e.queryParam.city,callback:function(t){e.$set(e.queryParam,"city",t)},expression:"queryParam.city"}})],1)],1),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"银行名称"}},[a("a-select",{attrs:{labelInValue:!0,options:e.bankData,loading:e.bankDataLoading,showSearch:"",optionFilterProp:"children",allowClear:"",placeholder:"请选择"},model:{value:e.queryParam.bank,callback:function(t){e.$set(e.queryParam,"bank",t)},expression:"queryParam.bank"}})],1)],1),a("a-col",{attrs:{md:7,sm:24}},[a("a-form-item",{attrs:{label:"申请时间"}},[a("a-range-picker",{attrs:{value:e.applicationTimes,placeholder:["开始时间","结束时间"],format:"YYYY-MM-DD",mode:e.pickerMode},on:{panelChange:e.handlePanelChange,change:e.handleChange}})],1)],1),a("a-col",{attrs:{md:4,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"reload"},on:{click:e.resetQueryParams}},[e._v("重置")])],1)])],1)],1)],1),a("s-table",{ref:"table",attrs:{size:"default",rowKey:"orderId",columns:e.columns,data:e.loadData,alert:!1,scroll:{x:e.tableX},showPagination:"auto"},scopedSlots:e._u([{key:"action",fn:function(t,r){return a("span",{},[[r.isSpecial?e._e():a("a",{on:{click:function(t){return e.handleEdit(r)}}},[e._v("编辑")])]],2)}}])})],1)],1),a("supplier-order-edit",{ref:"createModal",attrs:{visible:e.modalVisible,loading:e.confirmLoading,model:e.modalData},on:{cancel:e.handleCancel,ok:e.handleOk}})],1)},n=[],o=a("5530"),i=(a("99af"),a("159b"),a("d3b7"),a("d81d"),a("7db0"),a("2af9")),l=a("f306"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"编辑",width:740,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:function(){e.$emit("ok")},cancel:function(){e.$emit("cancel")}}},[a("a-spin",{attrs:{spinning:e.loading}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:22,offset:1}},[a("a-descriptions",{attrs:{title:"",column:3,size:"default"}},[a("a-descriptions-item",{attrs:{label:"客户姓名"}},[e._v(e._s(e.model.customerName))]),a("a-descriptions-item",{attrs:{label:"客户电话"}},[e._v(e._s(e.model.customerPhone))]),a("a-descriptions-item",{attrs:{label:"银行名称"}},[e._v(e._s(e.model.bankName))]),a("a-descriptions-item",{attrs:{label:"省份"}},[e._v(e._s(e.model.province))]),a("a-descriptions-item",{attrs:{label:"城市"}},[e._v(e._s(e.model.city))])],1)],1)],1),a("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[a("a-form-item",{attrs:{label:"备注"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark",{initialValue:e.model.remark,rules:[{required:!1,message:"必填"}]}],expression:"['remark', { initialValue: model.remark, rules: [{ required: false, message: '必填' }] }]"}],attrs:{name:"remark","allow-clear":"","auto-size":{minRows:3,maxRows:5}}})],1),e.showOrderState?a("a-form-item",{attrs:{label:"订单状态",help:"（注意：订单状态修改后不可回退）"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["_orderState",{initialValue:e.model._orderState,rules:[{required:!0,message:"必填"}]}],expression:"['_orderState', { initialValue: model._orderState, rules: [{ required: true, message: '必填' }] }]"}]},[a("a-radio",{attrs:{value:"5",disabled:parseInt(e.orderState)>=6}},[e._v("已付款")]),a("a-radio",{attrs:{value:"8",disabled:"9"===e.orderState}},[e._v("已受理")]),a("a-radio",{attrs:{value:"9"}},[e._v("已开卡")])],1)],1):e._e()],1)],1)],1)},s=[],d=a("88bc"),u=a.n(d),m=["remark","_orderState"],f={components:{},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){return this.formLayout={labelCol:{md:{span:3},xs:{span:24}},wrapperCol:{md:{span:19},xs:{span:24}}},{form:this.$form.createForm(this),orderState:""}},computed:{showOrderState:function(){return!(this.orderState&&parseInt(this.orderState)>=10)}},created:function(){var e=this;m.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("model",(function(){e.model&&e.form.setFieldsValue(u()(e.model,m)),e.orderState=e.model._orderState}))},methods:{}},h=f,p=a("2877"),b=Object(p["a"])(h,c,s,!1,null,null,null),v=b.exports,y={5:"已付款",6:"已预约",7:"准备材料",8:"已受理",9:"已开卡",10:"已失败",11:"已退款",12:"已关闭"},g=[{title:"申请时间",dataIndex:"applicationTime",width:140},{title:"客户姓名",dataIndex:"customerName",width:120},{title:"客户电话",dataIndex:"customerPhone",width:160},{title:"地区",dataIndex:"province",width:140,customRender:function(e,t){return e===t.city?t.city:"".concat(e," ").concat(t.city)}},{title:"银行名称",dataIndex:"bankName",width:160},{title:"订单状态",dataIndex:"_orderState",width:100,customRender:function(e){return y[e]}},{title:"奖励(元)",dataIndex:"supplierAward",width:100},{title:"备注",dataIndex:"remark",width:200},{title:"操作",width:100,scopedSlots:{customRender:"action"}}],w={name:"SupplierOrder",components:{STable:i["c"],SupplierOrderEdit:v},data:function(){var e=this;return this.columns=g,{spinning:!1,modalVisible:!1,confirmLoading:!1,modalData:{},dataList:[],queryParam:{},bankData:[],bankDataLoading:!1,cityData:[],cityList:[],areaLoading:!1,applicationTimes:void 0,pickerMode:["date","date"],loadData:function(t){var a=Object.assign({},t,e.queryParam);return a.pageNum=t.pageNo,delete a.pageNo,a.bank&&(a.bankName=a.bank.label,delete a.bank),l["a"].hkcardSupplierOrders(a).then((function(e){return e.totalCount=+e.total,e.pageNo=+t.pageNo,e.data=e.list,e.data.forEach((function(e){"6"===e.orderState||"7"===e.orderState?e._orderState="8":e._orderState=e.orderState})),e})).catch((function(){}))}}},filters:{},created:function(){var e=this;this.$root.eventHub.$on("refreshView",(function(){e.$refs.table&&e.$refs.table.refresh()})),this.bankDataLoading=!0,l["a"].hkcardBankList().then((function(t){e.bankData=t.bankList.map((function(e){var t={value:e.bankId,label:e.bankName};return t}))})).finally((function(){e.bankDataLoading=!1})),this.areaLoading=!0,l["a"].hkcardAreaList().then((function(t){e.cityData=t.areaList.map((function(e){var t={value:e.province,label:e.province};return t.children=e.cityList.map((function(e){var t={value:e.city,label:e.city};return t})),t}))})).finally((function(){e.areaLoading=!1}))},mounted:function(){},beforeRouteLeave:function(e,t,a){this.$root.eventHub.$off("refreshView"),a()},computed:{tableX:function(){var e=0;return this.columns.forEach((function(t){e+=t.width})),e}},watch:{applicationTimes:function(e){e&&(this.queryParam.applicationTimeStart=e[0]?e[0].format("YYYY-MM-DD"):"",this.queryParam.applicationTimeEnd=e[1]?e[1].format("YYYY-MM-DD"):"")}},methods:{handleEdit:function(e){e&&(this.modalVisible=!0,this.modalData=Object(o["a"])({},e))},handleOk:function(){var e=this,t=this.$refs.createModal.form;this.confirmLoading=!0,t.validateFields((function(t,a){if(t)e.confirmLoading=!1;else{var r=e.modalData.orderId,n="hkcardEditSupplierOrder",i=Object(o["a"])({},a);r&&(i.orderId=r),"6"===e.modalData.orderState||"7"===e.modalData.orderState||e.modalData.orderState===i._orderState?delete i._orderState:i.orderState=i._orderState,l["a"][n](i).then((function(t){e.$message.info("操作成功"),e.handleCancel(),e.$refs.table.refresh()})).catch((function(){e.confirmLoading=!1}))}}))},handleCancel:function(){this.modalVisible=!1,this.confirmLoading=!1,this.modalData={};var e=this.$refs.createModal.form;e.resetFields()},resetQueryParams:function(){this.queryParam={},this.applicationTimes=void 0,this.$refs.table.refresh(!0)},onProvinceChange:function(e,t){t?(this.queryParam.province=e,this.cityList=this.cityData.find((function(t){return t.value===e})).children,delete this.queryParam.city):(delete this.queryParam.province,delete this.queryParam.city,this.cityList=[])},onCityChange:function(e,t){},onCitySearch:function(e,t){var a=t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0;return a},handleChange:function(e){this.applicationTimes=e},handlePanelChange:function(e,t){this.applicationTimes=e}}},k=w,S=Object(p["a"])(k,r,n,!1,null,"74005d51",null);t["default"]=S.exports},"88bc":function(e,t,a){(function(t){var a=1/0,r=9007199254740991,n="[object Arguments]",o="[object Function]",i="[object GeneratorFunction]",l="[object Symbol]",c="object"==typeof t&&t&&t.Object===Object&&t,s="object"==typeof self&&self&&self.Object===Object&&self,d=c||s||Function("return this")();function u(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function m(e,t){var a=-1,r=e?e.length:0,n=Array(r);while(++a<r)n[a]=t(e[a],a,e);return n}function f(e,t){var a=-1,r=t.length,n=e.length;while(++a<r)e[n+a]=t[a];return e}var h=Object.prototype,p=h.hasOwnProperty,b=h.toString,v=d.Symbol,y=h.propertyIsEnumerable,g=v?v.isConcatSpreadable:void 0,w=Math.max;function k(e,t,a,r,n){var o=-1,i=e.length;a||(a=L),n||(n=[]);while(++o<i){var l=e[o];t>0&&a(l)?t>1?k(l,t-1,a,r,n):f(n,l):r||(n[n.length]=l)}return n}function S(e,t){return e=Object(e),P(e,t,(function(t,a){return a in e}))}function P(e,t,a){var r=-1,n=t.length,o={};while(++r<n){var i=t[r],l=e[i];a(l,i)&&(o[i]=l)}return o}function _(e,t){return t=w(void 0===t?e.length-1:t,0),function(){var a=arguments,r=-1,n=w(a.length-t,0),o=Array(n);while(++r<n)o[r]=a[t+r];r=-1;var i=Array(t+1);while(++r<t)i[r]=a[r];return i[t]=o,u(e,this,i)}}function L(e){return C(e)||x(e)||!!(g&&e&&e[g])}function q(e){if("string"==typeof e||Y(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function x(e){return O(e)&&p.call(e,"callee")&&(!y.call(e,"callee")||b.call(e)==n)}var C=Array.isArray;function D(e){return null!=e&&j(e.length)&&!$(e)}function O(e){return N(e)&&D(e)}function $(e){var t=I(e)?b.call(e):"";return t==o||t==i}function j(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}function I(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function N(e){return!!e&&"object"==typeof e}function Y(e){return"symbol"==typeof e||N(e)&&b.call(e)==l}var M=_((function(e,t){return null==e?{}:S(e,m(k(t,1),q))}));e.exports=M}).call(this,a("c8ba"))}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c2744cd"],{"0fe9c":function(e,t,i){"use strict";i("1e0b")},"1e0b":function(e,t,i){},"265c":function(e,t,i){"use strict";i("e6cf6")},"3ce8":function(e,t,i){"use strict";i("c43b")},"46f1":function(e,t,i){e.exports=i.p+"img/clubAvatarImg.4388ac0e.png"},7147:function(e,t,i){},"730a":function(e,t,i){"use strict";i("7147")},"76ea":function(e,t,i){},"88bc":function(e,t,i){(function(t){var i=1/0,a=9007199254740991,o="[object Arguments]",r="[object Function]",n="[object GeneratorFunction]",l="[object Symbol]",s="object"==typeof t&&t&&t.Object===Object&&t,u="object"==typeof self&&self&&self.Object===Object&&self,c=s||u||Function("return this")();function d(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}function m(e,t){var i=-1,a=e?e.length:0,o=Array(a);while(++i<a)o[i]=t(e[i],i,e);return o}function p(e,t){var i=-1,a=t.length,o=e.length;while(++i<a)e[o+i]=t[i];return e}var h=Object.prototype,f=h.hasOwnProperty,v=h.toString,g=c.Symbol,b=h.propertyIsEnumerable,w=g?g.isConcatSpreadable:void 0,y=Math.max;function x(e,t,i,a,o){var r=-1,n=e.length;i||(i=T),o||(o=[]);while(++r<n){var l=e[r];t>0&&i(l)?t>1?x(l,t-1,i,a,o):p(o,l):a||(o[o.length]=l)}return o}function I(e,t){return e=Object(e),L(e,t,(function(t,i){return i in e}))}function L(e,t,i){var a=-1,o=t.length,r={};while(++a<o){var n=t[a],l=e[n];i(l,n)&&(r[n]=l)}return r}function C(e,t){return t=y(void 0===t?e.length-1:t,0),function(){var i=arguments,a=-1,o=y(i.length-t,0),r=Array(o);while(++a<o)r[a]=i[t+a];a=-1;var n=Array(t+1);while(++a<t)n[a]=i[a];return n[t]=r,d(e,this,n)}}function T(e){return S(e)||k(e)||!!(w&&e&&e[w])}function V(e){if("string"==typeof e||E(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}function k(e){return _(e)&&f.call(e,"callee")&&(!b.call(e,"callee")||v.call(e)==o)}var S=Array.isArray;function j(e){return null!=e&&q(e.length)&&!R(e)}function _(e){return N(e)&&j(e)}function R(e){var t=O(e)?v.call(e):"";return t==r||t==n}function q(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=a}function O(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function N(e){return!!e&&"object"==typeof e}function E(e){return"symbol"==typeof e||N(e)&&v.call(e)==l}var U=C((function(e,t){return null==e?{}:I(e,m(x(t,1),V))}));e.exports=U}).call(this,i("c8ba"))},"92e5":function(e,t,i){e.exports=i.p+"img/club_appid_tip.d3f955d1.jpg"},"9e15":function(e,t,i){"use strict";i("76ea")},a366:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{attrs:{title:e.title,width:500,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,destroyOnClose:!0,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:function(){return e.$emit("ok",e.modify)},cancel:function(){return e.$emit("cancel",e.modify)}}},[i("a-spin",{attrs:{spinning:e.spinning}},[i("uploader",{staticStyle:{margin:"-5px 0",padding:"0"},attrs:{visible:e.visible,exId:"",listType:"text",accept:".ppt, .pptx",fileType:"document",maxCount:5,maxSize:e.pptSize,exName:"preRoomClass/"+this.roomId,showUploadList:!1,noTime:!0},on:{uploadEvent:e.onUploadEvent}},[i("a-button",{attrs:{slot:"btn",type:"primary",icon:"upload",disabled:e.fileList.length>=5},slot:"btn"},[e._v(" 上传课件 ")])],1),i("a-table",{staticStyle:{"margin-top":"20px"},attrs:{columns:e.columns,rowKey:"uid","data-source":e.fileList,pagination:!1,showHeader:!0,locale:{emptyText:"暂无课件"}},scopedSlots:e._u([{key:"name",fn:function(t){return i("span",{},[[i("span",[e._v(e._s(e._f("ellipsis")(t)))])]],2)}},{key:"action",fn:function(t,a){return i("span",{},[[i("a",{staticStyle:{color:"#1890ff"},on:{click:function(t){return e.handlePreView(a)}}},[e._v("预览")]),i("a-divider",{attrs:{type:"vertical"}}),i("a",{staticStyle:{color:"#f12323"},on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除课件")])]],2)}}])})],1),i("a-modal",{attrs:{title:"预览",width:1e3,maskClosable:!1,visible:e.preViewVisible,destroyOnClose:!0,centered:!0,bodyStyle:{height:"600",overflowY:"auto"},footer:null},on:{cancel:function(){e.preViewVisible=!1}}},[i("pre-view",{attrs:{imgs:e.preViewImgs}})],1)],1)},o=[],r=(i("a9e3"),i("d3b7"),i("d81d"),i("b0c0"),i("99af"),i("4282")),n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("a-carousel",{ref:"carousel",attrs:{arrows:"","dots-class":"slick-dots slick-thumb","after-change":e.onChange}},[i("div",{staticClass:"custom-slick-arrow",staticStyle:{left:"10px",zIndex:"1"},attrs:{slot:"prevArrow"},slot:"prevArrow"},[i("a-icon",{attrs:{type:"left-circle"}})],1),i("div",{staticClass:"custom-slick-arrow",staticStyle:{right:"10px"},attrs:{slot:"nextArrow"},slot:"nextArrow"},[i("a-icon",{attrs:{type:"right-circle"}})],1),e._l(e.imgs,(function(e,t){return i("div",{key:t},[i("img",{attrs:{src:e}})])}))],2),i("div",{staticClass:"row-center-center"},[i("span",{staticStyle:{"margin-right":"20px"}},[e._v(e._s(e.curIndex+"/"+e.imgs.length))]),i("span",{staticStyle:{"margin-right":"10px"}},[e._v("跳转")]),i("a-input-number",{staticStyle:{width:"80%"},attrs:{size:"small",min:1,max:e.imgs.length},on:{change:e.onJumpChange,pressEnter:e.onJumpEnter}}),i("span",{staticStyle:{"margin-left":"10px"}},[e._v("页")])],1)],1)},l=[],s={props:{imgs:{type:Array,default:function(){}}},data:function(){return{curIndex:1}},methods:{getImgUrl:function(e){return this.imgs[e]},onChange:function(e){this.curIndex=e+1},onJumpChange:function(e){},onJumpEnter:function(e){var t=this.$refs["carousel"],i=e.target.value;i<1||i>this.imgs.length||t&&i&&t.goTo(i-1)}}},u=s,c=(i("0fe9c"),i("2877")),d=Object(c["a"])(u,n,l,!1,null,"65d6e6c1",null),m=d.exports,p=i("2af9"),h=[{title:"课件名称",dataIndex:"name",scopedSlots:{customRender:"name"}},{title:"操作",scopedSlots:{customRender:"action"}}],f={name:"PreRoomClass",components:{PreView:m,Uploader:p["d"]},props:{visible:{type:Boolean,required:!0},roomId:{type:Number,default:0},source:{type:Number,default:0}},data:function(){return this.columns=h,{form:this.$form.createForm(this),title:"课件管理",spinning:!1,loading:!1,fileList:[],preViewImgs:[],preViewVisible:!1,pptSize:30,modify:!1}},watch:{roomId:function(e){}},filters:{ellipsis:function(e){return e.length>20?e.substring(0,17)+"...":e}},created:function(){var e=this;this.$watch("visible",(function(t){t&&(e.modify=!1,e.fileList=[],e.roomId&&e.loadData(e.roomId))}))},mounted:function(){},methods:{loadData:function(e){var t=this,i=this.source,a="preRoomSpeechFileList";i&&(a="liveRoomCourses"),this.spinning=!0,r["a"][a]({preRoomId:e,roomId:e},i).then((function(e){var i=e.result.fileList||e.result.speechFileList;t.fileList=i.map((function(e){return{name:e.fileName,uid:e.id,status:"done",url:e.fileUrl,pageCount:e.pageCount}}))})).catch((function(e){})).finally((function(){t.spinning=!1}))},onUploadEvent:function(e){var t=e.action,i=e.err,a=e.file;"uploading"===t?this.spinning=!0:"done"===t?i&&(this.spinning=!1):"success"===t&&this.updateFileList(a.url,a.name)},updateFileList:function(e,t){var i=this;if(e){var a=this.roomId,o=this.source;this.spinning=!0,r["a"].preRoomSpeechFileUpload({preRoomId:a,roomId:a,fileOssUrl:e,srcType:"pptx"},o).then((function(e){i.modify=!0,i.loadData(i.roomId),i.$message.success("文件已上传")})).catch((function(e){})).finally((function(){i.spinning=!1}))}},handleDelete:function(e){var t=this;this.$confirm({title:"是否删除课件？",content:"删除后课件信息将无法找回。",onOk:function(){t.doDelete(e)},onCancel:function(){}})},doDelete:function(e){var t=this,i=this.roomId,a=this.source,o="adminPreRoomSpeechFileRemove";a&&(o="deleteLiveRoomCourse"),this.spinning=!0,r["a"][o]({preRoomId:i,roomId:i,fileId:e.uid}).then((function(e){t.modify=!0,t.loadData(t.roomId),t.$message.success("文件已删除")})).catch((function(e){})).finally((function(){t.spinning=!1}))},handlePreView:function(e){for(var t=this,i=[],a=1;a<=e.pageCount;a++)i.push("".concat(e.url,"/").concat(a,".png"));this.preViewImgs=i,this.$nextTick((function(){t.preViewVisible=!0}))}}},v=f,g=Object(c["a"])(v,a,o,!1,null,null,null);t["a"]=g.exports},a9a3:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("page-header-wrapper",{attrs:{title:!1}},[i("a-spin",{attrs:{spinning:e.spinning}},[i("a-card",{attrs:{bordered:!1}},[i("a-tabs",{attrs:{"default-active-key":"1"},model:{value:e.curModuleId,callback:function(t){e.curModuleId=t},expression:"curModuleId"}},e._l(e.tabList,(function(t){return i("a-tab-pane",{key:t.moduleId+"",attrs:{tab:t.name}},[1===t.moduleId?i("club-manage",{ref:"clubManage",refInFor:!0,attrs:{moduleInfo:t}}):3===t.moduleId?i("pre-room",{ref:"clubManage",refInFor:!0,attrs:{moduleInfo:t,allGroupList:e.allGroupList}}):2===t.moduleId?i("notice-manage",{attrs:{moduleInfo:t,allGroupList:e.allGroupList}}):i("normal-module",{attrs:{moduleInfo:t,allGroupList:e.allGroupList}})],1)})),1)],1)],1)],1)},o=[],r=i("2909"),n=(i("a434"),i("99af"),i("c740"),i("4de4"),i("caad"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-spin",{attrs:{spinning:e.spinning}},[i("div",{staticClass:"table-page-search-wrapper"},[i("a-row",{attrs:{type:"flex"}},[i("a-col",{attrs:{span:14}},[i("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[i("a-form-item",[i("span",{staticStyle:{"line-height":"100px"},attrs:{slot:"label"},slot:"label"},[e._v("CLUB小程序码")]),i("div",{staticClass:"row-start-center"},[i("a-spin",{staticClass:"codeImg",attrs:{spinning:e.clubQRSpinning}},[i("img",{staticClass:"codeImg",attrs:{src:e.clubQR,alt:""}})]),e.clubQR?i("a-tooltip",{attrs:{title:"使用微信扫码打开小程序"}},[i("a",{ref:"downloadQR",staticStyle:{"margin-left":"20px",color:"#1890FF"},on:{click:e.downloadQR}},[e._v("下载Club小程序码")])]):e._e()],1)]),i("a-form-item",{attrs:{label:"CLUB名称"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['name', { rules:[{required:true, whitespace:true, message:'必填'}] }]"}],attrs:{"allow-clear":"",maxLength:15,placeholder:"给CLUB起个名字"}})],1),i("a-form-item",{attrs:{label:"头部信息展示"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["headerLayout",{initialValue:0,rules:[{required:!0,message:"必选"}]}],expression:"['headerLayout', { initialValue:0, rules:[{required:true, message:'必选'}]}]"}]},[i("a-radio",{attrs:{value:0}},[e._v("标准")]),i("a-radio",{attrs:{value:1}},[e._v("只展示背景图")]),i("a-radio",{attrs:{value:2}},[e._v("不展示成员数量")])],1)],1),i("a-form-item",{attrs:{label:"CLUB主理人介绍"}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["ownerIntro",{rules:[{required:!1,whitespace:!0,message:"必填"}]}],expression:"['ownerIntro', { rules: [{ required: false, whitespace:true, message: '必填' }] }]"}],attrs:{name:"ownerIntro","allow-clear":"",maxLength:500,"auto-size":{minRows:3,maxRows:5},placeholder:"请输入CLUB主理人介绍"},on:{change:function(t){e.handleInputArea(t,"ownerIntro","curIntroLength",500)}}}),i("span",{staticStyle:{float:"right","line-height":"0px"}},[e._v(e._s(e.curIntroLength+"/500"))])],1),i("a-form-item",{attrs:{label:"CLUB简介"}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["clubIntro",{rules:[{required:!1,whitespace:!0,message:"必填"}]}],expression:"['clubIntro', { rules: [{ required: false, whitespace:true, message: '必填' }] }]"}],attrs:{name:"clubIntro","allow-clear":"",maxLength:500,"auto-size":{minRows:3,maxRows:5},placeholder:"请输入CLUB简介"},on:{change:function(t){e.handleInputArea(t,"clubIntro","curClubIntroLength",500)}}}),i("span",{staticStyle:{float:"right","line-height":"0px"}},[e._v(e._s(e.curClubIntroLength+"/500"))])],1),i("a-form-item",{attrs:{label:"管理员微信二维码",required:!1}},[i("a-row",{attrs:{type:"flex",align:"middle",justify:"start"}},[i("div",{style:{display:"flex","align-items":"center"}},[i("a-upload",{style:{width:"110px",height:"110px"},attrs:{name:"adminCard",accept:".jpg,.jpeg,.gif,.png","list-type":"picture-card",showUploadList:!1,beforeUpload:e.beforeUpload_card}},[e.adminCard?i("a-spin",{attrs:{spinning:e.adminCardSpinning}},[i("img",{style:{width:"80px",height:"80px",cursor:"pointer"},attrs:{src:e.adminCard,alt:"card"},on:{load:function(){return e.adminCardSpinning=!1}}})]):i("div",[i("a-icon",{attrs:{type:"plus"}}),i("div",{style:{"margin-top":"10px",color:"#666"}},[e._v("上传名片")])],1)],1),i("div",{style:{height:"50px","line-height":"20px"}},[i("a-icon",{attrs:{type:"info-circle"}}),e._v(" 建议图片尺寸为180x180像素，支持：JPG,JPEG,GIF,PNG图片文件,且文件小于5M ")],1)],1)])],1),i("a-form-item",{attrs:{label:"CLUB管理员手机号"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["adminMobile",{rules:[{required:!1,whitespace:!0,message:"必填"},{pattern:e.regMobile,message:"请输入11位手机号"}]}],expression:"['adminMobile', { rules:[{required:false,whitespace:true,message:'必填'},{pattern:regMobile,message:'请输入11位手机号'}] }]"},{name:"input",rawName:"v-input:number",arg:"number"}],attrs:{"allow-clear":"",type:"tel",maxLength:11,placeholder:"请输入手机号"}})],1),i("a-form-item",{attrs:{label:"公众号AppID",help:"公众号管理后台-开发-基本配置中可以找到"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["wxGzhAppId",{rules:[{required:!1,whitespace:!0,message:"必填"}]}],expression:"['wxGzhAppId', { rules:[{required:false, whitespace:true, message:'必填'}] }]"}],attrs:{"allow-clear":"",maxLength:30,placeholder:"AppID用于消息推送功能"}},[i("span",{attrs:{slot:"addonAfter"},slot:"addonAfter"},[i("a-button",{attrs:{icon:"info-circle"},on:{click:e.handleShowAppIdTip}})],1)])],1),i("a-form-item",{staticStyle:{"margin-top":"16px"},attrs:{label:"引导用户关注的文章",help:"公众号文章，用于引导用户关注公众号"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["gzhFollowUrl",{rules:[{required:!1,whitespace:!0,message:"必填"}]}],expression:"['gzhFollowUrl', { rules: [{ required: false, whitespace: true, message:'必填' }] }]"}],attrs:{"allow-clear":"",placeholder:"请输入文章地址"}})],1),i("a-form-item",{staticStyle:{"margin-top":"16px"},attrs:{label:"俱乐部口令"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["shareCode",{rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['shareCode', { rules: [{ required: true, whitespace: true, message:'必填' }] }]"}],attrs:{"allow-clear":"",placeholder:"用户首次进入CLUB需要输入俱乐部口令"}})],1)],1)],1),i("a-col",{attrs:{span:10,display:"flex",align:"top",justify:"center"}},[i("a-row",{attrs:{type:"flex",justify:"center"}},[i("a-upload",{style:{border:"none"},attrs:{multiple:!1,accept:".jpg,.jpeg,.gif,.png",name:"file",listType:"picture",showUploadList:!1,"before-upload":e.beforeUpload_avatar,remove:e.removeHeadImg}},[i("a-spin",{attrs:{spinning:e.ownUserAvatarSpinning}},[i("img",{style:{"margin-bottom":"20px",width:"110px",height:"110px",cursor:"pointer"},attrs:{src:e.ownUserAvatar,alt:""},on:{load:function(){return e.ownUserAvatarSpinning=!1}}})]),i("div",[i("a-button",[i("a-icon",{attrs:{type:"upload"}}),e._v("上传头像")],1)],1)],1)],1),i("a-row",{attrs:{type:"flex",justify:"center"}},[i("div",{style:{width:"200px","margin-top":"10px"}},[i("span",[i("a-icon",{attrs:{type:"info-circle"}}),e._v(" 建议图片尺寸为120x120像素，支持：JPG,JPEG,GIF,PNG图片文件，且文件小于5M")],1)])]),i("a-row",{style:{"margin-top":"30px"},attrs:{type:"flex",justify:"center"}},[i("a-upload",{style:{border:"none"},attrs:{multiple:!1,accept:".jpg,.gif,.png",name:"file",listType:"picture",showUploadList:!1,"before-upload":e.beforeUpload_bg,remove:e.removeHeadImg}},[i("a-spin",{attrs:{spinning:e.bgImgSpinning}},[i("img",{style:{"margin-bottom":"20px",width:"375px",cursor:"pointer"},attrs:{src:e.bgImg,alt:""},on:{load:function(){return e.bgImgSpinning=!1}}})]),i("div",{style:{width:"375px",display:"flex","justify-content":"center"}},[i("a-button",[i("a-icon",{attrs:{type:"upload"}}),e._v("上传背景图")],1)],1)],1)],1),i("a-row",{attrs:{type:"flex",justify:"center"}},[i("div",{style:{width:"240px","margin-top":"10px"}},[i("span",[i("a-icon",{attrs:{type:"info-circle"}}),e._v(" 建议图片尺寸为750x760像素，支持：JPG,GIF,PNG图片文件，且文件小于5M")],1)])])],1)],1)],1),i("div",{staticClass:"table-operator"},[i("a-row",{attrs:{type:"flex",justify:"center"}},[i("a-button",{attrs:{type:"primary",icon:"setting"},on:{click:function(t){return e.handleUpdate()}}},[e._v("更新")])],1)],1),e.showCropper?i("cropper",{attrs:{opts:e.cropperOpts},on:{cancel:e.cropperCancel,ok:e.cropperOk}}):e._e(),i("a-modal",{attrs:{visible:e.previewVisible,width:765,footer:null},on:{cancel:e.handlePreviewCancel}},[i("img",{staticStyle:{width:"100%"},attrs:{src:e.previewImage,alt:""}})])],1)}),l=[],s=i("5530"),u=i("ade3"),c=(i("159b"),i("b64b"),i("d3b7"),i("ac1f"),i("5319"),i("3ca3"),i("ddb0"),i("2b3d"),i("b0c0"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{attrs:{title:"裁剪",width:740,maskClosable:!1,visible:e.visible,destroyOnClose:!0,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:e.handleOk,cancel:function(){e.$emit("cancel")}}},[i("div",{staticClass:"cropper-content"},[i("div",{staticClass:"cropper",staticStyle:{"text-align":"center"}},[i("vue-cropper",{ref:"cropper",attrs:{img:e.option.img,outputSize:e.option.size,outputType:e.option.outputType,info:e.option.info,full:e.option.full,canMove:e.option.canMove,canMoveBox:e.option.canMoveBox,original:e.option.original,autoCrop:e.option.autoCrop,fixed:e.option.fixed,fixedNumber:e.option.fixedNumber,centerBox:e.option.centerBox,infoTrue:e.option.infoTrue,fixedBox:e.option.fixedBox}})],1)])])}),d=[],m=i("7e79"),p={components:{VueCropper:m["VueCropper"]},props:{visible:{type:Boolean,default:!0},opts:{type:Object,default:function(){}}},data:function(){return{option:{img:"",info:!0,outputSize:1,outputType:"png",canScale:!0,autoCrop:!0,fixedBox:!1,fixed:!0,fixedNumber:[1,1],full:!0,canMoveBox:!0,original:!1,centerBox:!0,infoTrue:!0}}},watch:{opts:function(e){}},mounted:function(){var e=this;Object.keys(this.opts).forEach((function(t){e.option[t]=e.opts[t]}))},methods:{handleOk:function(){var e=this;this.$refs.cropper.getCropBlob((function(t){e.$emit("ok",t)}))}}},h=p,f=(i("9e15"),i("2877")),v=Object(f["a"])(h,c,d,!1,null,"15e94be5",null),g=v.exports,b=i("7858"),w=i("4282"),y=i("f306"),x=i("ca00"),I=i("88bc"),L=i.n(I),C=i("484f"),T=["name","headerLayout","ownerIntro","clubIntro","adminMobile","wxGzhAppId","gzhFollowUrl","shareCode"],V=["ownUserAvatar","bgImg","adminCard"],k=i("46f1"),S=i("c9061"),j={name:"ClubManage",components:{Cropper:g},data:function(){return this.formLayout={labelCol:{md:{span:6},xs:{span:24}},wrapperCol:{md:{span:16},xs:{span:24}}},{spinning:!1,ownUserAvatarSpinning:!1,bgImgSpinning:!1,adminCardSpinning:!1,form:this.$form.createForm(this),svrClubInfo:{},showCropper:!1,cropperOpts:{},ownUserAvatar:k,bgImg:S,adminCard:"",curIntroLength:0,curClubIntroLength:0,regMobile:C["a"].mobile,previewVisible:!1,previewImage:"",clubQR:"",clubQRSpinning:!1}},created:function(){var e=this;T.forEach((function(t){return e.form.getFieldDecorator(t)}))},watch:{svrClubInfo:function(e){var t=this;if(e){this.form.setFieldsValue(L()(e,T));var i=L()(e,V);Object.keys(i).forEach((function(e){t[e]!==i[e]&&i[e]&&(t[e]=i[e],t["".concat(e,"Spinning")]=!0)})),this.curIntroLength=e.ownerIntro?e.ownerIntro.length:0,this.curClubIntroLength=e.clubIntro?e.clubIntro.length:0}}},mounted:function(){var e=this;this.spinning=!0,w["a"].clubInfo({}).then((function(t){e.svrClubInfo=t.result,e.loadMpCode()})).finally((function(){e.spinning=!1}))},methods:{handleInputArea:function(e,t,i,a){var o=this;if(this[i]=e.target.value.length,e.target.value.length>a){var r=e.target.value.substr(0,a);this.$nextTick((function(){o.form.setFieldsValue(Object(u["a"])({},t,r))})),this[i]=a}else this[i]=e.target.value.length},beforeLeave:function(e){var t=e.callback,i=e.callbackCancel,a=this.noEdit,o=this.handleUpdate;a()?i():this.$confirm({title:"确认要更新CLUB信息吗？",content:"更新后会同步修改小程序的显示内容",onOk:function(){o(!0),t()},onCancel:function(){i()}})},noEdit:function(){var e=this.svrClubInfo,t=this.form,i=!0;this.ownUserAvatar!==k&&this.ownUserAvatar!==e.ownUserAvatar&&(i=!1),this.bgImg!==S&&this.bgImg!==e.bgImg&&(i=!1),this.adminCard&&this.adminCard!==e.adminCard&&(i=!1);var a=t.getFieldsValue(T);return Object.keys(a).forEach((function(t){(a[t]&&a[t]!==e[t]||!a[t]&&e[t])&&(i=!1)})),i},checkUpdate:function(){var e=this;return new Promise((function(t,i){var a=e.form;a.validateFields((function(a,o){if(a)i(new Error("empty"));else{var r=Object(s["a"])({},o);if(!e.ownUserAvatar||e.ownUserAvatar===k)return e.$message.info("请上传头像"),void i(new Error("avatar"));r.ownUserAvatar=e.ownUserAvatar,e.bgImg&&e.bgImg!==S?r.bgImg=e.bgImg:(e.$message.info("请上传背景图"),i(new Error("bg"))),e.adminCard&&(r.adminCard=e.adminCard),t(r)}}))}))},handleUpdate:function(e){var t=this,i=this.doUpdate,a=this.noEdit;a()?this.$message.warn("您未修改任何信息。"):this.checkUpdate().then((function(a){e?i(a,e):t.$confirm({title:"确认要更新CLUB信息吗？",content:"更新后会同步修改小程序的显示内容",onOk:function(){i(a)},onCancel:function(){}})})).catch((function(e){}))},doUpdate:function(e,t){var i=this;w["a"].updateClub({clubInfo:e}).then((function(a){i.svrClubInfo=e,i.$message.success("CLUB信息已更新"),t&&i.$router.replace("/redirect/ta/content")}))},checkImg:function(e){var t=e.size/1024/1024<5;return!!t||(this.$message.error("上传文件大小不能超过 5MB～"),!1)},beforeUpload_avatar:function(e){var t=this;if(this.checkImg(e)){var i=URL.createObjectURL(e);this.cropperOpts={from:"avatar",img:i,autoCropWidth:120,autoCropHeight:120,fixedNumber:[120,120]},this.$nextTick((function(){t.showCropper=!0}))}},beforeUpload_bg:function(e){var t=this;if(this.checkImg(e)){var i=URL.createObjectURL(e);this.cropperOpts={from:"bg",img:i,autoCropWidth:375,autoCropHeight:380,fixedNumber:[750,760]},this.$nextTick((function(){t.showCropper=!0}))}},beforeUpload_card:function(e){var t=this;if(this.checkImg(e)){var i=URL.createObjectURL(e);this.cropperOpts={from:"card",img:i,autoCropWidth:180,autoCropHeight:180,fixedNumber:[180,180]},this.$nextTick((function(){t.showCropper=!0}))}},removeHeadImg:function(){},cropperCancel:function(){this.cropperOpts={},this.showCropper=!1},cropperOk:function(e){var t,i,a,o,r=this,n=this.$store.state.ta;switch(this.cropperOpts.from){case"avatar":t="club_avatar.png",i="ownUserAvatar",a="ownUserAvatarSpinning";break;case"bg":t="club_bg.png",i="bgImg",a="bgImgSpinning",o="";break;case"card":t="admin_card.png",i="adminCard",a="adminCardSpinning";break;default:o="";break}var l=new File([e],t,{type:e.type});this.spinning=!0,Object(b["a"])(l,{key:"taqf/club/".concat(n.clubId,"/").concat(t),maxW:o,appId:"weClub"}).then((function(e){r[i]=e.url,r[a]=!0})).catch((function(e){})).finally((function(){r.spinning=!1})),this.cropperCancel()},handleShowAppIdTip:function(){this.previewImage=i("92e5"),this.previewVisible=!0},handlePreviewCancel:function(){this.previewVisible=!1},loadMpCode:function(){var e=this,t=this.$store.state.ta;if(t.clubId)if(window.clubQr)this.clubQR=window.clubQr;else{var i="pages/home/home",a="".concat(t.clubId);this.clubQRSpinning=!0,y["a"].getMpCode({page:i,scene:encodeURIComponent(a),width:200}).then((function(t){e.clubQR="data:image/png;base64,"+t.buffer,window.clubQr=e.clubQR})).catch((function(e){})).finally((function(){e.clubQRSpinning=!1}))}},downloadQR:function(e,t){var i=Object(x["b"])(this.clubQR),a=i.blob,o=i.url;if(window.ClipboardItem&&t)navigator.clipboard.write([new window.ClipboardItem(Object(u["a"])({},a.type,a))]),this.$message.success("Club小程序码已复制");else{var r=this.$refs["downloadQR"],n=this.$store.getters,l=n.name,s=n.taClubName,c=n.otherUserName,d=l||s||c;r.download="Club小程序码-".concat(d,".png"),r.href=o}}}},_=j,R=(i("3ce8"),Object(f["a"])(_,n,l,!1,null,"b213c980",null)),q=R.exports,O=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-spin",{attrs:{spinning:e.spinning}},[i("div",{staticClass:"table-operator"},[i("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.handleAdd()}}},[e._v("添加")]),i("a-button",{attrs:{type:"primary",icon:"delete",disabled:0===e.selectedRowKeys.length},on:{click:function(t){return e.handleDelete()}}},[e._v("批量删除")])],1),i("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",columns:e.columns,data:e.loadData,alert:!1,scroll:{x:e.tableX},rowSelection:e.rowSelection,showPagination:"auto"},scopedSlots:e._u([{key:"available",fn:function(t,a,o){return i("span",{},[i("a-switch",{attrs:{loading:o===e.switchIndex,checked:e._f("available")(a)},on:{change:function(i){return e.onStatusChange(i,t,a,o,"isActive")}}})],1)}},{key:"normal",fn:function(t,a){return i("span",{},[[i("a",{style:{color:"#1890ff"},on:{click:function(t){return e.handleEdit(a)}}},[e._v("编辑")]),i("a-divider",{attrs:{type:"vertical"}}),i("a",{staticStyle:{color:"#f12323"},on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除")])]],2)}}])}),i("notice-edit",{ref:"editModal",attrs:{visible:e.modalVisible,loading:e.confirmLoading,model:e.modelData},on:{cancel:e.handleEditCancel,ok:e.handleEditOk}})],1)},N=[],E=i("1da1"),U=(i("96cf"),i("d81d"),i("a15b"),i("2af9")),M=(i("7db0"),i("c1df")),D=i.n(M),$={10:[{title:"顺序编号",dataIndex:"sortValue",ellipsis:!0},{title:"模块名称",dataIndex:"contentMap.showname",ellipsis:!0},{title:"图标",dataIndex:"contentMap.icon",scopedSlots:{customRender:"avatar"},ellipsis:!0},{title:"可用范围",dataIndex:"unlockedGroupList",customRender:P,ellipsis:!0},{title:"开放状态",dataIndex:"isOpened",customRender:H,ellipsis:!0},{title:"操作",scopedSlots:{customRender:"normal"},ellipsis:!0}],100:[{title:"顺序编号",dataIndex:"sortValue",ellipsis:!0},{title:"房间主题",dataIndex:"roomName",ellipsis:!0},{title:"创建时间",dataIndex:"createTime",customRender:A,ellipsis:!0},{title:"上架状态",dataIndex:"isActive",scopedSlots:{customRender:"available"},ellipsis:!0},{title:"操作",scopedSlots:{customRender:"replay"},ellipsis:!0}],200:[{title:"标题",dataIndex:"contentMap.intro",ellipsis:!0},{title:"创建时间",dataIndex:"createTime",customRender:function(e){return e||"-"},width:120},{title:"可见范围",dataIndex:"groupList",customRender:P,ellipsis:!0},{title:"可用范围",dataIndex:"unlockedGroupList",customRender:P,ellipsis:!0},{title:"推送方式",dataIndex:"pushType",customRender:Y,width:96},{title:"推送时间",dataIndex:"pushTime",customRender:B,width:120},{title:"上架状态",dataIndex:"isActive",scopedSlots:{customRender:"available"},ellipsis:!0},{title:"置顶状态",dataIndex:"isTop",scopedSlots:{customRender:"available"},ellipsis:!0},{title:"操作",dataIndex:"btn",scopedSlots:{customRender:"normal"},width:176,ellipsis:!0}],300:[{title:"顺序编号",dataIndex:"sortValue",ellipsis:!0},{title:"课程名称",dataIndex:"contentMap.title",ellipsis:!0},{title:"创建时间",dataIndex:"createTime",customRender:A,ellipsis:!0},{title:"可见范围",dataIndex:"groupList",customRender:P,ellipsis:!0},{title:"可用范围",dataIndex:"unlockedGroupList",customRender:P,ellipsis:!0},{title:"上架状态",dataIndex:"isActive",scopedSlots:{customRender:"available"},ellipsis:!0},{title:"操作",scopedSlots:{customRender:"setTop"},width:260,ellipsis:!0}],400:[{title:"顺序编号",dataIndex:"sortValue",ellipsis:!0},{title:"产品名称",dataIndex:"contentMap.title",ellipsis:!0},{title:"创建时间",dataIndex:"createTime",customRender:A,ellipsis:!0},{title:"可见范围",dataIndex:"groupList",customRender:P,ellipsis:!0},{title:"可用范围",dataIndex:"unlockedGroupList",customRender:P,ellipsis:!0},{title:"上架状态",dataIndex:"isActive",scopedSlots:{customRender:"available"},ellipsis:!0},{title:"操作",scopedSlots:{customRender:"setTop"},width:260,ellipsis:!0}],500:[{title:"顺序编号",dataIndex:"sortValue",ellipsis:!0},{title:"资讯标题",dataIndex:"contentMap.title",ellipsis:!0},{title:"创建时间",dataIndex:"createTime",customRender:A,ellipsis:!0},{title:"可见范围",dataIndex:"groupList",customRender:P,ellipsis:!0},{title:"可用范围",dataIndex:"unlockedGroupList",customRender:P,ellipsis:!0},{title:"上架状态",dataIndex:"isActive",scopedSlots:{customRender:"available"},ellipsis:!0},{title:"操作",scopedSlots:{customRender:"setTop"},width:260,ellipsis:!0}],600:[{title:"顺序编号",dataIndex:"sortValue",ellipsis:!0},{title:"资讯标题",dataIndex:"contentMap.title",ellipsis:!0},{title:"创建时间",dataIndex:"createTime",customRender:A,ellipsis:!0},{title:"可见范围",dataIndex:"groupList",customRender:P,ellipsis:!0},{title:"可用范围",dataIndex:"unlockedGroupList",customRender:P,ellipsis:!0},{title:"上架状态",dataIndex:"isActive",scopedSlots:{customRender:"available"},ellipsis:!0},{title:"操作",scopedSlots:{customRender:"normal"},width:260,ellipsis:!0}],notice:function(e){return[{title:"顺序编号",dataIndex:"sortValue",ellipsis:!0},{title:"公告标题",dataIndex:"title",ellipsis:!0},{title:"创建时间",dataIndex:"createTime",customRender:A,ellipsis:!0},{title:"权限范围",dataIndex:"groups",customRender:function(t){return F(t,e)},ellipsis:!0},{title:"上架状态",dataIndex:"isActive",scopedSlots:{customRender:"available"},ellipsis:!0},{title:"操作",scopedSlots:{customRender:"normal"},ellipsis:!0}]},preRoom:[{title:"顺序编号",width:90,dataIndex:"sortValue",ellipsis:!0},{title:"房间主题",dataIndex:"name",ellipsis:!0},{title:"主播",width:160,dataIndex:"anchor",customRender:function(e,t){return z(e,t)},ellipsis:!0},{title:"主播手机号",width:120,dataIndex:"anchor.mobile",customRender:function(e){return e||"-"},ellipsis:!0},{title:"直播间二维码",width:120,dataIndex:"prePageUrl",scopedSlots:{customRender:"bannerImg"}},{title:"预约房海报",width:110,dataIndex:"bannerImg",scopedSlots:{customRender:"bannerImg"}},{title:"分享图片",width:90,dataIndex:"shareImg",scopedSlots:{customRender:"bannerImg"}},{title:"开播时间",width:110,dataIndex:"playTime",ellipsis:!1},{title:"预约人数",width:90,dataIndex:"reservedNum",ellipsis:!0},{title:"操作",width:270,scopedSlots:{customRender:"normal"},ellipsis:!0}]};function A(e){return e?D()(e,"YYYY-MM-DD HH:mm:ss").format("YYYY-MM-DD"):"-"}var G=-1;function P(e){if(!e||!e.length)return"-";var t=e.filter((function(e){return e.id===G}));return t.length?t[0].name:(t=e.map((function(e){return e.name})),t.join(" | "))}function F(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=e.filter((function(e){return e===G}));return i.length?t.find((function(e){return e.id===G})).name:(i=[],e.forEach((function(e){var a=t.find((function(t){return t.id===e}));a&&i.push(a.name)})),i.length?i.join(" | "):"-")}function z(e,t){var i="-";return e&&e.nickname&&(i=e.nickname),t.isRelay&&(i="【转播】"+i),i}function H(e){var t="未设置";return 0===e?t="未开放":1===e&&(t="开放"),t}function Y(e,t,i,a){var o="-";return e?(e.forEach((function(t,i){10===t?e[i]="微信推送":20===t&&(e[i]="短信推送")})),o=e.join("\r\n")):0===t.isPushed&&(o="不推送"),o}function B(e,t,i,a){var o="-";return t.isPushed?o="已推送":e&&t.pushType&&(o=e),o}function J(e){var t;switch(e){case 100:t="回放";break;case 200:t="策略";break;case 300:t="课程";break;case 400:t="产品";break;case 500:t="资讯";break;case 2:t="公告";break;case 3:t="预约房";break;default:t="数据"}return{title:"确定要删除".concat(t),content:"删除之后该".concat(t,"将无法恢复。")}}var X={200:["intro","details"],300:["coverImg","title","intro","jumpUrl","listIntro","listCoverImg"],400:["coverImg","title","intro","jumpUrl"],500:["coverImg","title","intro","jumpType","jumpUrl","details"],600:["coverImg","title","intro","jumpType","jumpUrl","teamId"],2:["title","intro"]},W="https://ta.szxiaoxinxin.com/weClubAD/index.html";function K(){var e={200:{jumpType:"0",jumpUrl:"",layoutType:"7"},10500:{jumpType:"1",jumpUrl:"financial",layoutType:"3"},10400:{jumpType:"1",jumpUrl:"newStock",layoutType:"3"},10200:{jumpType:"1",jumpUrl:"bondPool",layoutType:"3"},10100:{jumpType:"1",jumpUrl:"fundDoctor",layoutType:"3"},10800:{jumpType:"1",jumpUrl:"stock",layoutType:"3"},10600:{jumpType:"1",jumpUrl:"gridStrategy",layoutType:"3"},10700:{jumpType:"4",jumpUrl:"",layoutType:"3"},10900:{jumpType:"1",jumpUrl:"etfCy",layoutType:"3"},11e3:{jumpType:"1",jumpUrl:"arbitrage",layoutType:"3"}};return e["10700"].jumpUrl="https://ta.szxiaoxinxin.com/weClubInsurance/index.html?t=1",e}var Q=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{attrs:{title:e.title,width:740,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:e.onOk,cancel:e.onCancel}},[i("a-spin",{attrs:{spinning:e.spinning}},[i("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[i("uploader",{attrs:{visible:e.visible,form:e.form,label:"课程封面",exId:"coverImg",listType:"picture-card",accept:".jpg, .png, .gif",comCSS:{width:"163px","max-height":"193px","margin-bottom":"-16px"},imgCSS:{"max-width":"163px","max-height":"193px"},btnCSS:{width:"163px",height:"90px"},maxCount:1,fileType:"image",required:!0,"url-list":[e.model.coverImg],exName:"class",exTip:""},on:{uploadEvent:e.onUploadEvent}}),i("a-form-item",{attrs:{label:"课程名称"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{initialValue:e.model.title,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['title', { initialValue: model.title, rules:[{required:true,whitespace:true,message:'必填'}]}]"}],ref:"title",attrs:{"allow-clear":"",maxLength:20,placeholder:"请输入"}})],1),i("a-form-item",{attrs:{label:"课程简介"}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["intro",{initialValue:e.model.intro,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['intro', { initialValue: model.intro, rules: [{ required: true, whitespace:true, message: '必填' }] }]"}],attrs:{name:"intro","allow-clear":"","auto-size":{minRows:1,maxRows:3},placeholder:"请输入"},on:{change:function(t){e.handleInputArea(t,"intro","curIntroLength",50)}}}),i("span",{staticStyle:{float:"right","line-height":"0px"}},[e._v(e._s(e.curIntroLength+"/50"))])],1),i("groups-selecter",{attrs:{form:e.form,model:e.model}}),i("a-form-item",{staticStyle:{display:"none"},attrs:{label:"课程链接"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["jumpUrl",{initialValue:e.model.jumpUrl,rules:[{required:!1,whitespace:!0,message:"必填"}]}],expression:"['jumpUrl', { initialValue: model.jumpUrl, rules:[{required:false,whitespace:true,message:'必填'}]}]"}],attrs:{"allow-clear":"",placeholder:"请输入"}})],1),i("a-form-item",{attrs:{label:"设为推荐课程"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isTop",{initialValue:e.model.isTop||0,rules:[{required:!0,message:"必选"}]}],expression:"['isTop', { initialValue: model.isTop || 0, rules: [{ required: true, message: '必选' }] }]"}]},[i("a-radio",{attrs:{value:1}},[e._v("是")]),i("a-radio",{attrs:{value:0}},[e._v("否")])],1)],1),i("a-form-item",{attrs:{label:"是否上架"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isActive",{initialValue:e.model.isActive||0,rules:[{required:!0,message:"必选"}]}],expression:"['isActive', { initialValue: model.isActive || 0, rules: [{ required: true, message: '必选' }] }]"}],attrs:{disabled:!e.model.id}},[i("a-radio",{attrs:{value:1}},[e._v("是")]),i("a-radio",{attrs:{value:0}},[e._v("否")])],1)],1),i("a-form-item",{attrs:{label:"顺序编号"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["sortValue",{initialValue:e.model.sortValue+"",rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['sortValue', { initialValue: model.sortValue + '', rules:[{required:true,whitespace:true,message:'必填'}]}]"},{name:"input",rawName:"v-input:number",arg:"number"}],attrs:{"allow-clear":"",placeholder:"请输入","max-length":5}})],1),i("uploader",{attrs:{visible:e.visible,form:e.form,label:"列表页面背景图",exId:"listCoverImg",listType:"picture-card",accept:".jpg, .png, .gif",comCSS:{width:"163px","max-height":"193px","margin-bottom":"6px"},imgCSS:{"max-width":"163px","max-height":"193px"},btnCSS:{width:"163px",height:"90px"},maxCount:1,fileType:"image",required:!1,"url-list":[e.model.listCoverImg],exName:"class",exTip:""},on:{uploadEvent:e.onUploadEvent}}),i("rich-editor",{ref:"editor",attrs:{visible:e.visible,form:e.form,label:"列表页面简介",exId:"listIntro",options:{},contents:e.model.listIntro}})],1)],1)],1)},Z=[],ee=["title","intro","groupList","jumpUrl","isTop","isActive","sortValue"],te={name:"ClassEdit",components:{Uploader:U["d"],RichEditor:U["b"],GroupsSelecter:U["a"]},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){return this.formLayout={labelCol:{md:{span:4},xs:{span:24}},wrapperCol:{md:{span:19},xs:{span:24}}},{form:this.$form.createForm(this),spinning:!1,editType:0,title:"添加",curIntroLength:0}},created:function(){var e=this;ee.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("visible",(function(t,i){t&&(e.model&&e.form.setFieldsValue(L()(e.model,ee)),e.curIntroLength=0,"undefined"!==typeof e.model.id?(e.editType=1,e.title="修改课程",e.model.intro&&(e.curIntroLength=e.model.intro.length)):(e.editType=0,e.title="新增课程"),e.$nextTick((function(){e.$refs.title.focus()})))}))},methods:{handleInputArea:function(e,t,i,a){var o=this;if(this[i]=e.target.value.length,e.target.value.length>a){var r=e.target.value.substr(0,a);this.$nextTick((function(){o.form.setFieldsValue(Object(u["a"])({},t,r))})),this[i]=a}else this[i]=e.target.value.length},onUploadEvent:function(e){"uploading"===e.action?this.spinning=!0:this.spinning=!1},onCancel:function(){this.$emit("cancel")},onOk:function(){this.$emit("ok",{})}}},ie=te,ae=Object(f["a"])(ie,Q,Z,!1,null,null,null),oe=ae.exports,re=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{attrs:{title:e.title,width:740,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:e.onOk,cancel:e.onCancel}},[i("a-spin",{attrs:{spinning:e.spinning}},[i("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[i("uploader",{attrs:{visible:e.visible,form:e.form,label:"资讯封面",exId:"coverImg",listType:"picture-card",accept:".jpg, .png, .gif",comCSS:{width:"211px",height:"90px","margin-bottom":"6px"},imgCSS:{width:"211px",height:"90px"},btnCSS:{width:"211px",height:"90px"},maxCount:1,fileType:"image",required:!0,"url-list":[e.model.coverImg],exName:"information",exTip:"建议资讯封面尺寸为240x102像素"},on:{uploadEvent:e.onUploadEvent}}),i("a-form-item",{attrs:{label:"资讯标题"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{initialValue:e.model.title,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['title', { initialValue: model.title, rules:[{required:true,whitespace:true,message:'必填'}]}]"}],attrs:{"allow-clear":"",maxLength:20,placeholder:"请输入"}})],1),i("a-form-item",{attrs:{label:"资讯简介"}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["intro",{initialValue:e.model.intro,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['intro', { initialValue: model.intro, rules: [{ required: true, whitespace:true, message: '必填' }] }]"}],attrs:{name:"intro","allow-clear":"",maxLength:50,"auto-size":{minRows:1,maxRows:3},placeholder:"请输入"},on:{change:function(t){e.handleInputArea(t,"intro","curIntroLength",50)}}}),i("span",{staticStyle:{float:"right","line-height":"0px"}},[e._v(e._s(e.curIntroLength+"/50"))])],1),i("groups-selecter",{attrs:{form:e.form,model:e.model}}),i("a-form-item",{attrs:{label:"资讯内容"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["jumpType",{initialValue:e.model.jumpType||"2",rules:[{required:!0,message:"必选"}]}],expression:"['jumpType', { initialValue: model.jumpType || '2', rules: [{ required: true, message: '必选' }] }]"}],on:{change:e.changeJumpType}},[i("a-radio",{attrs:{value:"2"}},[e._v("引用公众号文章")]),i("a-radio",{attrs:{value:"1"}},[e._v("新增图文")])],1)],1),2==e.jumpType?i("a-form-item",{attrs:{label:"资讯链接"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["jumpUrl",{initialValue:e.model.jumpUrl,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['jumpUrl', { initialValue: model.jumpUrl, rules:[{required:true,whitespace:true,message:'必填'}]}]"}],attrs:{"allow-clear":"",placeholder:"请输入"}})],1):e._e(),i("rich-editor",{directives:[{name:"show",rawName:"v-show",value:1==e.jumpType,expression:"jumpType==1"}],ref:"editor",attrs:{visible:e.visible,form:e.form,label:"资讯详情",exId:"details",required:1==e.jumpType,options:{},contents:e.model.details}}),i("a-form-item",{attrs:{label:"设为推荐产品"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isTop",{initialValue:e.model.isTop||0,rules:[{required:!0,message:"必选"}]}],expression:"['isTop', { initialValue: model.isTop || 0, rules: [{ required: true, message: '必选' }] }]"}]},[i("a-radio",{attrs:{value:1}},[e._v("是")]),i("a-radio",{attrs:{value:0}},[e._v("否")])],1)],1),i("a-form-item",{attrs:{label:"是否上架"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isActive",{initialValue:e.model.isActive||1,rules:[{required:!0,message:"必选"}]}],expression:"['isActive', { initialValue: model.isActive || 1, rules: [{ required: true, message: '必选' }] }]"}]},[i("a-radio",{attrs:{value:1}},[e._v("是")]),i("a-radio",{attrs:{value:0}},[e._v("否")])],1)],1),i("a-form-item",{attrs:{label:"顺序编号"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["sortValue",{initialValue:e.model.sortValue+"",rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['sortValue', { initialValue: model.sortValue + '', rules:[{required:true,whitespace:true,message:'必填'}]}]"},{name:"input",rawName:"v-input:number",arg:"number"}],attrs:{"allow-clear":"",placeholder:"请输入","max-length":5}})],1)],1)],1)],1)},ne=[],le=["title","intro","groupList","jumpType","jumpUrl","isTop","isActive","sortValue"],se={name:"InformationEdit",components:{Uploader:U["d"],RichEditor:U["b"],GroupsSelecter:U["a"]},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){return this.formLayout={labelCol:{md:{span:4},xs:{span:24}},wrapperCol:{md:{span:19},xs:{span:24}}},{form:this.$form.createForm(this),title:"",spinning:!1,jumpType:0,curIntroLength:0}},created:function(){var e=this;le.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("model",(function(){e.model&&e.form.setFieldsValue(L()(e.model,le)),e.title=e.model&&e.model.id?"修改资讯":"新增资讯",e.curIntroLength=e.model.intro?e.model.intro.length:0,e.$nextTick((function(){e.jumpType=e.model.jumpType||2}))}))},mounted:function(){},befortDestory:function(){},methods:{handleInputArea:function(e,t,i,a){var o=this;if(this[i]=e.target.value.length,e.target.value.length>a){var r=e.target.value.substr(0,a);this.$nextTick((function(){o.form.setFieldsValue(Object(u["a"])({},t,r))})),this[i]=a}else this[i]=e.target.value.length},changeJumpType:function(e){this.jumpType=e.target.value},onUploadEvent:function(e){"uploading"===e.action?this.spinning=!0:"done"===e.action&&(this.spinning=!1)},onCancel:function(){this.$emit("cancel")},onOk:function(){var e={};this.$refs["editor"].checkEditorVal(),this.$emit("ok",e)}}},ue=se,ce=Object(f["a"])(ue,re,ne,!1,null,"41e91dd9",null),de=ce.exports,me=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{attrs:{title:e.title,width:740,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:function(){e.$emit("ok")},cancel:function(){e.$emit("cancel")}}},[i("a-spin",{attrs:{spinning:e.loading}},[i("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[i("a-form-item",{attrs:{label:"公告标题"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{initialValue:e.model.title,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['title', { initialValue: model.title, rules:[{ required:true, whitespace:true, message:'必填' }] }]"}],attrs:{"allow-clear":"",maxLength:15,placeholder:"请输入"}})],1),i("a-form-item",{attrs:{label:"公告内容"}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["content",{initialValue:e.model.content,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['content', { initialValue: model.content, rules: [{ required: true, whitespace:true, message: '必填' }] }]"}],attrs:{name:"content","allow-clear":"",maxLength:500,"auto-size":{minRows:2,maxRows:5},placeholder:"请输入"},on:{change:function(t){e.handleInputArea(t,"content","curContentLength",500)}}}),i("span",{staticStyle:{float:"right","line-height":"0px"}},[e._v(e._s(e.curContentLength+"/500"))])],1),i("groups-selecter",{attrs:{form:e.form,model:e.model,viewMode:1,cfg:[{id:"groups",label:"权限范围"}]}}),i("a-form-item",{attrs:{label:"是否上架"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isActive",{initialValue:e.model.isActive||1,rules:[{required:!0,message:"必选"}]}],expression:"['isActive', { initialValue: model.isActive || 1, rules: [{ required: true, message: '必选' }] }]"}]},[i("a-radio",{attrs:{value:1}},[e._v("是")]),i("a-radio",{attrs:{value:0}},[e._v("否")])],1)],1),i("a-form-item",{attrs:{label:"顺序编号"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["sortValue",{initialValue:e.model.sortValue+"",rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['sortValue', { initialValue: model.sortValue + '', rules:[{required:true,whitespace:true,message:'必填'}]}]"},{name:"input",rawName:"v-input:number",arg:"number"}],attrs:{"allow-clear":"",placeholder:"请输入","max-length":5}})],1)],1)],1)],1)},pe=[],he=["title","content","groups","isActive","sortValue"],fe={name:"NoticeEdit",components:{GroupsSelecter:U["a"]},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){return this.formLayout={labelCol:{md:{span:4},xs:{span:24}},wrapperCol:{md:{span:19},xs:{span:24}}},{form:this.$form.createForm(this),title:"",curContentLength:0}},created:function(){var e=this;he.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("model",(function(){e.model&&e.form.setFieldsValue(L()(e.model,he)),e.title=e.model.id?"修改公告":"新增公告",e.curContentLength=e.model.content?e.model.content.length:0}))},methods:{handleInputArea:function(e,t,i,a){var o=this;if(this[i]=e.target.value.length,e.target.value.length>a){var r=e.target.value.substr(0,a);this.$nextTick((function(){o.form.setFieldsValue(Object(u["a"])({},t,r))})),this[i]=a}else this[i]=e.target.value.length}}},ve=fe,ge=Object(f["a"])(ve,me,pe,!1,null,null,null),be=ge.exports,we=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{attrs:{title:e.title,width:740,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:e.onOk,cancel:e.onCancel}},[i("a-spin",{attrs:{spinning:e.spinning}},[i("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[i("a-form-item",{attrs:{label:"产品封面",required:""}},[i("a-row",{attrs:{type:"flex",align:"middle",justify:"start"}},[i("div",{style:{display:"flex","align-items":"center"}},[i("a-upload",{style:{width:"245px",height:"90px"},attrs:{name:"coverImg",accept:".jpg,.gif,.png","list-type":"picture-card",showUploadList:!1,beforeUpload:e.beforeUpload_card}},[e.coverImg?i("img",{style:{width:"245px",height:"90px"},attrs:{src:e.coverImg,alt:"card"}}):i("div",{style:{width:"245px",height:"60px","margin-top":"30px"}},[i("a-icon",{attrs:{type:"plus"}}),i("div",{style:{"margin-top":"10px",color:"#666"}},[e._v("上传照片")])],1)]),i("div",{style:{height:"50px","line-height":"20px","margin-left":"28px"}},[i("a-icon",{attrs:{type:"info-circle"}}),e._v(" 建议产品封面尺寸为710x260像素，仅支持：.JPG、.GIF、PNG图片文件，且文件小于5M. ")],1)],1)])],1),i("a-form-item",{attrs:{label:"产品名称"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{initialValue:e.model.title,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['title', { initialValue: model.title, rules:[{required:true,whitespace:true,message:'必填'}]}]"}],attrs:{"allow-clear":"",maxLength:20,placeholder:"请输入"}})],1),i("a-form-item",{attrs:{label:"产品简介"}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["intro",{initialValue:e.model.intro,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['intro', { initialValue: model.intro, rules: [{ required: true, whitespace:true, message: '必填' }] }]"}],attrs:{name:"intro","allow-clear":"",maxLength:50,"auto-size":{minRows:1,maxRows:3},placeholder:"请输入"},on:{change:function(t){e.handleInputArea(t,"intro","curIntroLength",50)}}}),i("span",{staticStyle:{float:"right","line-height":"0px"}},[e._v(e._s(e.curIntroLength+"/50"))])],1),i("a-form-item",{attrs:{label:"可见范围"}},[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["groupList",{initialValue:e.model.groupList,rules:[{required:!0,message:"必填"}]}],expression:"['groupList', { initialValue: model.groupList, rules: [{ required: true, message: '必填' }] }]"}],attrs:{mode:"multiple",name:"groupList",placeholder:"请选择","allow-clear":"",showSearch:"",optionFilterProp:"children"},on:{change:e.onGroupChange}},e._l(e.model.allGroupList,(function(t){return i("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1),i("a-form-item",{attrs:{label:"可用范围"}},[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["unlockedGroupList",{initialValue:e.model.unlockedGroupList||e.model.groupList,rules:[{required:!0,message:"必填"}]}],expression:"['unlockedGroupList', { initialValue: model.unlockedGroupList || model.groupList, rules: [{ required: true, message: '必填' }] }]"}],attrs:{mode:"multiple",name:"unlockedGroupList",placeholder:"请选择","allow-clear":"",showSearch:"",optionFilterProp:"children"}},e._l(e.availableGroups,(function(t){return i("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1),i("a-form-item",{attrs:{label:"产品链接"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["jumpUrl",{initialValue:e.model.jumpUrl,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['jumpUrl', { initialValue: model.jumpUrl, rules:[{required:true,whitespace:true,message:'必填'}]}]"}],attrs:{"allow-clear":"",placeholder:"请输入"}})],1),i("a-form-item",{attrs:{label:"是否为推荐产品"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isTop",{initialValue:e.model.isTop||0,rules:[{required:!0,message:"必选"}]}],expression:"['isTop', { initialValue: model.isTop || 0, rules: [{ required: true, message: '必选' }] }]"}]},[i("a-radio",{attrs:{value:1}},[e._v("是")]),i("a-radio",{attrs:{value:0}},[e._v("否")])],1)],1),i("a-form-item",{attrs:{label:"是否上架"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isActive",{initialValue:e.model.isActive||1,rules:[{required:!0,message:"必选"}]}],expression:"['isActive', { initialValue: model.isActive || 1, rules: [{ required: true, message: '必选' }] }]"}]},[i("a-radio",{attrs:{value:1}},[e._v("是")]),i("a-radio",{attrs:{value:0}},[e._v("否")])],1)],1),i("a-form-item",{attrs:{label:"顺序编号"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["sortValue",{initialValue:e.model.sortValue+"",rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['sortValue', { initialValue: model.sortValue + '', rules:[{required:true,whitespace:true,message:'必填'}]}]"},{name:"input",rawName:"v-input:number",arg:"number"}],attrs:{"allow-clear":"",placeholder:"请输入","max-length":5}})],1)],1)],1)],1)},ye=[],xe=(i("2532"),["title","intro","groupList","jumpUrl","isTop","isActive","sortValue"]),Ie={props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){return this.formLayout={labelCol:{md:{span:6},xs:{span:24}},wrapperCol:{md:{span:16},xs:{span:24}}},{form:this.$form.createForm(this),title:"",coverImg:"",spinning:!1,curIntroLength:0,availableGroups:[]}},created:function(){var e=this;xe.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("model",(function(){if(e.model&&e.form.setFieldsValue(L()(e.model,xe)),e.title=e.model&&e.model.id?"修改产品":"新增产品",e.curIntroLength=e.model.intro?e.model.intro.length:0,e.model.coverImg?e.coverImg=e.model.coverImg:e.coverImg="",e.visible){var t=e.model;t.groupList?t.groupList.includes(-1)?e.availableGroups=t.allGroupList:e.availableGroups=t.allGroupList.filter((function(e){return t.groupList.includes(e.id)})):e.availableGroups=[]}}))},methods:{handleInputArea:function(e,t,i,a){var o=this;if(this[i]=e.target.value.length,e.target.value.length>a){var r=e.target.value.substr(0,a);this.$nextTick((function(){o.form.setFieldsValue(Object(u["a"])({},t,r))})),this[i]=a}else this[i]=e.target.value.length},checkImg:function(e){var t=e.size/1024/1024<5;return!!t||(this.$message.error("上传文件大小不能超过 5MB～"),!1)},beforeUpload_card:function(e){var t=this;if(this.checkImg(e)){var i=this.$store.state.ta,a="product_coverImg_".concat(Date.now(),".png");this.spinning=!0,Object(b["a"])(e,{key:"taqf/club/".concat(i.clubId,"/").concat(a),appId:"weClub"}).then((function(e){t.coverImg=e.url})).catch((function(e){})).finally((function(){t.spinning=!1}))}},onCancel:function(){this.coverImg="",this.$emit("cancel")},onOk:function(){this.coverImg?this.$emit("ok",{coverImg:this.coverImg}):this.$message.info("请上传封面图片")},onGroupChange:function(e,t){var i=this.model,a=this.form.getFieldValue("groupList")||[],o=a.filter((function(t){return!e.includes(t)}))[0];e.includes(-1)?this.availableGroups=i.allGroupList:this.availableGroups=i.allGroupList.filter((function(t){return e.includes(t.id)}));var r=this.form.getFieldValue("unlockedGroupList");r&&(r=e.includes(-1)?r.filter((function(e){return e!==o})):r.filter((function(t){return e.includes(t)})),this.form.setFieldsValue({unlockedGroupList:r}))}}},Le=Ie,Ce=Object(f["a"])(Le,we,ye,!1,null,null,null),Te=Ce.exports,Ve=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{attrs:{title:e.title,maskClosable:!1,visible:e.visible,confirmLoading:e.loading||e.spinning,centered:!0,bodyStyle:{maxHeight:"100%",overflowY:"auto"},dialogStyle:{background:"red"},"wrap-class-name":"full-modal"},on:{ok:e.onOk,cancel:e.onCancel}},[i("a-spin",{attrs:{spinning:e.spinning}},[i("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[i("a-form-item",{attrs:{label:"策略类型"}},[i("a-select",{attrs:{disabled:!0,placeholder:"10"===e.model.policyType?"可转债策略":"自定义策略"}},["10"===e.model.policyType?i("a-select-option",{attrs:{value:"10"}},[e._v("可转债策略")]):i("a-select-option",{attrs:{value:"0"}},[e._v("自定义策略")])],1)],1),i("a-form-item",{attrs:{label:"策略标题"}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["intro",{initialValue:e.model.intro,rules:[{required:!0,whitespace:!0,message:"必填"},{validator:e.checkEmoji}]}],expression:"['intro', { initialValue: model.intro, rules: [{ required: true, whitespace: true, message: '必填' }, { validator: checkEmoji }] }]"}],attrs:{name:"intro","allow-clear":"","auto-size":{minRows:2,maxRows:5},placeholder:"请输入"},on:{change:function(t){e.onIntroChange(t,"intro","curIntroLength",e.titleLen)}}}),i("span",{staticStyle:{float:"right","line-height":"0px"}},[e._v(e._s(e.curIntroLength+"/"+e.titleLen))])],1),e.fromPC?i("rich-editor",{ref:"editor",attrs:{visible:e.visible,form:e.form,label:"策略详情",exId:"details",options:{},contents:e.model.details},on:{change:e.onRichEditorChange}}):i("a-form-item",{attrs:{label:"策略详情"}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["details",{initialValue:e.model.details,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['details', { initialValue: model.details, rules: [{ required: true, whitespace: true, message: '必填' }] }]"}],attrs:{name:"details","allow-clear":"","auto-size":{minRows:2,maxRows:20},placeholder:"请输入"},on:{change:function(t){e.onDetailsChange(t,"details","curCntLength",e.cntLen)}}}),i("span",{staticStyle:{float:"right","line-height":"0px"}},[e._v(e._s(e.curCntLength+"/"+e.cntLen))])],1),e.fromPC?e._e():i("a-form-item",{attrs:{label:"图片列表"}},[i("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["imageList"],expression:"['imageList']"}],attrs:{accept:e.fileConfig.image.extStr,"file-list":e.imageList,multiple:!0,"max-count":e.fileConfig.image.count,"before-upload":e.beforeUpload_img,"custom-request":function(t){e.customUploadRequest(t,0)},"list-type":"picture-card",remove:function(t){e.handleRemove(t,0)}},on:{preview:e.handlePreview}},[e.imageList.length<e.fileConfig.image.count?i("div",[i("a-tooltip",{attrs:{title:e.fileConfig.image.extTip}},[i("a-icon",{attrs:{type:"plus"}}),i("div",{staticStyle:{"margin-top":"8px"}},[e._v("上传图片")])],1)],1):e._e()]),i("a-modal",{attrs:{visible:e.previewVisible,title:e.previewTitle,footer:null},on:{cancel:e.closePreview}},[i("img",{staticStyle:{width:"100%"},attrs:{alt:"预览",src:e.previewImage}})])],1),i("a-form-item",{attrs:{label:"文档列表"}},[i("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["documentList"],expression:"['documentList']"}],attrs:{accept:e.fileConfig.document.extStr,"file-list":e.documentList,multiple:!0,"max-count":e.fileConfig.document.count,"before-upload":e.beforeUpload_doc,"custom-request":function(t){e.customUploadRequest(t,1)},remove:function(t){e.handleRemove(t,1)}}},[e.documentList.length<e.fileConfig.document.count?i("div",[i("a-tooltip",{attrs:{title:e.fileConfig.document.extTip}},[i("a-button",[i("a-icon",{attrs:{type:"upload"}}),e._v(" 上传文档 ")],1)],1)],1):e._e()])],1),i("groups-selecter",{attrs:{form:e.form,model:e.model,cfg:[{tip:"该条策略在列表界面对以下所选分组内的用户可见"},{tip:"以下所选分组内的用户可浏览该策略的详情"}]}}),i("a-form-item",{attrs:{label:"跳转卡片"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["jumpModuleId",{initialValue:e.model.jumpModuleId||-1,rules:[{required:!1,message:"必选"}]}],expression:"['jumpModuleId', { initialValue: model.jumpModuleId || -1, rules: [{ required: false, message: '必选' }] }]"}]},[i("a-radio",{attrs:{value:-1}},[e._v("不跳转")]),i("a-radio",{attrs:{value:10900}},[e._v("ETF长盈计划")])],1)],1),i("a-form-item",{attrs:{label:"是否上架"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isActive",{initialValue:e.isActive,rules:[{required:!0,message:"必选"}]}],expression:"['isActive', { initialValue: isActive, rules: [{ required: true, message: '必选' }] }]"}],on:{change:e.onActiveSwith}},[i("a-radio",{attrs:{value:1}},[e._v("是")]),i("a-radio",{attrs:{value:0}},[e._v("否")])],1)],1),e.isActive?[i("a-form-item",{attrs:{label:"是否置顶"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isTop",{initialValue:e.isTop,rules:[{required:!0,message:"必选"}]}],expression:"['isTop', { initialValue: isTop, rules: [{ required: true, message: '必选' }] }]"}]},[i("a-radio",{attrs:{value:1}},[e._v("是")]),i("a-radio",{attrs:{value:0}},[e._v("否")])],1)],1),!e.editOld&&e.fromPC?[i("a-divider",{staticStyle:{"padding-left":"5%"},attrs:{orientation:"left"}},[e._v("推送设置")]),i("a-form-item",{attrs:{label:"推送方式",help:e.pushTimeTip,validateStatus:e.pushTimeTipStatus}},[i("a-checkbox-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["pushType",{initialValue:e.pushType,rules:[{required:!1,message:"必选"}]}],expression:"['pushType', { initialValue: pushType, rules: [{ required: false, message: '必选' }] }]"}],attrs:{disabled:!e.pushEditable},on:{change:e.onPushTypeSwith}},[i("a-checkbox",{attrs:{value:e.pushConfig.WX,disabled:e.disablePushWX}},[e._v("微信推送")]),e.smsEnable?i("a-checkbox",{attrs:{value:e.pushConfig.SMS}},[e._v("短信推送")]):e._e()],1)],1),e.isPush?[i("a-form-item",{attrs:{label:"推送时间"}},[i("a-tooltip",{attrs:{placement:"topLeft"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["pushNow",{initialValue:e.pushNow,rules:[{required:!0,message:"必选"}]}],expression:"['pushNow', { initialValue: pushNow, rules: [{ required: true, message: '必选' }] }]"}],attrs:{disabled:!e.pushEditable||e.disablePushNow},on:{change:e.onPushNowSwith}},[i("a-radio",{attrs:{value:1}},[e._v("立即推送")]),i("a-radio",{attrs:{value:0}},[e._v("定时推送")])],1)],1)],1),0===e.pushNow?i("div",{staticStyle:{position:"relative",width:"100%"}},[i("a-form-item",{attrs:{label:"定时推送时间"}},[i("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["pushDate",{initialValue:e.pushDate,rules:[{required:!0,message:"必填"}]}],expression:"['pushDate', { initialValue: pushDate, rules: [{ required: true, message: '必填' }] }]"}],ref:"pushDate",staticStyle:{width:"130px"},attrs:{disabled:!e.pushEditable,placeholder:"请选日期",format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD","allow-clear":"","show-time":!1,"disabled-date":e.disabledDate}})],1),i("a-form-item",{staticStyle:{position:"absolute",top:"0",left:"calc(12.5% + 130px)"},attrs:{label:""}},[i("a-time-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["pushTime",{initialValue:e.pushTime,rules:[{required:!0,message:"必填"}]}],expression:"['pushTime', { initialValue: pushTime, rules: [{ required: true, message: '必填' }] }]"}],ref:"pushTime",staticStyle:{width:"130px"},attrs:{disabled:!e.pushEditable,placeholder:"请选择时间",format:"HH:mm:ss",valueFormat:"HH:mm:ss","allow-clear":"","disabled-hours":e.disabledTime}})],1)],1):e._e()]:e._e()]:e._e(),e.fromPC?e._e():i("a-form-item",{attrs:{label:""}},[i("a-divider",{staticStyle:{"padding-left":"5%"},attrs:{orientation:"left"}},[e._v("推送设置")]),i("div",{staticStyle:{"margin-left":"80px"}},[e._v("暂不支持修改从小程序端发送的策略的推送设置")])],1),"10"===e.model.policyType?i("a-form-item",{attrs:{label:"用户提醒"}},[i("a-checkbox-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isPopup",{initialValue:e.model.isPopup,rules:[{required:!1,message:"必选"}]}],expression:"['isPopup', { initialValue: model.isPopup, rules: [{ required: false, message: '必选' }] }]"}]},[i("a-checkbox",{attrs:{value:"pop"}},[e._v("弹框提醒")])],1)],1):e._e()]:e._e()],2)],1),i("div",{staticClass:"preview-container"},[i("div",{staticClass:"ant-modal-header",staticStyle:{position:"fixed",width:"100%"}},[i("div",{staticClass:"ant-modal-title"},[e._v("策略预览")])]),i("div",{staticClass:"info-box"},[i("p",{staticClass:"title"},[e._v(e._s(e.intro))]),i("p",{staticClass:"html content",domProps:{innerHTML:e._s(e.details)}})])])],1)},ke=[],Se=(i("25f0"),i("fb6a"),i("8ded")),je=i.n(Se),_e=i("e819"),Re={image:{count:9,size:5,name:"图片",unit:"张",cntErr:"",sizeErr:"",ext:[".png",".jpg",".jpeg"],extStr:"",extTip:""},document:{count:10,size:30,name:"文档",unit:"个",cntErr:"",sizeErr:"",ext:[".pdf",".doc",".docx",".xls",".xlsx",".ppt",".pptx"],extStr:"",extTip:""},video:{count:1,size:10,name:"视频",unit:"个",cntErr:"",sizeErr:"",ext:[],extStr:"",extTip:""}};for(var qe in Re){var Oe=Re[qe],Ne=Oe.count,Ee=Oe.size,Ue=Oe.name,Me=Oe.unit,De=Oe.ext;Oe.cntErr="上传".concat(Ue,"的数量不能超过").concat(Ne).concat(Me,"~"),Oe.sizeErr="上传的".concat(Ue,"不能超过").concat(Ee,"M~"),Oe.extStr=De.join(","),Oe.extTip="支持".concat(De.join(" "),"格式的").concat(Ue,"，每").concat(Me,"小于").concat(Ee,"M，最多").concat(Ne).concat(Me)}var $e={WX:10,SMS:20},Ae=6e4,Ge=_e["a"].appId+"-StrategyOption",Pe=["intro","groupList"],Fe={name:"StrategyEdit",components:{RichEditor:U["b"],GroupsSelecter:U["a"]},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){return this.formLayout={labelCol:{md:{span:3},xs:{span:24}},wrapperCol:{md:{span:21},xs:{span:24}}},{fileConfig:Re,pushConfig:$e,form:this.$form.createForm(this),editType:0,title:"",spinning:!1,curIntroLength:0,curCntLength:0,titleLen:40,cntLen:5e3,imageList:[],documentList:[],viedeList:[],previewVisible:!1,previewTitle:"",previewImage:"",fromPC:!0,intro:"",details:"",isActive:1,isTop:0,isPush:1,editOld:!1,smsEnable:1,pushType:[$e.WX],pushNow:-1,pushDate:"",pushTime:"",pushTimeTip:"",pushTimeTipStatus:"",disablePushNow:!1,disablePushWX:!1,pushEditable:!1}},watch:{pushType:function(e,t){var i=this;this.pushEditable&&(e.length?(this.isPush=1,this.illegalTime&&this.pushType.toString()===$e.WX.toString()?(this.pushNow=0,this.$nextTick((function(){i.form.setFieldsValue({pushNow:i.pushNow})}))):-1===this.pushNow&&(this.pushNow=1,this.$nextTick((function(){i.form.setFieldsValue({pushNow:i.pushNow})}))),e.includes($e.WX)?this.disabledHours=this._disabledHours:this.disabledHours=[]):this.isPush=0)},pushNow:function(e){var t=this;e||this.$nextTick((function(){return[t.updatePushTime()]}))}},created:function(){var e=this;Pe.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("visible",(function(t){var i=e.model;if(t){e.form.setFieldsValue(L()(i,Pe));var a=i.id,o=i.equipment,r=i.intro,n=void 0===r?"":r,l=i.details,s=void 0===l?"":l,u=i.isActive,c=void 0===u?1:u,d=i.isTop,m=void 0===d?0:d,p=i.isPush,h=void 0===p?1:p,f=i.isPushed,v=i.smsEnable,g=void 0===v?1:v,b=i.imgUrls,w=void 0===b?[]:b,y=i.fileUrls,I=void 0===y?[]:y,C=i.videoUrls,T=void 0===C?[]:C;e.editType=a?1:0,e.title=e.editType?"修改策略":"新增策略",e.fromPC=10!==o,e.intro=n,e.details=s,e.isActive=c,e.isTop=m,e.isPush=h,e.curIntroLength=n.length,e.curCntLength=s.length,e.imageList=[],e.documentList=[],e.viedeList=[],w.forEach((function(t,i){e.imageList.push({uid:i-100,name:Object(x["k"])(t),url:t,status:"done"})})),I.forEach((function(t,i){e.documentList.push({uid:i-200,name:t.name,url:t.url,status:"done"})})),T.forEach((function(t,i){e.viedeList.push({uid:i-300,name:t.name,url:t.url,status:"done"})})),e.uploadingCnt=0,e.smsEnable=g,e.illegalTime=!1,e.pushEditable=!1,(e.editType&&0===f||!e.editType)&&(e.pushEditable=!0),e.pushDate="",e.pushTime="",e.pushNow=-1,e.pushType=[$e.WX],e.getDailyStrategyRule(),e.handleEditPush(),e.loadGroupsOption()}}))},mounted:function(){},befortDestory:function(){},methods:{saveGroupsOption:function(){if(!this.editType){var e=this.model.allGroupList,t=e.map((function(e){return e.id}));t.sort((function(e,t){return e.id-t.id}));var i=this.form.getFieldsValue(["groupList","unlockedGroupList"]);i=Object(s["a"])(Object(s["a"])({},i),{},{allGroupIds:t}),je.a.set(Ge,i)}},loadGroupsOption:function(){if(!this.editType){var e=je.a.get(Ge);if(e){var t=this.model.allGroupList,i=t.map((function(e){return e.id}));i.sort((function(e,t){return e.id-t.id})),i.toString()===e.allGroupIds.toString()?(this.model.groupList=e.groupList,this.model.unlockedGroupList=e.unlockedGroupList):je.a.remove(Ge)}}},getDailyStrategyRule:function(){var e=this;this.pushEditable&&(this.disabledAM=[],this.disabledPM=[],this.disabledHours=[],this.spinning=!0,this.$store.dispatch("ta/DailyStrategyRule",!1).then((function(t){var i=t.isSmsPush,a=t.pushValidBeginTime,o=t.pushValidEndTime;e.smsEnable=i,e.startHour=a.slice(0,2),e.endHour=o.slice(0,2)-1;for(var r=0;r<24;r++)r<e.startHour?e.disabledAM.push(r):r>e.endHour&&e.disabledPM.push(r);e._disabledHours=e.disabledAM.concat(e.disabledPM),e.disabledHours=e._disabledHours,e.pushTimeTip="微信推送可用时间段为".concat(e.startHour,":00:00~").concat(e.endHour,":59:59，其他时间请").concat(e.smsEnable?"选择短信推送或":"","使用定时推送功能"),e.pushTimeTipStr=e.pushTimeTip,e.pushWXTip="由于微信平台限制，在".concat(e.startHour,":00:00~").concat(e.endHour,":59:59以外的时间使用微信推送会导致封号，请使用其他推送方式！"),e.checkIllegalTime(),e.$nextTick((function(){var t={pushType:e.pushType};e.isPush&&(t.pushNow=e.pushNow),e.form.setFieldsValue(t)}))})).catch((function(t){e.$error({title:"数据异常",content:"获取数据异常，请稍后重试",okText:"确认",cancelText:"取消",onOk:function(){e.onCancel()},onCancel:function(){}})})).finally((function(){e.spinning=!1})))},handleEditPush:function(){if(this.editType){this.pushTimeTip="";var e=this.model,t=e.pushType,i=e.pushTime,a=e.isPushed;i?(this.pushNow=0,this.pushDate=i.slice(0,10),this.pushTime=i.slice(11)):this.pushNow=1,this.editOld=!1,void 0===t&&void 0===i&&void 0===a&&(this.editOld=!0),this.pushType=t||[]}},checkIllegalTime:function(){if(this.pushEditable){var e=this.startHour,t=this.endHour,i=D()();i=i.endOf("minute"),i=D()(i),this._moment=i;var a=i.format("HH");a>=e&&a<=t?(this.illegalTime=!1,this.pushTimeTipStatus=""):(this.illegalTime=!0,this.pushTimeTipStatus="warning")}},updatePushTime:function(e){var t=this;if(this.pushEditable&&(this.checkIllegalTime(),this.isPush&&(e||!this.pushDate))){var i=this._moment;i=i.valueOf()+1+3*Ae,i=D()(i);var a=this.startHour,o=this.disabledAM,r=this.disabledPM,n=+i.format("HH");o.includes(n)?(this.pushDate=i.format("YYYY-MM-DD"),this.pushTime=a+":00:00"):r.includes(n)?(i=D()(i.endOf("day")+1),this.pushDate=i.format("YYYY-MM-DD"),this.pushTime=a+":00:00"):(this.pushDate=i.format("YYYY-MM-DD"),this.pushTime=i.format("HH:mm:ss")),this.$nextTick((function(){t.form.setFieldsValue({pushDate:t.pushDate,pushTime:t.pushTime})}))}},onActiveSwith:function(e){var t=e.target.value;this.isActive=t},onPushSwith:function(e){var t=e.target.value;this.isPush=t},onPushTypeSwith:function(e){var t=this;!this.checkPushTime()&&0===this.pushNow||this.illegalTime&&1===this.pushNow&&e.includes($e.WX)?(this.$message.error(this.pushWXTip),this.$nextTick((function(){t.pushType=[$e.SMS],t.form.setFieldsValue({pushType:t.pushType})}))):this.pushType=e},onPushNowSwith:function(e){var t=this,i=e.target.value;this.illegalTime&&this.pushType.includes($e.WX)&&i?(this.$message.error(this.pushWXTip),this.$nextTick((function(){t.pushNow=0,t.form.setFieldsValue({pushNow:t.pushNow})}))):this.pushNow=i},checkPushTime:function(){var e=this.form.getFieldValue("pushTime");if(!e)return!0;var t=e.slice(0,2)-1;return!this._disabledHours.includes(t)},checkPushNow:function(){var e=this;this.illegalTime&&this.pushType.toString()===$e.WX.toString()?(this.disablePushNow=!0,this.$nextTick((function(){e.pushNow=0,e.form.setFieldsValue({pushNow:e.pushNow})}))):this.disablePushNow=!1},checkPushType:function(){var e=this;if(this.disablePushWX=!1,this.illegalTime&&1===this.pushNow&&(this.disablePushWX=!0,this.pushType.includes($e.WX))){var t=this.pushType.findIndex((function(e){return e===$e.WX}));this.pushType.splice(t,1),this.$nextTick((function(){e.form.setFieldsValue({pushType:e.pushType})}))}},disabledDate:function(e){return e&&e<D()().startOf("day")},disabledTime:function(){return this.disabledHours},handleInputArea:function(e,t,i,a){var o=this;if(this[i]=e.target.value.length,e.target.value.length>a){var r=e.target.value.substr(0,a);this.$nextTick((function(){o.form.setFieldsValue(Object(u["a"])({},t,r))})),this[i]=a}else this[i]=e.target.value.length},onIntroChange:function(e,t,i,a){this.handleInputArea(e,t,i,a);var o=e.target.value;this.intro=o},onDetailsChange:function(e,t,i,a){this.handleInputArea(e,t,i,a);var o=e.target.value;this.details=o},onRichEditorChange:function(e,t){this.details=t},checkEmoji:function(e,t,i){t&&C["a"].emoji.test(t)?i(new Error("请勿使用表情符号")):i()},onCancel:function(){this.$emit("cancel")},onOk:function(){if(this.uploadingCnt)this.$message.info("请等待文件上传结束后操作");else{var e={};this.model.policyType&&(e.policyType=this.model.policyType);var t={};t.jumpModuleId=this.form.getFieldValue("jumpModuleId");var i=this.imageList,a=this.documentList,o=this.viedeList;if(i&&(t.imgUrls=i.map((function(e){return e.url}))),a&&(t.fileUrls=a.map((function(e){return{name:e.name,url:e.url}}))),o&&(t.videoUrls=o.map((function(e){return{name:e.name,url:e.url}}))),t.isPush=this.isPush,t.isPush){t.pushType=this.pushType;var r=this.form.getFieldValue("pushDate"),n=this.form.getFieldValue("pushTime");r&&n&&(t.pushTime=r+" "+n)}this.saveGroupsOption(),this.$emit("ok",e,t)}},handlePreview:function(e){var t=this;return Object(E["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(e.url||e.preview){i.next=4;break}return i.next=3,Object(x["a"])(e.originFileObj);case 3:e.preview=i.sent;case 4:t.previewImage=e.url||e.preview,t.previewVisible=!0,t.previewTitle=e.name||e.url.substring(e.url.lastIndexOf("/")+1);case 7:case"end":return i.stop()}}),i)})))()},closePreview:function(){this.previewVisible=!1,this.previewTitle=""},handleRemove:function(e,t){var i;0===t?i=this.imageList:1===t&&(i=this.documentList);var a=i.findIndex((function(t){return t.uid===e.uid}));i.splice(a,1)},checkFile:function(e,t){var i,a,o=this;0===t?(i=this.fileConfig.image,a=this.imageList):1===t&&(i=this.fileConfig.document,a=this.documentList);var r=i,n=r.count,l=r.size;if(a.length===n)return this.errorTimerCount||this.$message.error(i.cntErr),this.errorTimerCount=setTimeout((function(){o.errorTimerCount=null}),1e3),!1;var s=e.size/1024/1024;return s>l?(this.errorTimerSize||this.$message.error(i.sizeErr),this.errorTimerSize=setTimeout((function(){o.errorTimerSize=null}),1e3),!1):(e.status="uploading",e.percent=10,a.push(e),!0)},beforeUpload_img:function(e){return this.beforeUpload(e,0)},beforeUpload_doc:function(e){return this.beforeUpload(e,1)},beforeUpload:function(e,t){return this.checkFile(e,t)},customUploadRequest:function(e,t){var i=this,a=e.file,o=this.$store.state.ta,r="strategy_img_".concat(Date.now(),"_").concat(a.name);1===t&&(r="strategy_doc_".concat(Date.now(),"_").concat(a.name)),this.uploadingCnt++,Object(b["a"])(a,{key:"taqf/club/".concat(o.clubId,"/").concat(r),appId:"weClub",onProgress:function(e){a.percent=e}}).then((function(e){var o;a.url=e.url,a.status="done",delete a.percent,0===t?o=i.imageList:1===t&&(o=i.documentList),i.handleRemove(a,t),o.push(a)})).catch((function(e){})).finally((function(){i.uploadingCnt--}))}}},ze=Fe,He=(i("265c"),Object(f["a"])(ze,Ve,ke,!1,null,"038a059e",null)),Ye=He.exports,Be=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{attrs:{title:"编辑回放",width:920,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,afterClose:e.afterClose,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:e.handleSubmit,cancel:e.handleCancel}},[i("a-spin",{attrs:{spinning:e.spinning}},[i("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[i("a-form-item",{attrs:{label:"房间主题",colon:!0}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["roomName",{initialValue:e.roomInfo.roomName,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['roomName', { initialValue: roomInfo.roomName, rules: [{ required: true, whitespace: true, message: '必填' }] }]"}],attrs:{"allow-clear":"",name:"roomName",placeholder:"请输入房间主题，最长"+e.maxNameLen+"个字符","max-length":e.maxNameLen}})],1),i("a-form-item",{attrs:{label:"直播简介",colon:!0}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["notice",{initialValue:e.roomInfo.notice,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['notice', { initialValue: roomInfo.notice, rules: [{ required: true, whitespace: true, message: '必填' }] }]"}],attrs:{"allow-clear":"",name:"notice","auto-size":{minRows:1,maxRows:2},placeholder:"请输入直播简介，最长"+e.maxDescLen+"个字符"},on:{change:e.handleInputDesc}}),i("span",{staticStyle:{float:"right","line-height":"0px"}},[e._v(e._s(e.curDescLen+"/"+e.maxDescLen))])],1),i("a-form-item",{attrs:{label:"是否上架",colon:!0}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isActive",{initialValue:e.roomInfo.isActive||0,rules:[{required:!0,message:"必选"}]}],expression:"['isActive', { initialValue: roomInfo.isActive || 0, rules: [{ required: true, message: '必选' }] }]"}]},[i("a-radio",{attrs:{value:1}},[e._v("上架")]),i("a-radio",{attrs:{value:0}},[e._v("不上架")])],1)],1),i("a-form-item",{attrs:{label:"顺序编号",colon:!0}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["sortValue",{initialValue:e.roomInfo.sortValue,rules:[{required:!0,message:"必填"}]}],expression:"['sortValue', { initialValue: roomInfo.sortValue, rules: [{ required: true, message: '必填' }] }]"},{name:"input",rawName:"v-input:number",arg:"number"}],attrs:{"allow-clear":"",name:"sortValue",placeholder:"请输入顺序编号","max-length":5}})],1),e._l(e.recordList,(function(t,a){return i("a-form-item",{key:t.id,attrs:{label:"回放"+(a+1),colon:!0}},[i("a-form-item",e._b({staticStyle:{"margin-bottom":"8px"},attrs:{label:"是否显示",colon:!1}},"a-form-item",e.formLayoutInline,!1),[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["classInfo['"+a+"'][isActive]",{initialValue:t.isActive||0,rules:[{required:!1,message:"必选"}]}],expression:"[`classInfo['${index}'][isActive]`, { initialValue: item.isActive || 0, rules: [{ required: false, message: '必选' }] }]"}],on:{change:e.onStatusChange}},[i("a-radio",{attrs:{value:1}},[e._v("显示")]),i("a-radio",{attrs:{value:0}},[e._v("不显示")])],1)],1),i("a-form-item",e._b({staticStyle:{"margin-bottom":"8px"},attrs:{label:"回放标题",colon:!1}},"a-form-item",e.formLayoutInline,!1),[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["classInfo['"+a+"'][showName]",{initialValue:t.showName,rules:[{required:!0,message:"必填"}]}],expression:"[`classInfo['${index}'][showName]`, { initialValue: item.showName, rules: [{ required: true, message: '必填' }] }]"}],attrs:{"allow-clear":"",name:"showName",placeholder:"请输入回放标题，最长"+e.maxTitleLen+"个字符","max-length":e.maxTitleLen}})],1),i("a-form-item",e._b({staticStyle:{"margin-bottom":"8px"},attrs:{label:"关联课程",colon:!1}},"a-form-item",e.formLayoutInline,!1),[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["classInfo['"+a+"'][classId]",{initialValue:t.classId,rules:[{required:!1,message:"必填"}]}],expression:"[`classInfo['${index}'][classId]`, { initialValue: item.classId, rules: [{ required: false, message: '必填' }] }]"}],attrs:{name:"classId",placeholder:"请选择关联课程","allow-clear":"","show-search":!1,"option-filter-prop":"children",options:e.classList}})],1),i("a-form-item",e._b({staticStyle:{"margin-bottom":"0px"},attrs:{label:"",colon:!1,wrapperCol:{offset:4}}},"a-form-item",e.formLayoutInline,!1),[i("a-row",{attrs:{type:"flex",align:"middle",justify:"space-between"}},[i("div",{staticClass:"replay-container",staticStyle:{display:"flex","align-items":"center"}},[i("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["classInfo['"+a+"'][fileList]",{initialValue:[],rules:[{required:!1,message:"必填"}]}],expression:"[`classInfo['${index}'][fileList]`, { initialValue: [], rules: [{ required: false, message: '必填' }] }]"}],attrs:{accept:"audio/*, .mp4","file-list":e.fileList[a],showUploadList:{showRemoveIcon:!0},customRequest:function(t){e.customUploadRequest(t,a)},remove:function(t){e.handleRemoveFile(t,a)},disabled:"uploading"===e.fileList[a][0].status}},[i("a-button",{attrs:{icon:"upload"}},[e._v(" 上传文件 ")])],1)],1),i("a-button",{staticStyle:{padding:"0 6px",color:"#1890ff"},attrs:{type:"link"},on:{click:function(i){return e.downloadFile(t)}}},[e._v(e._s(t._dlDisable?"复制链接":"下载回放"))])],1)],1)],1)})),i("a-form-item",{attrs:{label:"封面图"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["coverIdx",{initialValue:e.coverIdx,rules:[{required:!1,message:"必选"}]}],expression:"['coverIdx', { initialValue: coverIdx, rules: [{ required: false, message: '必选' }] }]"}],on:{change:e.onCoverChange}},e._l(e.coverList,(function(t,a){return i("a-radio",{key:a,staticClass:"radio-cover",attrs:{value:a}},[i("div",{staticClass:"cover",class:e.coverIdx===a?"seletced":""},[i("img",{staticClass:"bg",attrs:{src:t,alt:""}}),e.isCoverMapImg&&e.coverMapImgUrl?i("img",{staticClass:"deco",attrs:{src:e.coverMapImgUrl,alt:""}}):e._e()])])})),1)],1)],2)],1)],1)},Je=[],Xe=i("b85c"),We=(i("1276"),i("0619")),Ke=i.n(We),Qe=i("21a6"),Ze=i.n(Qe),et=["isActive"],tt={props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){return this.formLayout={labelCol:{span:4},wrapperCol:{span:20}},this.formLayoutInline={labelCol:{span:4},wrapperCol:{span:20}},{form:this.$form.createForm(this),spinning:!1,roomInfo:{},recordList:[],classList:[],fileList:[],maxNameLen:20,maxDescLen:200,curDescLen:0,maxTitleLen:20,curRecordCnt:0,maxRecordCnt:8,uploaderList:{},coverMapImgUrl:"",isCoverMapImg:0,coverList:[],coverIdx:0}},created:function(){var e=this;et.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("visible",function(){var t=Object(E["a"])(regeneratorRuntime.mark((function t(i,a){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!i){t.next=12;break}return e.coverList=[],e.coverIdx=0,t.next=5,e.liveCoverList();case 5:e.roomInfo=Object(s["a"])({},e.model),o=[],o.push("reqRoomInfo"),e.classList.length||o.push("reqClassList"),e.spinning=!0,Promise.all(o.map((function(t){return e[t]()}))).then((function(t){e.setClass(),e.spinning=!1})),e.model.notice?e.curDescLen=e.model.notice.length:e.curDescLen=0;case 12:case"end":return t.stop()}}),t)})));return function(e,i){return t.apply(this,arguments)}}())},methods:{liveCoverList:function(){var e=this;return this.spinning=!0,this.$store.dispatch("ta/LiveCoverList",!1).then((function(t){e.coverList=t||[]})).catch((function(e){})).finally((function(){}))},reqRoomInfo:function(){var e=this;return this.curRecordCnt=0,w["a"].roomInfo({roomId:this.model.roomId}).then((function(t){var i=t.result;e.roomInfo=Object(s["a"])({},i.roomInfo),e.recordList=i.recordInfoList,e.recordList.forEach((function(t,i){t.recordUrl=t.recordUrl.replace("http:","https:"),t._dlDisable=t.recordUrl.indexOf(".m3u8")>-1,e.fileList[i]=[{uid:i-100,name:t.recordFileName||"未命名文件",_url:"",status:"done",url:t._dlDisable?"":t.recordUrl}],t.isActive&&e.curRecordCnt++}));var a=i.roomInfo,o=a.coverMapImgUrl,r=a.isCoverMapImg,n=a.coverImgUrl;if(e.coverMapImgUrl=o,e.isCoverMapImg=r,n){var l=n.split("?")[0];e.coverIdx=e.coverList.findIndex((function(e){return e.indexOf(l)>-1}))}e.form.setFieldsValue({coverIdx:e.coverIdx})})).catch((function(e){}))},reqClassList:function(){var e=this;return w["a"].moduleContentList({moduleId:300,pageNum:1,pageSize:50}).then((function(t){var i=t.result,a=i.contentList,o=a.map((function(e,t){return{value:t,label:e.contentMap.title,url:e.contentMap.jumpUrl}}));e.classList=o})).catch((function(e){}))},findClass:function(e){for(var t=0;t<this.classList.length;t++)if(e.linkUrl===this.classList[t].url&&e.linkDesc===this.classList[t].label)return t},setClass:function(){var e=this;this.recordList.forEach((function(t){t.classId=e.findClass(t)}))},onCoverChange:function(e){var t=e.target.value;this.coverIdx=t},reqVodSignature:function(){return w["a"].getVodSignature({appId:"weclub"}).then((function(e){var t=e.result,i=t.vodSignature;return i})).catch((function(e){}))},customUploadRequest:function(e,t){var i=this,a=e.file,o=3e3;if(a.size/1024/1024>o)this.$error({title:"错误",content:"上传文件大小不能超过 ".concat(o,"MB～")});else{a.status="uploading",this.fileList[t]=[a];var r=new Ke.a({getSignature:this.reqVodSignature}),n=r.upload({mediaFile:e.file});n.on("media_progress",(function(t){e.onProgress({percent:100*t.percent},e.file)})),n.done().then((function(o){a.status="done",o.video.url=o.video.url.replace("http:","https:"),e.onSuccess(o,e.file),i.fileList[t][0]._url=o.video.url,i.fileList[t][0].url=o.video.url,a.url=o.video.url})).catch((function(t){a.status="error",e.onError(t,null,e.file)})).finally((function(){delete i.uploaderList["loader".concat(t)]})),this.uploaderList["loader".concat(t)]=n}},handleRemoveFile:function(e,t){var i=this.recordList[t];this.fileList[t]=[{uid:t-100,name:i.recordFileName||"未命名文件",_url:"",status:"done"}]},checkUploadStatus:function(){var e,t="",i=Object(Xe["a"])(this.fileList);try{for(i.s();!(e=i.n()).done;){var a=e.value;if("uploading"===a[0].status?t="文件正在上传，请等待上传完毕。":"error"===a[0].status&&(t="有文件上传失败，请先处理。"),t)break}}catch(o){i.e(o)}finally{i.f()}return!!t&&(this.$warning({title:"注意",content:t}),!0)},cancelUpload:function(e){var t=this.uploaderList;if(Object.keys(t).length){if("undefined"!==typeof e)t["loader".concat(e)].cancel(),delete t["loader".concat(e)];else for(var i in t)t[i].cancel(),delete t[i];return!0}return!1},handleSubmit:function(e){var t=this;this.checkUploadStatus()||this.form.validateFieldsAndScroll((function(e,i){if(!e){var a={roomId:t.model.roomId,roomName:i.roomName,isActive:i.isActive,notice:i.notice,sortValue:i.sortValue,coverImgUrl:t.coverList[i.coverIdx]},o=[];i.classInfo.forEach((function(e,i){var a={id:t.recordList[i].id,isActive:e.isActive,showName:e.showName};if("undefined"!==typeof e.classId){var r=t.classList[e.classId];a.linkUrl=r.url,a.linkDesc=r.label}var n=t.fileList[i][0];n&&n._url&&(a.recordUrl=n._url,a.recordFileName=n.name),o.push(a)}));var r={roomInfo:a,recordInfoList:o},n="updateRoom";t.spinning=!0,w["a"][n](r).then((function(e){t.$message.info("操作成功"),t.$emit("ok")})).catch((function(e){})).finally((function(){t.spinning=!1}))}}))},handleCancel:function(){var e=this;Object.keys(this.uploaderList).length?this.$confirm({title:"注意",content:"您有文件正在上传，是否确认关闭？",onOk:function(){e.cancelUpload(),e.$emit("cancel")}}):this.$emit("cancel")},afterClose:function(){this.roomInfo={},this.recordList=[],this.classList=[],this.fileList=[],this.cancelUpload()},handleInputDesc:function(e){var t=this;if(e.target.value.length>this.maxDescLen){var i=e.target.value.substr(0,this.maxDescLen);this.$nextTick((function(){t.form.setFieldsValue({notice:i})})),this.curDescLen=this.maxDescLen}else this.curDescLen=e.target.value.length},downloadFile:function(e){var t=this,i=e.recordUrl,a=e._dlDisable;if(a)this.$copyText(i).then((function(e){t.$message.success("复制完毕")})).catch((function(e){t.$message.error("复制失败")}));else{var o=i.replace("http:","https:"),r=o.split("/"),n=r[r.length-1];Ze.a.saveAs(o,n)}},onStatusChange:function(e){var t=e.target.value;if(t&&this.curRecordCnt>=this.maxRecordCnt)return e.target.value=0,void this.$warning({title:"注意",content:"当前设置显示的回放数量已达上限".concat(this.maxRecordCnt,"条，请先将其他回放设为不显示。")});t?this.curRecordCnt++:this.curRecordCnt--}}},it=tt,at=(i("730a"),Object(f["a"])(it,Be,Je,!1,null,"3f09ef1d",null)),ot=at.exports,rt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{attrs:{title:e.title,width:740,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:e.onOk,cancel:e.onCancel}},[i("a-spin",{attrs:{spinning:e.spinning}},[i("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[i("a-form-item",{attrs:{label:"房间主题"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{initialValue:e.model.name,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['name', { initialValue: model.name, rules:[{ required: true, whitespace: true, message: '必填' }] }]"}],attrs:{"allow-clear":"",maxLength:20,placeholder:"请输入"}})],1),i("a-form-item",{attrs:{label:"直播类型"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["roomType",{initialValue:e.model.roomType>=0?e.model.roomType:1,rules:[{required:!0,message:"必选"}]}],expression:"['roomType', { initialValue: model.roomType >= 0 ? model.roomType : 1, rules: [{ required: true, message: '必选' }] }]"}]},[i("a-radio",{attrs:{value:1}},[e._v("视频直播")]),i("a-radio",{attrs:{value:0}},[e._v("语音直播")])],1)],1),i("a-form-item",{attrs:{label:"直播主播"}},[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["anchorId",{initialValue:e.anchor.userId,rules:[{required:!0,message:"必填"}]}],expression:"['anchorId', { initialValue: anchor.userId, rules: [{ required: true, message: '必填' }] }]"}],attrs:{name:"anchorId",placeholder:"请设置直播主播","show-search":"","option-filter-prop":"children",options:e.anchorCandidates}})],1),i("a-form-item",{attrs:{label:"开播时间"}},[i("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["playDate",{initialValue:e.model.playDate?e.model.playDate:null,rules:[{required:!0,message:"必选"}]}],expression:"['playDate', { initialValue: model.playDate ? model.playDate : null, rules: [{ required: true, message: '必选' }] }]"}],attrs:{format:"YYYY-MM-DD"}}),i("a-time-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["playTime",{initialValue:e.model.playTime?e.model.playTime:null,rules:[{required:!0,message:"必选"}]}],expression:"['playTime', { initialValue: model.playTime ? model.playTime : null, rules: [{ required: true, message: '必选' }] }]"}],attrs:{format:"HH:mm:ss"}})],1),i("a-form-item",{attrs:{label:"内容介绍"}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["descr",{initialValue:e.model.descr,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['descr', { initialValue: model.descr, rules: [{ required: true, whitespace: true, message: '必填' }] }]"}],attrs:{name:"descr","allow-clear":"",maxLength:500,"auto-size":{minRows:2,maxRows:5},placeholder:"请输入"},on:{change:function(t){e.curContentLength=t.target.value.length}}}),i("span",{staticStyle:{float:"right","line-height":"0px"}},[e._v(e._s(e.curContentLength+"/500"))])],1),i("a-form-item",{attrs:{label:"房间密码"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["invitationCode",{initialValue:e.model.invitationCode,rules:[{required:!1,whitespace:!0,message:"必填"},{validator:e.checkPwd}]}],expression:"['invitationCode', { initialValue: model.invitationCode, rules:[{ required: false, whitespace: true, message:'必填' }, { validator: checkPwd }] }]"}],attrs:{"allow-clear":"",maxLength:12,placeholder:"请输⼊字⺟、数字或汉字格式密码，最多12个字符"}})],1),i("a-form-item",{attrs:{label:"直播回放"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isAutoPublishReplay",{initialValue:e.model.isAutoPublishReplay>=0?e.model.isAutoPublishReplay:1,rules:[{required:!0,message:"必选"}]}],expression:"['isAutoPublishReplay', { initialValue: model.isAutoPublishReplay >= 0 ? model.isAutoPublishReplay : 1, rules: [{ required: true, message: '必选' }] }]"}]},[i("a-radio",{attrs:{value:1}},[e._v("直播后自动上架")]),i("a-radio",{attrs:{value:0}},[e._v("手动上架")])],1)],1),i("groups-selecter",{attrs:{form:e.form,model:e.model,cfg:[{tip:"该房间在小程序首页对以下所选分组内的用户可见"},{label:"观看权限",tip:"以下所选分组内的用户可进入该房间观看直播"}]}}),i("uploader",{attrs:{visible:e.visible,form:e.form,label:"预约房海报",exId:"bannerImg",listType:"picture-card",accept:".png, .jpg, .gif",comCSS:{width:"auto"},imgCSS:{"max-width":"245px","max-height":"275px"},btnCSS:{width:"245px",height:"60px"},maxCount:1,maxSize:5,fileType:"image",required:!1,"url-list":[e.model.bannerImg],exName:"preRoom",exTip:"",tipMode:1},on:{uploadEvent:e.onUploadEvent}}),i("uploader",{attrs:{visible:e.visible,form:e.form,label:"分享图片",exId:"shareImg",listType:"picture-card",accept:".png, .jpg, .gif",comCSS:{},imgCSS:{width:e.shareSize.sw+"px",height:e.shareSize.sh+"px"},btnCSS:{width:e.shareSize.sw+"px",height:e.shareSize.sh+"px"},maxCount:1,maxSize:5,fileType:"image",required:!1,"url-list":[e.model.shareImg],exName:"preRoom",exTip:"图片尺寸为"+e.shareSize.w+"x"+e.shareSize.h,tipMode:1},on:{uploadEvent:e.onUploadEvent}}),i("a-form-item",{attrs:{label:"顺序编号"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["sortValue",{initialValue:e.model.sortValue+"",rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['sortValue', { initialValue: model.sortValue + '', rules:[{ required: true, whitespace: true, message: '必填' }] }]"},{name:"input",rawName:"v-input:number",arg:"number"}],attrs:{"allow-clear":"",placeholder:"请输入","max-length":5}})],1)],1)],1)],1)},nt=[],lt=(i("18a5"),i("2f62")),st=["name","playDate","descr","playTime","sortValue"],ut={name:"PreRoomEdit",components:{Uploader:U["d"],GroupsSelecter:U["a"]},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){this.formLayout={labelCol:{md:{span:4},xs:{span:24}},wrapperCol:{md:{span:16},xs:{span:24}}};var e=420,t=336;return this.shareSize={w:e,h:t,sw:e/2,sh:t/2},{form:this.$form.createForm(this),title:"",spinning:!1,curContentLength:0,anchorCandidates:[],anchor:{}}},computed:Object(s["a"])({},Object(lt["b"])(["name","taUid"])),created:function(){var e=this;st.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("visible",(function(t){if(t){e.model&&e.form.setFieldsValue(L()(e.model,st)),e.title=e.model.id?"修改预约房":"新增预约房",e.curContentLength=e.model.content?e.model.content.length:0;var i=e.model.anchor;if(i){var a=i.userId,o=i.nickname,r=i.mobile;e.anchor=Object(s["a"])(Object(s["a"])({},i),{},{title:"".concat(o,"（").concat(r,"）"),value:a})}e.reqAnchorUsers()}}))},methods:{reqAnchorUsers:function(){var e=this;this.spinning=!0,w["a"].clubAdminList({}).then((function(t){var i=t.result,a=i.userInfos;a&&a.length?(a.forEach((function(e){e.title="".concat(e.nickname,"（").concat(e.mobile,"）"),e.value=e.userId})),e.anchorCandidates=a,e.anchor.userId?a.find((function(t){return t.userId===e.anchor.userId}))||a.push(e.anchor):e.anchor=a[0]):e.$message.error("未获取到主播列表")})).catch((function(e){})).finally((function(){e.spinning=!1}))},checkPwd:function(e,t,i){var a=/[^a-zA-Z0-9\u4E00-\u9FA5]/g;a.test(t)?i(new Error("请输⼊字⺟、数字或汉字格式密码")):i()},onUploadEvent:function(e){var t=e.action;e.exId,e.err,e.file;"uploading"===t?this.spinning=!0:"done"===t&&(this.spinning=!1)},onCancel:function(){this.$emit("cancel")},onOk:function(){this.$emit("ok",{})}}},ct=ut,dt=Object(f["a"])(ct,rt,nt,!1,null,null,null),mt=dt.exports,pt=i("a366"),ht=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{attrs:{title:e.title,width:700,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:e.onOk,cancel:e.onCancel}},[i("a-spin",{attrs:{spinning:e.spinning}},[i("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[i("uploader",{attrs:{visible:e.visible,form:e.form,label:"图标",exId:"icon",listType:"picture-card",accept:".png, .jpg, .jpeg",comCSS:{width:"112px",height:"112px"},imgCSS:{width:"90px",height:"90px"},btnCSS:{width:"90px",height:"90px"},maxCount:1,maxSize:.5,fileType:"image",required:!0,"url-list":[e.model.icon],exName:"mainModule",exTip:"图标尺寸为90x90像素",tipMode:1},on:{uploadEvent:e.onUploadEvent}}),i("a-form-item",{attrs:{label:"名称"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["showname",{initialValue:e.model.showname,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['showname', { initialValue: model.showname, rules: [{ required: true, whitespace: true, message: '必填' }] }]"}],attrs:{name:"showname","allow-clear":"",maxLength:6,placeholder:"请输入"}})],1),i("a-form-item",{attrs:{label:"是否开放该模块"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isOpened",{initialValue:e.isOpened,rules:[{required:!0,message:"必选"}]}],expression:"['isOpened', { initialValue: isOpened, rules: [{ required: true, message: '必选' }] }]"}],attrs:{name:"isOpened"},on:{change:e.onOpenChange}},[i("a-radio",{attrs:{value:1}},[e._v("是")]),i("a-radio",{attrs:{value:0}},[e._v("否")])],1)],1),e.isOpened?[i("a-form-item",{attrs:{label:"跳转类型"}},[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["jumpType",{initialValue:e.jumpType,rules:[{required:!0,message:"必填"}]}],expression:"['jumpType', { initialValue: jumpType, rules: [{ required: true, message: '必填' }] }]"}],attrs:{name:"jumpType",placeholder:"请选择",options:e.jumpOption},on:{change:e.changeJumpType}})],1),"1"==e.jumpType?i("uploader",{attrs:{visible:e.visible,form:e.form,label:"跳转海报",exId:"unlockedPoster",listType:"picture-card",accept:".png, .jpg, .jpeg",comCSS:{width:"222px"},imgCSS:{width:"200px"},btnCSS:{width:"90px"},maxCount:1,maxSize:5,fileType:"image",required:!0,"url-list":[e.unlockedPoster],exName:"mainModule",exTip:"海报尺寸为750x1136像素",tipMode:1},on:{uploadEvent:e.onUploadEvent}}):"2"==e.jumpType?i("a-form-item",{attrs:{label:"跳转链接"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["jumpUrl",{initialValue:e.jumpUrl,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['jumpUrl', { initialValue: jumpUrl, rules: [{ required: true, whitespace: true, message: '必填'}] }]"}],attrs:{name:"jumpUrl","allow-clear":"",placeholder:"请输入"}})],1):"0"==e.jumpType?[i("a-form-item",{attrs:{label:"拥有该模块权限的分组"}},[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["unlockedGroupList",{initialValue:e.model.unlockedGroupList,rules:[{required:!0,message:""},{validator:e.checkSelectedGroups}]}],expression:"['unlockedGroupList', { initialValue: model.unlockedGroupList, rules: [{ required: true, message: '' }, { validator: checkSelectedGroups }] }]"}],attrs:{mode:"multiple",name:"unlockedGroupList",placeholder:"请选择","allow-clear":"",showSearch:"",optionFilterProp:"children"},on:{change:e.onGroupChange2}},[e._l(e.allGroups,(function(t){return i("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),i("a-select-opt-group",{scopedSlots:e._u([{key:"label",fn:function(){return[i("span",{staticStyle:{color:"#FA541C","font-size":"14px"}},[e._v("付费分组")])]},proxy:!0}],null,!1,892585226)},e._l(e.payGroups,(function(t){return i("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1),i("a-select-opt-group",{scopedSlots:e._u([{key:"label",fn:function(){return[i("span",{staticStyle:{color:"#FA541C","font-size":"14px"}},[e._v("非付费分组")])]},proxy:!0}],null,!1,3513789332)},e._l(e.noPayGroups,(function(t){return i("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],2)],1),e.selectedAll?e._e():[i("a-form-item",{attrs:{label:"无权限粉丝跳转到"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["nonVipJump",{initialValue:e.nonVipJump,rules:[{required:!0,message:"必选"}]}],expression:"['nonVipJump', { initialValue: nonVipJump, rules: [{ required: true, message: '必选' }] }]"}],attrs:{name:"nonVipJump"},on:{change:e.onNonVipJump}},[i("a-radio",{attrs:{value:0}},[e._v("会员中心")]),i("a-radio",{attrs:{value:1}},[e._v("海报")])],1)],1),e.nonVipJump?i("uploader",{attrs:{visible:e.visible,form:e.form,label:"跳转海报",exId:"nonVipJumpPoster",listType:"picture-card",accept:".png, .jpg, .jpeg",comCSS:{width:"222px"},imgCSS:{width:"200px"},btnCSS:{width:"90px"},maxCount:1,maxSize:5,fileType:"image",required:!0,"url-list":[e.nonVipJumpPoster],exName:"mainModule",exTip:"海报尺寸为750x1136像素",tipMode:1},on:{uploadEvent:e.onUploadEvent}}):i("a-form-item",{attrs:{label:"会员中心售卖的会员"}},[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["teamList",{initialValue:e.model.teamList,rules:[{required:!0,message:"必填"}]}],expression:"['teamList', { initialValue: model.teamList, rules: [{ required: true, message: '必填' }] }]"}],attrs:{mode:"multiple",name:"teamList",placeholder:"请选择","allow-clear":"",showSearch:"",optionFilterProp:"children"}},e._l(e.availableTeams,(function(t){return i("a-select-option",{key:t.groupId,attrs:{value:t.teamId}},[e._v(e._s(t.teamName))])})),1)],1)]]:e._e()]:[i("uploader",{attrs:{visible:e.visible,form:e.form,label:"模块介绍海报",exId:"lockedPoster",listType:"picture-card",accept:".png, .jpg, .jpeg",comCSS:{width:"222px"},imgCSS:{width:"200px"},btnCSS:{width:"90px"},maxCount:1,maxSize:5,fileType:"image",required:!1,"url-list":[e.lockedPoster],exName:"mainModule",exTip:"海报尺寸为750x1136像素",tipMode:1},on:{uploadEvent:e.onUploadEvent}},[e.lockedPoster?i("a-button",{staticStyle:{"margin-left":"16px",padding:"0"},attrs:{slot:"right2",type:"link"},on:{click:e.delPoster},slot:"right2"},[e._v("删除海报")]):e._e()],1)],i("a-form-item",{attrs:{label:"角标"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["label",{initialValue:e.model.label,rules:[{required:!1,whitespace:!0,message:"请勿以空格开始"}]}],expression:"['label', { initialValue: model.label, rules:[{ required: false, whitespace: true, message: '请勿以空格开始'}] }]"}],attrs:{"allow-clear":"",placeholder:"请输入","max-length":5}})],1),i("a-form-item",{attrs:{label:"顺序编号"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["sortValue",{initialValue:e.model.sortValue+"",rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['sortValue', { initialValue: model.sortValue + '', rules:[{ required: true, whitespace: true, message: '必填'}] }]"},{name:"input",rawName:"v-input:number",arg:"number"}],attrs:{"allow-clear":"",placeholder:"请输入","max-length":5}})],1)],2)],1)],1)},ft=[],vt=K(),gt=[{value:"0",label:"默认"},{value:"1",label:"海报"},{value:"2",label:"链接"}],bt=["showname","unlockedGroupList","sortValue"],wt={name:"MainModuleEdit",components:{Uploader:U["d"]},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){return this.formLayout={labelCol:{md:{span:7},xs:{span:24}},wrapperCol:{md:{span:17},xs:{span:24}}},{jumpOption:gt,form:this.$form.createForm(this),editType:0,title:"",spinning:!1,icon:"",jumpType:"",jumpUrl:"",isOpened:1,nonVipJump:0,unlockedPoster:"",lockedPoster:"",nonVipJumpPoster:"",allGroups:[],payGroups:[],noPayGroups:[],availableGroups:[],availableTeams:[],selectedAll:!0}},created:function(){var e=this;bt.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("visible",(function(t){if(t){var i=e.model,a=i.id,o=i.icon,r=void 0===o?"":o,n=i.isOpened,l=void 0===n?1:n,s=i.unlockedGroupList,u=void 0===s?[]:s;e.title=a?"金刚位设置":"新增金刚位",e.icon=r,e.isOpened=l,e.unlockedPoster="",e.lockedPoster="",e.nonVipJumpPoster="",e.$nextTick((function(){e.checkModuleOption()})),e.handleGroupList(),e.checkTeamList(u),i.groupList?i.groupList.includes(-1)?e.availableGroups=i.allGroupList:e.availableGroups=i.allGroupList.filter((function(e){return i.groupList.includes(e.id)})):e.availableGroups=[]}}))},mounted:function(){},befortDestory:function(){},methods:{handleGroupList:function(){var e=this;this.allGroups=[],this.payGroups=[],this.noPayGroups=[];var t=this.model,i=t.allTeamList,a=void 0===i?[]:i,o=t.allGroupList,r=void 0===o?[]:o;r.forEach((function(t){-1===t.id?e.allGroups.push(t):t.isPay&&a.find((function(e){return e.groupId===t.id}))?e.payGroups.push(t):e.noPayGroups.push(t)}))},checkModuleOption:function(){var e=this.model,t=e.moduleId,i=e.isOpened,a=e.jumpType,o=e.jumpUrl,r=void 0===o?"":o,n=e.layoutType,l=e.maskJumpUrl,s=void 0===l?"":l;if(!t)return!1;this.jumpType="0",this.jumpUrl="";var u=vt[t];if(i&&a===u.jumpType&&r===u.jumpUrl&&n===u.layoutType){if(this.jumpType="0",this.jumpUrl=r,s.indexOf("http")>-1&&s.indexOf(W)>-1){var c=Object(x["o"])("img",s);this.nonVipJumpPoster=c,this.nonVipJump=1}return!0}if(r.indexOf("http")>-1){if(r.indexOf(W)>-1){this.jumpType="1";var d=Object(x["o"])("img",r);this.unlockedPoster=d}else this.jumpType="2";this.jumpUrl=r}if(s.indexOf("http")>-1&&s.indexOf(W)>-1){var m=Object(x["o"])("img",s);this.lockedPoster=m}return!1},genModuleOption:function(){var e,t,i,a,o=this.model.moduleId;if(!o)return!1;var r={},n=vt[o];return this.isOpened?("0"===this.jumpType?(e=n.jumpType,t=n.jumpUrl,0===this.nonVipJump||(a=W+"?img="+encodeURIComponent(this.nonVipJumpPoster))):"1"===this.jumpType?(e="2",t=W+"?img="+encodeURIComponent(this.unlockedPoster)):"2"===this.jumpType&&(e="2",t=this.form.getFieldValue("jumpUrl")),r={jumpType:e,jumpUrl:t},a&&(r.maskJumpUrl=a)):this.lockedPoster&&(e=n.jumpType,t=n.jumpUrl,a=W+"?img="+encodeURIComponent(this.lockedPoster),r={jumpType:e,jumpUrl:t,maskJumpUrl:a}),i=n.layoutType,r.layoutType=i,r},checkTeamList:function(e){var t=this.model,i=t.allTeamList,a=void 0===i?[]:i,o=t.allGroupList,r=void 0===o?[]:o;if(e.includes(-1))e.length&&(this.selectedAll=!0),this.availableTeams=[];else{e.length&&(this.selectedAll=!1);var n=r.filter((function(t){return t.isPay&&e.includes(t.id)})).map((function(e){return e.id}));this.availableTeams=a.filter((function(e){return n.includes(e.groupId)}))}},checkSelectedGroups:function(e,t,i){this.checkTeamList(t),t.length&&(this.selectedAll||this.availableTeams.length)?i():i(new Error("请至少选择一个【付费分组】"))},handleInputArea:function(e,t,i,a){var o=this;if(this[i]=e.target.value.length,e.target.value.length>a){var r=e.target.value.substr(0,a);this.$nextTick((function(){o.form.setFieldsValue(Object(u["a"])({},t,r))})),this[i]=a}else this[i]=e.target.value.length},changeJumpType:function(e){this.jumpType=e},onOpenChange:function(e){this.isOpened=e.target.value},onNonVipJump:function(e){this.nonVipJump=e.target.value},delPoster:function(){this.lockedPoster="";var e=this.model.contentMap;e&&delete e.maskJumpUrl},onUploadEvent:function(e){var t=e.action,i=e.exId,a=(e.err,e.file);"uploading"===t?this.spinning=!0:"done"===t?this.spinning=!1:"success"===t&&("icon"===i&&(this.icon=a.url),"unlockedPoster"===i&&(this.unlockedPoster=a.url),"lockedPoster"===i&&(this.lockedPoster=a.url),"nonVipJumpPoster"===i&&(this.nonVipJumpPoster=a.url))},onCancel:function(){this.$emit("cancel")},onOk:function(){var e=this.genModuleOption(),t=this.model,i=t.layoutType,a=t.moduleId,o=t.contentMap,r=void 0===o?{}:o,n=Object(s["a"])(Object(s["a"])({},r),{},{showname:this.form.getFieldValue("showname"),icon:this.icon,layoutType:i,moduleId:a},e);n.label=this.form.getFieldValue("label"),0===this.nonVipJump&&delete n.maskJumpUrl;var l=this.form.getFieldValue("teamList")||this.model.teamList||[];l=l.map((function(e){return{id:e}}));var u={isOpened:this.isOpened,groupList:[{id:-1}],teamList:l};this.$emit("ok",n,u)},onGroupChange:function(e,t){var i=this.model,a=this.form.getFieldValue("groupList")||[],o=a.filter((function(t){return!e.includes(t)}))[0];e.includes(-1)?this.availableGroups=i.allGroupList:this.availableGroups=i.allGroupList.filter((function(t){return e.includes(t.id)}));var r=this.form.getFieldValue("unlockedGroupList");r&&(r=e.includes(-1)?r.filter((function(e){return e!==o})):r.filter((function(t){return e.includes(t)})),this.form.setFieldsValue({unlockedGroupList:r}))},onGroupChange2:function(e,t){this.checkTeamList(e);var i=this.form.getFieldValue("teamList")||[],a=this.availableTeams.filter((function(t){return e.includes(t.groupId)})).filter((function(e){return i.includes(e.teamId)})).map((function(e){return e.teamId}));this.form.setFieldsValue({teamList:a})}}},yt=wt,xt=(i("b1a6"),Object(f["a"])(yt,ht,ft,!1,null,null,null)),It=xt.exports,Lt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{attrs:{title:e.title,width:740,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:e.onOk,cancel:e.onCancel}},[i("a-spin",{attrs:{spinning:e.spinning}},[i("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[i("uploader",{attrs:{visible:e.visible,form:e.form,label:"广告图",exId:"coverImg",listType:"picture-card",accept:".png, .jpg, .jpeg",comCSS:{width:"261px",height:"106px","margin-bottom":"6px"},imgCSS:{width:"245px",height:"66px"},btnCSS:{width:"245px",height:"106px"},maxCount:1,fileType:"image",required:!0,"url-list":[e.model.coverImg],exName:"banner",exTip:"图片尺寸为710x190像素",tipMode:1},on:{uploadEvent:e.onUploadEvent}}),i("a-form-item",{attrs:{label:"名称"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{initialValue:e.model.title,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['title', { initialValue: model.title, rules: [{ required: true, whitespace: true, message: '必填' }] }]"}],attrs:{"allow-clear":"",maxLength:e.titleLen,placeholder:"请输入"},on:{change:function(t){e.onTitleChange(t,"title","curTitleLength",e.titleLen)}}})],1),i("a-form-item",{attrs:{label:"简介"}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["intro",{initialValue:e.model.intro,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['intro', { initialValue: model.intro, rules: [{ required: true, whitespace: true, message: '必填' }] }]"}],attrs:{name:"intro","allow-clear":"",maxLength:e.introLen,"auto-size":{minRows:2,maxRows:3},placeholder:"请输入"},on:{change:function(t){e.onIntroChange(t,"intro","curIntroLength",e.introLen)}}}),i("span",{staticStyle:{float:"right","line-height":"0px"}},[e._v(e._s(e.curIntroLength+"/"+e.introLen))])],1),i("a-form-item",{attrs:{label:"跳转类型"}},[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["jumpType",{initialValue:e.model.jumpType,rules:[{required:!0,message:"必填"}]}],expression:"['jumpType', { initialValue: model.jumpType, rules: [{ required: true, message: '必填' }] }]"}],attrs:{name:"jumpType",placeholder:"请选择",options:e.jumpOption},on:{change:e.changeJumpType}})],1),"1"===e.jumpType?i("a-form-item",{attrs:{label:"支付会员"}},[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["teamId",{initialValue:e.model.teamId,rules:[{required:!0,message:"必填"}]}],expression:"['teamId', { initialValue: model.teamId, rules: [{ required: true, message: '必填' }] }]"}],attrs:{name:"teamId",placeholder:"请选择",options:e.teamOption}})],1):e._e(),"2"===e.jumpType?i("a-form-item",{attrs:{label:"跳转链接"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["jumpUrl",{initialValue:e.jumpData||e.jumpUrl,rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['jumpUrl', { initialValue: jumpData || jumpUrl, rules:[{ required: true, whitespace: true, message: '必填'}] }]"}],attrs:{"allow-clear":"",placeholder:"请输入"}})],1):e._e(),i("groups-selecter",{attrs:{form:e.form,model:e.model}}),i("a-form-item",{attrs:{label:"是否上架"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isActive",{initialValue:e.model.isActive||1,rules:[{required:!0,message:"必选"}]}],expression:"['isActive', { initialValue: model.isActive || 1, rules: [{ required: true, message: '必选' }] }]"}]},[i("a-radio",{attrs:{value:1}},[e._v("是")]),i("a-radio",{attrs:{value:0}},[e._v("否")])],1)],1),i("a-form-item",{attrs:{label:"顺序编号"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["sortValue",{initialValue:e.model.sortValue+"",rules:[{required:!0,whitespace:!0,message:"必填"}]}],expression:"['sortValue', { initialValue: model.sortValue + '', rules:[{ required: true, whitespace: true, message: '必填'}] }]"},{name:"input",rawName:"v-input:number",arg:"number"}],attrs:{"allow-clear":"",placeholder:"请输入","max-length":5}})],1)],1)],1)],1)},Ct=[],Tt=[{value:"1",label:"站内支付"},{value:"2",label:"外链"}],Vt=["title","intro","coverImg","groupList","jumpType","jumpUrl","isActive","sortValue"],kt={name:"ADBannerEdit",components:{Uploader:U["d"],GroupsSelecter:U["a"]},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){return this.formLayout={labelCol:{md:{span:4},xs:{span:24}},wrapperCol:{md:{span:19},xs:{span:24}}},{jumpOption:Tt,form:this.$form.createForm(this),editType:0,title:"",spinning:!1,jumpType:"",jumpUrl:"",jumpData:"",titleLen:10,introLen:40,curTitleLength:0,curIntroLength:0,teamOption:[]}},created:function(){var e=this;Vt.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("visible",(function(t){if(t){var i=e.model,a=i.id,o=i.title,r=void 0===o?"":o,n=i.intro,l=void 0===n?"":n,s=i.jumpType,u=void 0===s?"":s,c=i.jumpUrl,d=void 0===c?"":c,m=i.jumpData,p=void 0===m?"":m,h=i.allTeamList,f=void 0===h?[]:h;e.title=a?"修改广告位设置":"新增广告位设置",e.curTitleLength=r.length,e.curIntroLength=l.length,e.teamOption=f.map((function(e){return{value:e.teamId+"",label:e.teamName}})),e.jumpType=u,e.jumpUrl=d,e.jumpData=p,"1"===u?(e.jumpUrl="openVip",e.jumpData=""):"2"===u&&(e.jumpUrl=d,e.jumpData="")}}))},mounted:function(){},befortDestory:function(){},methods:{handleInputArea:function(e,t,i,a){var o=this;if(this[i]=e.target.value.length,e.target.value.length>a){var r=e.target.value.substr(0,a);this.$nextTick((function(){o.form.setFieldsValue(Object(u["a"])({},t,r))})),this[i]=a}else this[i]=e.target.value.length},onTitleChange:function(e,t,i,a){this.handleInputArea(e,t,i,a);var o=e.target.value;this.details=o},onIntroChange:function(e,t,i,a){this.handleInputArea(e,t,i,a);var o=e.target.value;this.intro=o},changeJumpType:function(e){this.jumpType=e},onUploadEvent:function(e){"uploading"===e.action?this.spinning=!0:"done"===e.action&&(this.spinning=!1)},onCancel:function(){this.$emit("cancel")},onOk:function(){var e,t=this.jumpType,i=this.jumpUrl,a=this.jumpData;"1"===t?(i="openVip",a="",e=this.form.getFieldValue("teamId")):"2"===t&&(i=this.form.getFieldValue("jumpUrl"),a="");var o={jumpUrl:i,jumpData:a,teamId:e},r={isRemove:this.form.getFieldValue("isRemove")};this.$emit("ok",o,r)}}},St=kt,jt=Object(f["a"])(St,Lt,Ct,!1,null,"5f900df8",null),_t=jt.exports,Rt={components:{STable:U["c"],NoticeEdit:be},props:{moduleInfo:{type:Object,default:function(){}},allGroupList:{type:Array,default:function(){return[]}}},computed:{groupList:function(){var e=this.moduleInfo.groupList.map((function(e){return e.name}));return e.join(" | ")},rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}},tableX:function(){var e=0;return this.columns.forEach((function(t){e+=t.width||100})),e}},data:function(){var e=this;return{columns:[],spinning:!1,switchIndex:"",modalVisible:!1,confirmLoading:!1,modelData:{},totalCount:0,loadData:function(t){var i=Object.assign({},t);return i.pageNum=t.pageNo,delete i.pageNo,w["a"].clubNoticeList(i).then((function(i){var a=i.result;return e.totalCount=a.total,{totalCount:a.total,pageNo:t.pageNo,data:a.noticeList||[]}})).catch((function(){})).finally((function(){e.onSelectChange([],[])}))},selectedRowKeys:[],selectedRows:[]}},filters:{available:function(e){return 1===e.isActive}},created:function(){var e=this;return Object(E["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("ta/GetGroups").then((function(t){e.allGroupList.length||t.forEach((function(t){return e.allGroupList.push(t)}))})).catch((function(t){e.allGroupList=[]}));case 2:e.columns=$["notice"](e.allGroupList);case 3:case"end":return t.stop()}}),t)})))()},methods:{handleAdd:function(){this.modelData={sortValue:"".concat(0===this.totalCount?1:10*this.totalCount),allGroupList:this.allGroupList},this.modalVisible=!0},handleEdit:function(e){var t=this;w["a"].clubNoticeInfo({clubModuleId:this.moduleInfo.moduleId,id:e.id}).then((function(e){var i=Object.assign({allGroupList:t.allGroupList},e.result);i.sortValue+="",t.modelData=i,t.modalVisible=!0})).catch((function(e){})).finally((function(){t.spinning=!1}))},handleEditCancel:function(){this.confirmLoading=!1,this.modalVisible=!1,this.modelData={};var e=this.$refs.editModal.form;e.resetFields()},handleEditOk:function(){var e=this,t=this.$refs.editModal.form;this.confirmLoading=!0,t.validateFields((function(t,i){if(t)e.confirmLoading=!1;else{var a={clubNoticeInfo:i};e.modelData.id&&(a.clubNoticeInfo.id=e.modelData.id),w["a"].updateClubNoticeInfo(a).then((function(t){e.$message.success("操作成功"),e.$refs.table.refresh(!0),e.handleEditCancel()})).catch((function(e){})).finally((function(){e.confirmLoading=!1}))}}))},handleDelete:function(e){var t=this,i=J(this.moduleInfo.moduleId);this.$confirm({title:i.title,content:i.content,onOk:function(){t.doDelete(e)},onCancel:function(){}})},doDelete:function(e){var t,i=this;e?t=[e.id]:this.selectedRowKeys.length&&(t=this.selectedRowKeys),this.spinning=!0,w["a"].removeClubNoticeInfo({clubModuleId:this.moduleInfo.moduleId,ids:t}).then((function(e){i.$message.success("删除成功"),i.$refs.table.refresh(!0)})).catch((function(e){})).finally((function(){i.spinning=!1}))},onStatusChange:function(e,t,i,a,o){var r=this;this.switchIndex=a;var n=0===i.isActive?1:0,l={clubNoticeInfo:{id:i.id,isActive:n}};w["a"].updateClubNoticeInfo(l).then((function(e){i.isActive=n})).catch((function(e){})).finally((function(){r.switchIndex=""}))},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t}}},qt=Rt,Ot=Object(f["a"])(qt,O,N,!1,null,null,null),Nt=Ot.exports,Et=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-spin",{attrs:{spinning:e.spinning}},[[10,200].includes(e.moduleInfo.moduleId)?e._e():i("div",{staticClass:"table-page-search-wrapper"},[i("a-row",{attrs:{type:"flex",align:"bottom"}},[i("a-col",{attrs:{span:20}},[i("a-descriptions",{attrs:{column:1}},[i("a-descriptions-item",{attrs:{label:"模块显示状态"}},[e._v(e._s(1===e.moduleInfo.isActive?"显示":"不显示"))]),i("a-descriptions-item",{attrs:{label:"模块权限范围"}},[i("span",[e._v(e._s(e.groupList))])])],1)],1)],1)],1),10!==e.moduleInfo.moduleId?i("div",{staticClass:"table-operator"},[200!==e.moduleInfo.moduleId?[i("a-button",{attrs:{type:"primary",icon:"edit"},on:{click:e.handleEditModule}},[e._v("修改模块信息")]),i("a-divider",{attrs:{type:"vertical"}})]:e._e(),100!==e.moduleInfo.moduleId?i("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.handleAdd()}}},[e._v("添加")]):e._e(),i("a-button",{attrs:{disabled:0===e.selectedRowKeys.length,type:"primary",icon:"delete"},on:{click:function(t){return e.handleDelete()}}},[e._v("批量删除")])],2):e._e(),i("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",columns:e.columns,data:e.loadData,alert:!1,scroll:{x:e.tableX},rowSelection:e.rowSelection,showPagination:"auto"},scopedSlots:e._u([{key:"avatar",fn:function(e){return i("span",{},[i("a-avatar",{attrs:{size:48,icon:"user",src:e}})],1)}},{key:"available",fn:function(t,a,o,r){return i("span",{},[i("a-switch",{attrs:{loading:o===e.switchIndex,checked:e._f("available")(a,t),disabled:e._f("disabled")(a,r)},on:{change:function(i){return e.onStatusChange(i,t,a,o,r.dataIndex)}}})],1)}},{key:"replay",fn:function(t,a){return i("span",{},[[i("a",{style:{color:"#1890ff"},on:{click:function(t){return e.handleSpeechFile(a)}}},[e._v("查看课件")]),i("a-divider",{attrs:{type:"vertical"}}),i("a",{style:{color:"#1890ff"},on:{click:function(t){return e.handleEditReplay(a)}}},[e._v("编辑回放")]),i("a-divider",{attrs:{type:"vertical"}}),i("a",{staticStyle:{color:"#f12323"},on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除")])]],2)}},{key:"normal",fn:function(t,a,o,r){return i("span",{},[["btn"===r.dataIndex?i("a-button",{staticStyle:{color:"#1890ff",padding:"0"},attrs:{type:"link",icon:10===a.equipment?"mobile":"desktop"},on:{click:function(t){return e.handleEdit(a)}}},[e._v("编辑")]):i("a",{style:{color:10===a.equipment?"gray":"#1890ff"},on:{click:function(t){return e.handleEdit(a)}}},[e._v("编辑")]),10!==e.moduleInfo.moduleId?[i("a-divider",{attrs:{type:"vertical"}}),i("a",{staticStyle:{color:"#f12323"},on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除")])]:e._e(),e.distributeEnable?[i("a-divider",{attrs:{type:"vertical"}}),i("a-tooltip",{attrs:{placement:"left","arrow-point-at-center":"",title:"策略将被分发到其他Club栖凤平台"}},[i("a",{staticStyle:{color:"#1890ff"},on:{click:function(t){return e.handleDistribute(a)}}},[e._v("分发")])])]:e._e()]],2)}},{key:"setTop",fn:function(t,a){return i("span",{},[[i("a",{style:{color:"#1890ff"},on:{click:function(t){return e.handleEdit(a)}}},[e._v("编辑")]),i("a-divider",{attrs:{type:"vertical"}}),i("a",{style:{color:"#1890ff"},on:{click:function(t){return e.handleSetTop(a)}}},[e._v(e._s(a.isTop?"取消推荐":"设为推荐"))]),i("a-divider",{attrs:{type:"vertical"}}),i("a",{style:{color:"#1890ff"},on:{click:function(t){return e.gotoChapterList(a)}}},[e._v(e._s("上传课程"))]),i("a-divider",{attrs:{type:"vertical"}}),i("a",{staticStyle:{color:"#f12323"},on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除")])]],2)}}])}),i("module-info-edit",{ref:"moduleEditModal",attrs:{visible:e.moduleModalVisible,loading:e.moduleConfirmLoading,model:e.moduleModelData},on:{cancel:e.handleEditModuleCancel,ok:e.handleEditModuleOk}}),10===e.moduleInfo.moduleId?i("main-module-edit",{ref:"editModal",attrs:{visible:e.modalVisible,loading:e.confirmLoading,model:e.modelData},on:{cancel:e.handleEditCancel,ok:e.handleEditOk}}):100===e.moduleInfo.moduleId?i("replay-edit",{ref:"editModal",attrs:{visible:e.modalVisible,loading:e.confirmLoading,model:e.modelData},on:{cancel:e.handleReplayEditCancel,ok:e.handleReplayEditOk}}):200===e.moduleInfo.moduleId?i("strategy-edit",{ref:"editModal",attrs:{visible:e.modalVisible,loading:e.confirmLoading,model:e.modelData},on:{cancel:e.handleEditCancel,ok:e.handleEditOk}}):300===e.moduleInfo.moduleId?i("class-edit",{ref:"editModal",attrs:{visible:e.modalVisible,loading:e.confirmLoading,model:e.modelData},on:{cancel:e.handleEditCancel,ok:e.handleEditOk}}):400===e.moduleInfo.moduleId?i("product-edit",{ref:"editModal",attrs:{visible:e.modalVisible,loading:e.confirmLoading,model:e.modelData},on:{cancel:e.handleEditCancel,ok:e.handleEditOk}}):500===e.moduleInfo.moduleId?i("information-edit",{ref:"editModal",attrs:{visible:e.modalVisible,loading:e.confirmLoading,model:e.modelData},on:{cancel:e.handleEditCancel,ok:e.handleEditOk}}):e._e(),600===e.moduleInfo.moduleId?i("aD-banner-edit",{ref:"editModal",attrs:{visible:e.modalVisible,loading:e.confirmLoading,model:e.modelData},on:{cancel:e.handleEditCancel,ok:e.handleEditOk}}):e._e(),i("pre-room-class",{ref:"classModal",attrs:{visible:e.classModalVisible,"room-id":e.curRoomId,source:1},on:{cancel:e.handleClassClose,ok:e.handleClassClose}})],1)},Ut=[],Mt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-modal",{attrs:{title:"模块信息修改",width:740,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:function(){e.$emit("ok")},cancel:function(){e.$emit("cancel")}}},[i("a-spin",{attrs:{spinning:e.loading}},[i("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[i("a-form-item",{attrs:{label:"模块显示状态"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isActive",{initialValue:e.model.isActive||0,rules:[{required:!0,message:"必选"}]}],expression:"['isActive', { initialValue: model.isActive || 0, rules: [{ required: true, message: '必选' }] }]"}]},[i("a-radio",{attrs:{value:1}},[e._v("显示")]),i("a-radio",{attrs:{value:0}},[e._v("不显示")])],1)],1),i("a-form-item",{attrs:{label:"模块权限范围"}},[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["groupIdList",{initialValue:e.model.groupIdList,rules:[{required:!0,message:"必填"}]}],expression:"['groupIdList', { initialValue: model.groupIdList, rules: [{ required: true, message: '必填' }] }]"}],attrs:{mode:"multiple",name:"groupIdList",placeholder:"请选择","allow-clear":"",showSearch:"",optionFilterProp:"children"}},e._l(e.model.allGroupList,(function(t){return i("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],1)],1)],1)],1)},Dt=[],$t=["isActive","groupIdList"],At={props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){return this.formLayout={labelCol:{md:{span:4},xs:{span:24}},wrapperCol:{md:{span:16},xs:{span:24}}},{form:this.$form.createForm(this)}},created:function(){var e=this;$t.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("model",(function(){e.model&&e.form.setFieldsValue(L()(e.model,$t))}))},methods:{}},Gt=At,Pt=Object(f["a"])(Gt,Mt,Dt,!1,null,null,null),Ft=Pt.exports,zt=i("4360"),Ht={components:{STable:U["c"],ModuleInfoEdit:Ft,ReplayEdit:ot,ClassEdit:oe,InformationEdit:de,ProductEdit:Te,StrategyEdit:Ye,MainModuleEdit:It,ADBannerEdit:_t,PreRoomClass:pt["a"]},props:{moduleInfo:{type:Object,default:function(){}},allGroupList:{type:Array,default:function(){return[]}}},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}},tableX:function(){var e=0;return this.columns.forEach((function(t){e+=t.width||100})),e},isRoom:function(){return 100===this.moduleInfo.moduleId},distributeEnable:function(){var e=[100001,100005,100010,100085].includes(zt["a"].getters.taClubId)&&200===this.moduleInfo.moduleId;return e}},data:function(){return{columns:[],spinning:!1,switchIndex:"",groupList:"",moduleModalVisible:!1,moduleConfirmLoading:!1,moduleModelData:{},modalVisible:!1,confirmLoading:!1,modelData:{},totalCount:0,classModalVisible:!1,curRoomId:0,loadData:this.reqModuleContent,selectedRowKeys:[],selectedRows:[]}},filters:{available:function(e,t){return 1===t},disabled:function(e,t){return"isPush"===t.dataIndex}},created:function(){this.columns=$[this.moduleInfo.moduleId+""],this.groupList=this.getGroupListStr()},methods:{getGroupListStr:function(){if(!this.moduleInfo.groupList)return"-";var e=this.moduleInfo.groupList.map((function(e){return e.name})).filter((function(e){return e}));return this.moduleInfo.groupList.find((function(e){return-1===e.id}))?"全部":e.join(" | ")},reqModuleContent:function(e){var t=this,i={moduleId:this.moduleInfo.moduleId,pageNum:e.pageNo,pageSize:e.pageSize},a=this.isRoom?"roomList":"moduleContentList";return w["a"][a](i).then((function(i){var a=i.result,o=a.contentList||a.roomInfoList||[];t.isRoom&&o.forEach((function(e){e.id=e.roomId}));var r={totalCount:a.total,pageNo:e.pageNo,data:o};return t.totalCount=a.total,r})).catch((function(){})).finally((function(){t.onSelectChange([],[])}))},handleEditModule:function(){this.moduleModelData=Object(s["a"])(Object(s["a"])({},this.moduleInfo),{},{allGroupList:this.allGroupList}),this.moduleModelData.groupIdList=this.moduleModelData.groupList?this.moduleModelData.groupList.map((function(e){return e.id})):[],this.moduleModalVisible=!0},handleEditModuleCancel:function(){this.moduleConfirmLoading=!1,this.moduleModalVisible=!1,this.moduleModelData={};var e=this.$refs.moduleEditModal.form;e.resetFields()},handleEditModuleOk:function(){var e=this,t=this.$refs.moduleEditModal.form;this.moduleConfirmLoading=!0,t.validateFields((function(t,i){if(t)e.moduleConfirmLoading=!1;else{var a=[];i.groupIdList.forEach((function(t){a.push(e.allGroupList.find((function(e){return e.id===t})))}));var o=Object.assign({clubModuleId:e.moduleInfo.moduleId},i);w["a"].updateModule(o).then((function(t){t.result&&(e.$message.success("操作成功"),e.moduleInfo.groupList=a,e.moduleInfo.isActive=i.isActive,e.groupList=e.getGroupListStr(),e.handleEditModuleCancel())})).finally((function(){e.moduleConfirmLoading=!1}))}}))},reqTeamList:function(){var e=this;return new Promise(function(){var t=Object(E["a"])(regeneratorRuntime.mark((function t(i,a){var o,r,n,l,s,u,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(![10,600].includes(e.moduleInfo.moduleId)){t.next=13;break}if(!e.allTeamList){t.next=4;break}return i(),t.abrupt("return");case 4:return t.next=6,w["a"].simpleTeamList({});case 6:o=t.sent,r=o.code,n=o.msg,l=o.result,"0"===r?(s=l.teamList,u=void 0===s?[]:s,e.allTeamList=u,i()):(c="获取数据异常: "+n,a(new Error(c))),t.next=14;break;case 13:i();case 14:case"end":return t.stop()}}),t)})));return function(e,i){return t.apply(this,arguments)}}())},handleAdd:function(){var e=this;return Object(E["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.spinning=!0,t.next=4,e.reqTeamList();case 4:t.next=10;break;case 6:return t.prev=6,t.t0=t["catch"](0),e.$message.error(t.t0.message),t.abrupt("return");case 10:return t.prev=10,e.spinning=!1,t.finish(10);case 13:e.modelData={sortValue:"".concat(0===e.totalCount?1:10*e.totalCount),allGroupList:e.allGroupList,allTeamList:e.allTeamList},e.modalVisible=!0;case 15:case"end":return t.stop()}}),t,null,[[0,6,10,13]])})))()},handleEdit:function(e){var t=this;return Object(E["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return t.spinning=!0,i.prev=1,i.next=4,t.reqTeamList();case 4:i.next=11;break;case 6:return i.prev=6,i.t0=i["catch"](1),t.$message.error(i.t0.message),t.spinning=!1,i.abrupt("return");case 11:w["a"].moduleContentInfo({clubModuleId:t.moduleInfo.moduleId,contentId:e.id}).then((function(i){var a=i.result?i.result.contentMap:{},o=Object.assign({allGroupList:t.allGroupList,allTeamList:t.allTeamList},a,i.result);10!==t.moduleInfo.moduleId&&delete o.contentMap,o.groupList=o.groupList.map((function(e){return parseInt(e.id)})),o.unlockedGroupList||(o.unlockedGroupList=[]),o.unlockedGroupList=o.unlockedGroupList.map((function(e){return parseInt(e.id)})),o.teamList||(o.teamList=[]),o.teamList=o.teamList.map((function(e){return parseInt(e.id)})),o.id=e.id,o.sortValue+="",o.isPopup=o.isPopup?["pop"]:[],t.modelData=o,t.modalVisible=!0})).catch((function(e){})).finally((function(){t.spinning=!1}));case 12:case"end":return i.stop()}}),i,null,[[1,6]])})))()},handleDelete:function(e){var t=this,i=J(this.moduleInfo.moduleId);this.$confirm({title:i.title,content:i.content,onOk:function(){t.doDelete(e)},onCancel:function(){}})},doDelete:function(e){var t,i,a,o=this;e?t=[e.id]:this.selectedRowKeys.length&&(t=this.selectedRowKeys),this.isRoom?(i="deleteRooms",a={roomIdList:t}):(i="moduleContentRemove",a={clubModuleId:this.moduleInfo.moduleId,contentIdList:t}),this.spinning=!0,w["a"][i](a).then((function(e){o.$message.success("删除成功"),o.$refs.table.refresh(!0)})).catch((function(e){})).finally((function(){o.spinning=!1}))},handleSetTop:function(e){var t=this;this.$confirm({title:"确定要设为推荐吗？",content:"设为推荐后，内容将可以展示在首页，最多可以设置4个推荐内容。",onOk:function(){t.doSetTop(e)},onCancel:function(){}})},doSetTop:function(e){var t=this;this.spinning=!0;var i=0===e.isTop?1:0;w["a"]["updateModuleContent"]({clubModuleId:this.moduleInfo.moduleId,contentInfo:{id:e.id,isTop:i}}).then((function(e){t.$refs.table.refresh(!0)})).catch((function(e){"2012085"===e.code&&t.$error({title:"设为推荐失败",content:"推荐内容最多为4个，请取消现有推荐内容后再操作。",okText:"确定",onOk:function(){}})})).finally((function(){t.spinning=!1}))},onStatusChange:function(e,t,i,a,o){var r=this;this.switchIndex=a;var n,l,c,d=0===i[o]?1:0;this.isRoom?(n="updateRoom",l={roomInfo:Object(u["a"])({roomId:i.roomId},o,d)}):(n="updateModuleContent",200===this.moduleInfo.moduleId&&("isActive"===o?c=10:"isTop"===o&&(c=20)),l={clubModuleId:this.moduleInfo.moduleId,action:c,contentInfo:Object(u["a"])({id:i.id},o,d)},10===this.moduleInfo.moduleId&&(l.contentInfo=Object(s["a"])(Object(s["a"])({},i),{},Object(u["a"])({},o,d)))),w["a"][n](l).then((function(e){"isActive"===o&&0===d&&i["isTop"]&&(i["isTop"]=0),i[o]=d})).catch((function(e){})).finally((function(){r.switchIndex=""}))},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},handleEditCancel:function(){this.confirmLoading=!1,this.modalVisible=!1,this.modelData={};var e=this.$refs.editModal.form;e.resetFields()},handleEditOk:function(e,t){var i=this,a=this.$refs.editModal.form;this.confirmLoading=!0,a.validateFieldsAndScroll((function(a,o){if(a)i.confirmLoading=!1;else{var r=i.proxyModulesParams(o,e,t);if(!r)return void(i.confirmLoading=!1);i.updateModules(r)}}))},proxyModulesParams:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.isPopup&&(e.isPopup=e.isPopup[0]&&"pop"===e.isPopup[0]?1:0),300===this.moduleInfo.moduleId&&(e.jumpUrl="clubCourse");var a={},o=["isActive","isTop","sortValue","isPopup"];a.clubModuleId=this.moduleInfo.moduleId,a.contentInfo=Object.assign({},L()(e,o)),this.modelData.id&&(a.contentInfo.id=this.modelData.id),a.createTime=D()().format("YYYY-MM-DD HH:mm:ss");var r=[];e.groupList&&(e.groupList.forEach((function(e){r.push({id:e})})),a.contentInfo.groupList=r);var n=[];return e.unlockedGroupList&&(e.unlockedGroupList.forEach((function(e){n.push({id:e})})),a.contentInfo.unlockedGroupList=n),a.contentInfo.contentMap=Object.assign(L()(e,X[this.moduleInfo.moduleId])||{},t),a.contentInfo=Object.assign(a.contentInfo,i),a},updateModules:function(e){var t=this,i=e.contentInfo.id?"updateModuleContent":"addModuleContent";w["a"][i](e).then((function(e){t.$message.success("操作成功"),t.handleEditCancel(),t.$refs.table.refresh(!0)})).catch((function(e){})).finally((function(){t.confirmLoading=!1}))},gotoChapterList:function(e){this.$router.push({name:"TAChapter",params:e})},handleEditReplay:function(e){this.modelData=Object(s["a"])({},e),this.modalVisible=!0},handleReplayEditCancel:function(){this.confirmLoading=!1,this.modalVisible=!1,this.modelData={};var e=this.$refs.editModal.form;e.resetFields()},handleReplayEditOk:function(){this.$refs.table.refresh(),this.handleReplayEditCancel()},handleSpeechFile:function(e){var t=this;this.curRoomId=e.id,this.$nextTick((function(){t.classModalVisible=!0}))},handleClassClose:function(){this.classModalVisible=!1},handleDistribute:function(e){var t=this,i=e.id,a=e.contentMap.intro;this.$confirm({title:"确定分发？",content:"本条策略将被分发到其他Club栖凤平台",onOk:function(){t.spinning=!0,w["a"].distributeDailyStrategy({contentId:i}).then((function(e){t.$info({title:"策略分发成功",content:"策略【".concat(a,"】已分发到其他Club栖凤平台")})})).catch((function(e){})).finally((function(){t.spinning=!1}))},onCancel:function(){}})}}},Yt=Ht,Bt=Object(f["a"])(Yt,Et,Ut,!1,null,null,null),Jt=Bt.exports,Xt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-spin",{attrs:{spinning:e.spinning}},[i("div",{staticClass:"table-operator"},[i("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.handleAdd()}}},[e._v("添加")])],1),i("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",columns:e.columns,data:e.loadData,alert:!1,scroll:{x:e.tableX},showPagination:"auto"},scopedSlots:e._u([{key:"bannerImg",fn:function(t,a){return i("span",{},[[t?i("a",{style:{color:"#1890ff"},on:{click:function(i){return e.preViewImg(a,t)}}},[e._v("点击查看")]):i("span",[e._v("-")])]],2)}},{key:"normal",fn:function(t,a){return i("span",{},[a.isRelay?i("a-tooltip",{attrs:{title:"无法对转播房间进行操作"}},[a.isRelay?i("p",[e._v("-")]):e._e()]):[i("a",{style:{color:"#1890ff"},on:{click:function(t){return e.handleSpeechFile(a)}}},[e._v("查看课件")]),i("a-divider",{attrs:{type:"vertical"}}),i("a",{style:{color:"#1890ff"},on:{click:function(t){return e.handleEdit(a)}}},[e._v("编辑预约房")]),i("a-divider",{attrs:{type:"vertical"}}),i("a",{style:{color:"#f12323"},on:{click:function(t){return e.handleDelete(a)}}},[e._v("取消预约房")])]],2)}}])}),i("pre-room-edit",{ref:"editModal",attrs:{visible:e.modalVisible,loading:e.confirmLoading,model:e.modelData},on:{cancel:e.handleEditCancel,ok:e.handleEditOk}}),i("pre-room-class",{ref:"classModal",attrs:{visible:e.classModalVisible,"room-id":e.curRoomId},on:{cancel:e.handleClassClose,ok:e.handleClassClose}}),i("a-modal",{attrs:{title:!1,maskClosable:!0,visible:e.preViewVisible,destroyOnClose:!0,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"},footer:null},on:{cancel:function(){e.preViewVisible=!1}}},[i("img",{staticStyle:{width:"100%","max-width":"1000px"},attrs:{src:e.preViewBannerImg}})])],1)},Wt=[],Kt=-1,Qt={components:{STable:U["c"],PreRoomEdit:mt,PreRoomClass:pt["a"]},props:{moduleInfo:{type:Object,default:function(){}},allGroupList:{type:Array,default:function(){return[]}}},computed:{groupList:function(){var e=this.moduleInfo.groupList.map((function(e){return e.name}));return e.join(" | ")},tableX:function(){var e=0;return this.columns.forEach((function(t){e+=t.width||100})),e}},data:function(){var e=this;return this.columns=$["preRoom"],{spinning:!1,switchIndex:"",modalVisible:!1,confirmLoading:!1,modelData:{},totalCount:0,classModalVisible:!1,curRoomId:0,preViewVisible:!1,preViewBannerImg:"",loadData:function(t){var i=Object.assign({},t);return i.pageNum=t.pageNo,delete i.pageNo,w["a"].preRoomList(i).then((function(i){var a=i.result,o=a.total,r=a.preRoomList,n=void 0===r?[]:r;return e.totalCount=o,n.forEach((function(e){e.isRelay&&(e.prePageUrl="",e.bannerImg="",e.shareImg="")})),{totalCount:o,pageNo:t.pageNo,data:n}})).catch((function(){var i={total:5,preRoomList:[{createTime:"2021-10-01 00:00:00",id:1,name:"预约房间1",playTime:"2021-10-10 12:00:00",sortValue:"1",updateTime:"2021-10-01 00:00:00"},{createTime:"2021-10-01 00:00:00",id:2,name:"预约房间2",playTime:"2021-10-10 12:00:00",sortValue:"10",updateTime:"2021-10-01 00:00:00"},{createTime:"2021-10-01 00:00:00",id:3,name:"预约房间3",playTime:"2021-10-10 12:00:00",sortValue:"20",updateTime:"2021-10-01 00:00:00"},{createTime:"2021-10-01 00:00:00",id:4,name:"预约房间4",playTime:"2021-10-10 12:00:00",sortValue:"30",updateTime:"2021-10-01 00:00:00"},{createTime:"2021-10-01 00:00:00",id:5,name:"预约房间5",playTime:"2021-10-10 12:00:00",sortValue:"40",updateTime:"2021-10-01 00:00:00"}]};return e.totalCount=i.total,{totalCount:i.total,pageNo:t.pageNo,data:i.preRoomList||[]}})).finally((function(){}))}}},filters:{},created:function(){},methods:{handleAdd:function(){this.modelData={sortValue:"".concat(0===this.totalCount?1:10*this.totalCount),allGroupList:this.allGroupList,groupList:[Kt],unlockedGroupList:[Kt]},this.modalVisible=!0},handleEdit:function(e){var t=this;e.isRelay||w["a"].preRoomInfo({id:e.id}).then((function(e){var i=e.result.info,a=D()(i.playTime,"YYYY-MM-DD HH:mm:ss");i.playDate=a,i.playTime=D()(a.format("HH:mm:ss"),"HH:mm:ss"),i.sortValue+="",t.modelData=i,t.modalVisible=!0,t.modelData.allGroupList=t.allGroupList;var o,r=i.showGroups,n=void 0===r?"":r,l=i.usableGroups,s=void 0===l?"":l;o=n?n.split(","):[Kt],t.modelData.groupList=o,o=s?s.split(","):[Kt],t.modelData.unlockedGroupList=o})).catch((function(e){})).finally((function(){t.spinning=!1}))},handleEditCancel:function(){this.confirmLoading=!1,this.modalVisible=!1,this.modelData={};var e=this.$refs.editModal.form;e.resetFields()},handleEditOk:function(e){var t=this,i=this.$refs.editModal.form;this.confirmLoading=!0,i.validateFieldsAndScroll((function(i,a){if(i)t.confirmLoading=!1;else{var o,r=Object(s["a"])({},a);r.showGroups=a.groupList.join(","),r.usableGroups=a.unlockedGroupList.join(","),e&&(e.bannerImg&&(r.bannerImg=e.bannerImg),e.shareImg&&(r.shareImg=e.shareImg)),r.playTime="string"===typeof r.playDate?"".concat(r.playDate," ").concat(r.playTime.format("HH:mm:ss")):"".concat(r.playDate.format("YYYY-MM-DD")," ").concat(r.playTime.format("HH:mm:ss")),t.modelData.id?(r.id=t.modelData.id,o="preRoomUpdate"):o="preRoomAdd",w["a"][o](r).then((function(e){t.$message.success("操作成功"),t.$refs.table.refresh(!0),t.handleEditCancel()})).catch((function(e){})).finally((function(){t.confirmLoading=!1}))}}))},handleDelete:function(e){var t=this;if(!e.isRelay){var i=J(this.moduleInfo.moduleId);this.$confirm({title:i.title,content:i.content,onOk:function(){t.doDelete(e)},onCancel:function(){}})}},doDelete:function(e){var t=this;this.spinning=!0,w["a"].adminPreRoomCancel({id:e.id}).then((function(e){t.$message.success("删除成功"),t.$refs.table.refresh(!0)})).catch((function(e){})).finally((function(){t.spinning=!1}))},handleSpeechFile:function(e){var t=this;e.isRelay||(this.curRoomId=e.id,this.$nextTick((function(){t.classModalVisible=!0})))},handleClassClose:function(){this.classModalVisible=!1,this.modelData={}},preViewImg:function(e,t){this.preViewBannerImg=t,this.preViewVisible=!0}}},Zt=Qt,ei=Object(f["a"])(Zt,Xt,Wt,!1,null,null,null),ti=ei.exports,ii="KOLADmin_Content_Tab",ai={components:{ClubManage:q,NoticeManage:Nt,NormalModule:Jt,PreRoom:ti},data:function(){return{spinning:!1,tabList:[],curModuleId:sessionStorage.getItem(ii)||"1",allGroupList:[]}},watch:{curModuleId:function(e){sessionStorage.setItem(ii,e)}},created:function(){var e=this;this.tabList=[{moduleId:1,name:"Club管理"},{moduleId:2,name:"公告管理"}],this.$store.dispatch("ta/GetModules").then((function(t){var i;(i=e.tabList).splice.apply(i,[1,0].concat(Object(r["a"])(t))),t.findIndex((function(e){return 200===e.moduleId}))>-1?e.tabList.splice(2,0,{moduleId:3,name:"直播预约"}):e.tabList.splice(1,0,{moduleId:3,name:"直播预约"});var a=[10,600];e.tabList=e.tabList.filter((function(e){return!a.includes(e.moduleId)}))})).catch((function(e){})),this.$store.dispatch("ta/GetGroups").then((function(t){e.allGroupList=t})).catch((function(t){e.allGroupList=[]}))},beforeRouteLeave:function(e,t,i){"1"==this.curModuleId?this.$refs.clubManage[0].beforeLeave({callback:function(){i(!1)},callbackCancel:function(){i()}}):i()},methods:{}},oi=ai,ri=Object(f["a"])(oi,a,o,!1,null,null,null);t["default"]=ri.exports},b1a6:function(e,t,i){"use strict";i("d274")},c43b:function(e,t,i){},c9061:function(e,t,i){e.exports=i.p+"img/clubBgImg.7b301465.png"},d274:function(e,t,i){},e6cf6:function(e,t,i){}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21a3d2"],{bb51:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=this,a=e.$createElement,n=e._self._c||a;return n("page-header-wrapper",{attrs:{title:e.title}},[n("a-spin",{attrs:{spinning:e.spinning}},[n("a-card",{attrs:{bordered:!1}},[n("div",{staticClass:"table-page-search-wrapper"},[n("a-form",e._b({attrs:{layout:"inline"}},"a-form",e.formLayout,!1),[n("a-row",{attrs:{gutter:24}},[n("a-col",{attrs:{md:5,sm:24}},[n("a-form-item",{attrs:{label:"渠道"}},[n("a-select",{attrs:{placeholder:"所有渠道","default-active-first-option":!e.multipleChannel,disabled:!e.multipleChannel,"show-arrow":!0},on:{change:e.switchChannel},model:{value:e.curChannelId,callback:function(t){e.curChannelId=t},expression:"curChannelId"}},e._l(e.channelOptions,(function(t){return n("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])})),1)],1)],1)],1)],1)],1),n("div",{staticClass:"table-page-search-wrapper"},[n("a-form",e._b({attrs:{layout:"inline"}},"a-form",e.formLayout,!1),[n("a-row",{attrs:{gutter:24}},[n("a-col",{attrs:{md:5,sm:24}},[n("a-form-item",{attrs:{label:"券商"}},[n("a-select",{attrs:{placeholder:"请选择券商","default-active-first-option":!1,"show-arrow":!0},model:{value:e.queryParam.brokerId,callback:function(t){e.$set(e.queryParam,"brokerId",t)},expression:"queryParam.brokerId"}},e._l(e.brokers,(function(t){return n("a-select-option",{key:t.brokerId,attrs:{value:t.brokerId}},[e._v(" "+e._s(t.brokerName)+" ")])})),1)],1)],1),n("a-col",{attrs:{md:5,sm:24}},[n("a-form-item",{attrs:{label:"客户姓名"}},[n("a-input",{attrs:{"allow-clear":"",placeholder:"请输入客户姓名"},model:{value:e.queryParam.customerName,callback:function(t){e.$set(e.queryParam,"customerName","string"===typeof t?t.trim():t)},expression:"queryParam.customerName"}})],1)],1),n("a-col",{attrs:{md:5,sm:24}},[n("a-form-item",{attrs:{label:"客户手机号"}},[n("a-input",{attrs:{"allow-clear":"",placeholder:"请输入手机号"},model:{value:e.queryParam.phoneNo,callback:function(t){e.$set(e.queryParam,"phoneNo","string"===typeof t?t.trim():t)},expression:"queryParam.phoneNo"}})],1)],1),n("a-col",{attrs:{md:4,sm:24}},[n("span",{staticClass:"table-page-search-submitButtons"},[n("a-button",{attrs:{type:"primary",icon:"search"},on:{click:e.handleSearch}},[e._v("查询")]),n("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"reload"},on:{click:e.resetQueryParams}},[e._v("重置")])],1)])],1)],1)],1),n("s-table",{ref:"table",attrs:{size:"default",rowKey:"brokerName",columns:e.columns,data:e.loadData,alert:!1,scroll:{x:e.tableX},showPagination:"auto"}})],1)],1),n("a-modal",{attrs:{title:"客户月结单",width:740,visible:e.visible},on:{ok:function(){return t.visible=!1},cancel:function(){return t.visible=!1}}},[n("a-table",{ref:"searchTable",attrs:{size:"default",rowKey:"phoneNo",columns:e.searchColumns,"data-source":e.searchList,alert:!1,pagination:!1}})],1)],1)},s=[],i=a("5530"),r=(a("d3b7"),a("99af"),a("159b"),a("fb6a"),a("2af9")),l=a("f306"),o=a("2f62"),c=[{title:"券商",dataIndex:"brokerName",width:150,ellipsis:!0},{title:"客户",dataIndex:"customerName",width:150,ellipsis:!0},{title:"手机号",dataIndex:"phoneNo",width:150,ellipsis:!0},{title:"是否有效",dataIndex:"status",ellipsis:!0},{title:"备注",dataIndex:"invalidReason",width:150,ellipsis:!0}],u={name:"MonthlyInfo",components:{STable:r["c"]},data:function(){var t=this;return this.searchColumns=c,this.formLayout={labelCol:{md:{span:7},sm:{span:7}},wrapperCol:{md:{span:13},sm:{span:13}}},{spinning:!1,title:"",balanceMonth:"-",dataList:[],curChannelId:"0",isKunPengChannel:!1,queryParam:{},visible:!1,brokers:[],searchList:[],loadData:function(e){var a=Object.assign({},e);return t.dataList.length?new Promise((function(a,n){a(t.getTableList(e,t.dataList))})):(a.channelId=t.curChannelId,a.settlementMonth=t.balanceMonth,l["a"].monthlyDetail(a).then((function(a){return t.dataList=a.detailList,t.getTableList(e,t.dataList)})).catch((function(){})))}}},filters:{},created:function(){var t=this;this.$root.eventHub.$on("refreshView",(function(){t.$refs.table&&t.$refs.table.refresh()})),this.multipleChannel||(this.curChannelId=this.channelOptions[0].value);var e=sessionStorage.getItem("MonthlyInfo");if(e){var a=JSON.parse(e);if(this.balanceMonth=a.dateMonth||a.balanceMonth,this.balanceMonth){var n=this.balanceMonth.substr(0,4),s=this.balanceMonth.substr(4);this.title="".concat(n,"年").concat(s,"月结算明细")}this.curChannelId=a.channelId}this.spinning=!0,l["a"].brokersList({}).then((function(e){t.brokers=e.brokerList})).catch((function(t){})).finally((function(){t.spinning=!1}))},mounted:function(){},beforeRouteLeave:function(t,e,a){this.$root.eventHub.$off("refreshView"),a()},computed:Object(i["a"])(Object(i["a"])({},Object(o["b"])(["channelOptions"])),{},{multipleChannel:function(){return"2"===this.$store.state.user.userType},columns:function(){var t=[];return t.push({title:"券商名称",dataIndex:"brokerName",width:150,ellipsis:!0}),this.isKunPengChannel||(t.push({title:"开户数量",dataIndex:"openNum",customRender:function(t){return t||"-"},width:150,ellipsis:!0}),t.push({title:"开户奖励",dataIndex:"totalOpenAwardAmount",width:150,ellipsis:!0})),t.push({title:"有效入金数量",dataIndex:"validNum",width:150,ellipsis:!0}),t.push({title:"有效入金奖励",dataIndex:"totalUserAwardAmount",width:150,ellipsis:!0}),this.isKunPengChannel||(t.push({title:"融资打新分成(RMB)",dataIndex:"incomePurchaseNew",width:160,ellipsis:!0}),t.push({title:"交易佣金分成(RMB)",dataIndex:"incomeCommission",width:160,ellipsis:!0})),t.push({title:"结算金额(含税)",dataIndex:"balanceAmount",width:150,ellipsis:!0}),t},tableX:function(){var t=0;return this.columns.forEach((function(e){t+=e.width})),t}}),watch:{curChannelId:function(t,e){var a=this;this.isKunPengChannel=!1,this.channelOptions.forEach((function(e){e.value===t&&"12"===e.type&&(a.isKunPengChannel=!0)}))}},methods:{getTableList:function(t,e){var a=t.pageNo,n=t.pageSize,s=(a-1)*n,i=s+n,r=e.slice(s,i);return{totalCount:e.length,data:r,pageNo:+t.pageNo}},switchChannel:function(t){this.dataList=[],this.$refs.table.refresh(!0)},handleSearch:function(){var t=this;if(this.queryParam.brokerId)if(this.queryParam.customerName)if(this.queryParam.phoneNo){this.spinning=!0;var e={channelId:this.curChannelId,settlementMonth:this.insertStr(this.balanceMonth,4,"")};e=Object.assign(e,this.queryParam),l["a"].customerOrder(e).then((function(e){t.searchList=e.customerList||[],t.visible=!0})).catch((function(e){"0001"===e.responseCode&&t.$message.info({content:"没有找到匹配的记录"})})).finally((function(){t.spinning=!1}))}else this.$message.info({content:"请填写客户手机号"});else this.$message.info({content:"请填写客户姓名"});else this.$message.info({content:"请选择券商"})},resetQueryParams:function(){this.queryParam={}},insertStr:function(t,e,a){return t.slice(0,e)+a+t.slice(e)}}},h=u,d=a("2877"),m=Object(d["a"])(h,n,s,!1,null,null,null);e["default"]=m.exports}}]);
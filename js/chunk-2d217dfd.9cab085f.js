(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d217dfd"],{c91b:function(n,e,t){"use strict";t.r(e);var a=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("page-header-wrapper",{attrs:{title:!1}},[t("a-spin",{attrs:{spinning:n.spinning}},[t("a-card",{attrs:{bordered:!1}},[t("a-tabs",{on:{change:n.tabChange},model:{value:n.curTab,callback:function(e){n.curTab=e},expression:"curTab"}},[t("a-tab-pane",{key:"1",attrs:{tab:"个人"}}),t("a-tab-pane",{key:"2",attrs:{tab:"机构"}})],1),t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline",labelCol:{span:6},wrapperCol:{span:18}}},[t("a-row",{attrs:{gutter:24}},["1"===n.curTab?t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"渠道"}},[t("a-select",{staticStyle:{width:"200px"},attrs:{"show-search":"",placeholder:"所有渠道","show-arrow":!0,loading:n.spinning,disabled:!n.channelList.length,"filter-option":n.filterOption},on:{change:n.switchChannel},model:{value:n.curChannelId,callback:function(e){n.curChannelId=e},expression:"curChannelId"}},n._l(n.channelList,(function(e){return t("a-select-option",{key:e.channelId,attrs:{value:e.channelId}},[n._v(" "+n._s(e.channelName)+" ")])})),1)],1)],1):n._e(),"2"===n.curTab?t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"机构"}},[t("a-select",{staticStyle:{width:"200px"},attrs:{"show-search":"",placeholder:"选择机构","show-arrow":!0,loading:n.spinning,disabled:!n.organList.length,"filter-option":n.filterOption},on:{change:n.switchOrgan},model:{value:n.curOrganId,callback:function(e){n.curOrganId=e},expression:"curOrganId"}},n._l(n.organList,(function(e){return t("a-select-option",{key:e.organCode,attrs:{value:e.organCode}},[n._v(" "+n._s(e.organName)+" ")])})),1)],1)],1):n._e(),"2"===n.curTab?t("a-col",{attrs:{md:5,sm:24}},[t("a-form-item",{attrs:{label:"渠道"}},[t("a-select",{staticStyle:{width:"200px"},attrs:{"show-search":"",placeholder:"所有渠道","show-arrow":!0,loading:n.spinning,disabled:!n.organChannelList.length,"filter-option":n.filterOption},on:{change:n.switchChannel},model:{value:n.curOrganChannelId,callback:function(e){n.curOrganChannelId=e},expression:"curOrganChannelId"}},[t("a-select-option",{key:"0",attrs:{value:"0"}},[n._v(" 所有渠道 ")]),n._l(n.organChannelList,(function(e){return t("a-select-option",{key:e.channelId,attrs:{value:e.channelId}},[n._v(" "+n._s(e.channelName)+" ")])}))],2)],1)],1):n._e()],1)],1)],1),t("s-table",{ref:"table",attrs:{size:"default",rowKey:"monthStr",columns:n.columns,data:n.loadData,alert:!1,scroll:{x:n.tableX},showPagination:"auto"},scopedSlots:n._u([{key:"other",fn:function(e,a){return t("span",{},[[t("a-tooltip",{attrs:{placement:"right",overlayStyle:n.toolTipStyle,title:a.otherInfo}},[t("a",[n._v(n._s(e))])])]],2)}},{key:"action",fn:function(e,a){return t("span",{},[[a.isSpecial?n._e():t("a",{on:{click:function(e){return n.handleInfo(a)}}},[n._v("查看详情")])]],2)}}])})],1)],1)],1)},i=[],r=(t("d3b7"),t("159b"),t("b64b"),t("b0c0"),t("fb6a"),t("7db0"),t("c740"),t("99af"),t("b680"),t("a434"),t("a15b"),t("2af9")),o=t("f306"),s={name:"Examine",components:{STable:r["c"]},data:function(){var n=this;return{spinning:!1,toolTipStyle:{whiteSpace:"pre-wrap"},curTab:"1",curChannelId:"",channelList:[],curOrganId:"",organList:[],organChannelList:[],curOrganChannelId:"0",dataList:[],isKunPengChannel:!1,queryParam:{},loadData:function(e){var t="1"===n.curTab?n.curChannelId:n.curOrganChannelId,a={};if("1"===n.curTab){if(!t)return new Promise((function(t,a){t(n.getTableList(e,[]))}));a.channelId=t}else{if(a.organCode=n.curOrganId,!n.curOrganId)return new Promise((function(t,a){t(n.getTableList(e,[]))}));n.curOrganChannelId&&"0"!==n.curOrganChannelId&&(a.channelId=n.curOrganChannelId)}return o["a"].examineMonthlyList(a).then((function(t){var a=n.proxyData(t);return n.dataList=a,n.getTableList(e,a)})).catch((function(){}))}}},filters:{},created:function(){var n=this;this.$root.eventHub.$on("refreshView",(function(){n.$refs.table&&n.$refs.table.refresh()}));var e=sessionStorage.getItem("ExamineSaveInfo");e?(e=JSON.parse(e),Object.keys(e).forEach((function(t){n[t]=e[t]}))):this.getTypeInfo()},beforeRouteLeave:function(n,e,t){this.$root.eventHub.$off("refreshView"),"ExamineInfo"!==n.name?sessionStorage.removeItem("ExamineSaveInfo"):(sessionStorage.setItem("ExamineSaveInfo",JSON.stringify(this.$data)),this.needSave=!0),t()},beforeDestroy:function(){this.needSave||sessionStorage.removeItem("ExamineSaveInfo")},computed:{columns:function(){var n=[];return n.push({title:"结算项",dataIndex:"monthStr",width:120,ellipsis:!0}),n.push({title:"有效入金数量",dataIndex:"validNum",width:120,ellipsis:!0}),this.isKunPengChannel||n.push({title:"开户奖励",dataIndex:"totalOpenAwardAmount",width:130,ellipsis:!0}),n.push({title:"有效入金奖励",dataIndex:"totalUserAwardAmount",width:130,ellipsis:!0}),this.isKunPengChannel||(n.push({title:"融资打新分成(RMB)",dataIndex:"incomePurchaseNew",width:158,ellipsis:!0}),n.push({title:"交易佣金分成(RMB)",dataIndex:"incomeCommission",width:158,ellipsis:!0}),n.push({title:"课程奖励",dataIndex:"subjectAward",width:130,ellipsis:!0}),n.push({title:"其他奖励",dataIndex:"other",width:130,scopedSlots:{customRender:"other"}})),n.push({title:"结算金额(含税)",dataIndex:"balanceAmount",width:140,ellipsis:!0}),n.push({title:"操作",dataIndex:"",width:150,scopedSlots:{customRender:"action"}}),n},tableX:function(){var n=0;return this.columns.forEach((function(e){n+=e.width})),n}},watch:{curChannelId:function(n,e){var t=this;this.isKunPengChannel=!1,this.channelList.forEach((function(e){e.channelId===n&&"12"===e.policyType&&(t.isKunPengChannel=!0)}))},curOrganChannelId:function(n,e){var t=this;this.isKunPengChannel=!1,this.organChannelList.forEach((function(e){e.channelId===n&&"12"===e.policyType&&(t.isKunPengChannel=!0)}))}},methods:{getTableList:function(n,e){var t=n.pageNo,a=n.pageSize,i=(t-1)*a,r=i+a,o=e.slice(i,r);return{totalCount:e.length,data:o,pageNo:+n.pageNo}},handleInfo:function(n){if(n){var e="1"===this.curTab?this.channelList:this.organChannelList,t="1"===this.curTab?this.curChannelId:this.curOrganChannelId,a={channelList:e,curChannelId:t,balanceMonth:n.balanceMonth,curTab:this.curTab,curOrganId:this.curOrganId};sessionStorage.setItem("ExamineInfo",JSON.stringify(a)),this.$router.push({path:"/examine-info"})}},tabChange:function(){var n=this;this.$nextTick((function(){n.getTypeInfo()}))},getTypeInfo:function(){"1"===this.curTab?this.getAllChannels():this.getOrgans()},getAllChannels:function(){var n=this;this.channelList.length?this.getMonthlyList(1):(this.spinning=!0,o["a"].examineChannelList({}).then((function(e){n.channelList=e.channelList,n.curChannelId=n.channelList.length?n.channelList[0].channelId:"",n.getMonthlyList(2)})).catch((function(e){n.curChannelId=""})).finally((function(){n.spinning=!1})))},getOrgans:function(){var n=this;this.organList.length?this.getOrganChannels(1):(this.spinning=!0,o["a"].examineOrganList().then((function(e){n.organList=e.organList,n.curOrganId=n.organList.length?n.organList[0].organCode:"",n.getOrganChannels(2)})).catch((function(e){n.organList=[],n.curOrganId=""})).finally((function(){n.spinning=!1})))},getOrganChannels:function(n){var e=this,t=this.organList.find((function(n){return n.organCode===e.curOrganId}));if(t.channels)this.organChannelList=t.channels,-1===this.organChannelList.findIndex((function(n){return n.channelId===e.curOrganChannelId}))&&(this.curOrganChannelId="0"),this.getMonthlyList(3);else{this.spinning=!0;var a={};"0"!==this.curOrganId&&(a.organCode=this.curOrganId),o["a"].examineChannelList(a).then((function(n){var a=n.channelList;t.channels=a,e.organChannelList=t.channels})).catch((function(n){e.organChannelList=[]})).finally((function(){e.curOrganChannelId="0",e.getMonthlyList(4),e.spinning=!1}))}},switchChannel:function(n){this.$refs.table.refresh(!0)},switchOrgan:function(n){this.getOrganChannels()},getMonthlyList:function(n){this.$refs.table.refresh(!0)},proxyData:function(n){var e=this,t=n.monthlyList;return t.forEach((function(n){n.monthStr=n.balanceMonth;var t=n.balanceMonth;if(t){var a=t.substr(0,4),i=t.substr(4);n.monthStr="".concat(a,"年").concat(i,"月"),n.other=e.getOtherReward(n),n.otherInfo=e.getOtherRewardStr(n)}})),n.specialRecordList&&n.specialRecordList.length&&n.specialRecordList.forEach((function(n){var a=t.findIndex((function(e){return e.balanceMonth<=n.dateMonth}));(a>-1||0===t.length)&&(n.isSpecial=!0,n.monthStr=n.recordTitle,n.insteadOperator=parseFloat((n.insteadOperator/100).toFixed(2)),n.wolfAward=parseFloat((n.wolfAward/100).toFixed(2)),n.subjectAward=parseFloat((n.subjectAward/100).toFixed(2)),n.reachAward=parseFloat((n.reachAward/100).toFixed()),n.balanceAmount=parseFloat((n.balanceAmount/100).toFixed(2)),n.totalOpenAwardAmount=parseFloat((n.totalOpenAwardAmount/100).toFixed(2)),n.totalUserAwardAmount=parseFloat((n.totalUserAwardAmount/100).toFixed(2)),n.incomePurchaseNew=parseFloat((n.incomePurchaseNew/100).toFixed(2)),n.incomeCommission=parseFloat((n.incomeCommission/100).toFixed(2)),n.otherAward=(n.otherAward/100).toFixed(2),n.other=e.getOtherReward(n),n.otherInfo=e.getOtherRewardStr(n),a>-1?t.splice(a,0,n):t.push(n))})),t},getOtherReward:function(n){var e=n.reachAward+n.wolfAward+n.insteadOperator;return n.incomeStockA&&(e+=n.incomeStockA),n.incomeReplenish&&(e+=n.incomeReplenish),n.incomeHkCard&&(e+=n.incomeHkCard),e.toFixed(2)},getOtherRewardStr:function(n){var e=[];return 0!==n.reachAward&&e.push("达量奖励："+n.reachAward.toFixed(2)),0!==n.insteadOperator&&e.push("渠道代运营："+n.insteadOperator.toFixed(2)),0!==n.wolfAward&&e.push("战狼分成奖励："+n.wolfAward.toFixed(2)),n.incomeStockA&&0!==n.incomeStockA&&e.push("A股奖励："+n.incomeStockA.toFixed(2)),n.incomeReplenish&&0!==n.incomeReplenish&&e.push("调账金额："+n.incomeReplenish.toFixed(2)),n.incomeHkCard&&0!==n.incomeHkCard&&e.push("港卡奖励："+n.incomeHkCard.toFixed(2)),e.join("\r\n")},filterOption:function(n,e){return e.componentOptions.children[0].text.toLowerCase().indexOf(n.toLowerCase())>=0}}},l=s,c=t("2877"),h=Object(c["a"])(l,a,i,!1,null,"056805e0",null);e["default"]=h.exports}}]);
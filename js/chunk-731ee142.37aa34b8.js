(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-731ee142"],{ab31:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-header-wrapper",{attrs:{title:!1}},[a("a-spin",{attrs:{spinning:e.spinning}},[a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.handleUpdate()}}},[e._v("添加策略")])],1),a("s-table",{ref:"table",attrs:{size:"default",rowKey:"id",columns:e.columns,data:e.loadData,alert:!1,rowSelection:null,scroll:{x:e.tableX},showPagination:!1},scopedSlots:e._u([{key:"available",fn:function(t,n,i,l){return a("span",{},[a("a-switch",{attrs:{loading:i===e.switchIndex,checked:e._f("available")(t)},on:{change:function(a){return e.onStatusChange(a,t,n,i,l.dataIndex)}}})],1)}},{key:"action",fn:function(t,n,i,l){return a("span",{},[l.dataIndex?[a("a-tooltip",{attrs:{title:l.tip}},[a("a",{staticStyle:{color:"#1890ff"},on:{click:function(t){return e.gotoBondsList(n)}}},[e._v(e._s(t+l.suffix))])])]:[a("a",{staticStyle:{color:"#1890ff"},on:{click:function(t){return e.handleUpdate(n)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{staticStyle:{color:"#f12323"},on:{click:function(t){return e.handleDelete(n)}}},[e._v("删除")])]],2)}}])})],1),a("custom-strategy-edit",{ref:"createModal",attrs:{visible:e.modalVisible,loading:e.confirmLoading,model:e.modalData},on:{cancel:e.onUpdateCancel,ok:e.onUpdateDone}})],1)],1)},i=[],l=a("ade3"),r=a("5530"),o=a("1da1"),s=(a("96cf"),a("159b"),a("d3b7"),a("d81d"),a("4de4"),a("2af9")),u=a("4282"),c=a("ca00"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.title,width:640,maskClosable:!1,visible:e.visible,confirmLoading:e.spinning,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:function(t){e.handleSubmit(t)},cancel:function(){e.handleCancel()}}},[a("a-spin",{attrs:{spinning:e.spinning}},[a("a-form",e._b({attrs:{form:e.form},on:{submit:e.handleSubmit}},"a-form",e.formLayout,!1),[a("a-form-item",{attrs:{label:"策略名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["strategyName",{initialValue:e.model.strategyName,rules:[e.genValidatorRules({max:8}),{validator:e.checkName}]}],expression:"['strategyName', { initialValue: model.strategyName, rules: [genValidatorRules({ max: 8 }), { validator: checkName }] }]"}],attrs:{placeholder:"请输入","allow-clear":""}})],1),a("a-form-item",{attrs:{label:"初始资金",extra:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["principal",{initialValue:e.model._principal,rules:[e.genValidatorRules({type:"number",min:1})]}],expression:"['principal', { initialValue: model._principal, rules: [genValidatorRules({ type: 'number', min: 1 })] }]"}],attrs:{placeholder:"请输入","allow-clear":"","addon-after":"元"}})],1),a("a-form-item",{attrs:{label:"策略简介"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["intro",{initialValue:e.model.intro,rules:[e.genValidatorRules({max:100})]}],expression:"['intro', { initialValue: model.intro, rules: [genValidatorRules({ max: 100 })] }]"}],attrs:{placeholder:"请输入","allow-clear":""}})],1),a("a-form-item",{attrs:{label:"是否上架"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["isActive",{initialValue:e.model.isActive||0,rules:[{required:!0,message:"必填"}]}],expression:"['isActive', { initialValue: model.isActive || 0, rules: [{ required: true, message: '必填' }] }]"}],attrs:{disabled:""}},[a("a-radio",{attrs:{value:1}},[e._v("是")]),a("a-radio",{attrs:{value:0}},[e._v("否")])],1)],1),a("a-form-item",{attrs:{label:"顺序编号"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["sortValue",{initialValue:e.model.sortValue,rules:[e.genValidatorRules({type:"integer",max:9e4})]}],expression:"['sortValue', { initialValue: model.sortValue, rules:[genValidatorRules({ type: 'integer', max: 90000 })] }]"}],attrs:{"allow-clear":"",placeholder:"请输入","max-length":5}})],1)],1)],1)],1)},m=[],f=(a("7db0"),{name:"CustomBondEdit",props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){return this.formLayout={labelCol:{span:4},wrapperCol:{span:20}},{form:this.$form.createForm(this),spinning:!1,editType:0,title:"策略基础信息",submitMethod:"",genValidatorRules:c["i"]}},computed:{},created:function(){var e=this;this.$watch("visible",function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a,n){var i,l,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a&&(e.form.resetFields(),i=e.model,l=i.id,r=i.strategyNames,e.existNames=r,l?(e.editType=1,e.title="编辑策略基础信息",e.submitMethod="cbCustomUpdate"):(e.editType=0,e.title="添加策略",e.submitMethod="cbCustomAdd"));case 1:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())},mounted:function(){},methods:{checkName:function(e,t,a){var n=!1;this.existNames.find((function(e){return t===e}))&&(n=!0),n?a(new Error("策略名称不能与其他策略重复")):a()},handleSubmit:function(e){var t=this;this.form.validateFieldsAndScroll((function(e,a){if(!e){var n=Object.assign({},a);t.editType&&(n.id=t.model.id),n.principal*=1e3;var i=!1;for(var l in n)if(n[l]+""!==t.model[l]+""){i=!0;break}if(!i)return void t.$emit("cancel");var r=t.submitMethod,o=n;t.spinning=!0,u["a"][r](o).then((function(e){t.$message.success("操作成功"),t.$emit("ok",t.model.modalId)})).catch((function(e){})).finally((function(){t.spinning=!1}))}}))},handleCancel:function(){this.$emit("cancel",this.model.modalId)}}}),p=f,b=a("2877"),v=Object(b["a"])(p,d,m,!1,null,null,null),h=v.exports,g=a("f0e3"),w={name:"CustomBonds",components:{STable:s["c"],CustomStrategyEdit:h},data:function(){return this.columns=g["g"],{spinning:!1,modalVisible:!1,confirmLoading:!1,modalData:{},queryParam:{},loadData:this.reqListData,selectedRowKeys:[],selectedRows:[],switchIndex:""}},filters:{available:function(e){return 1===e}},created:function(){var e=this;this.$root.eventHub.$on("refreshView",(function(){e.$refs.table&&e.$refs.table.refresh()})),this.strategyNames=[]},beforeRouteLeave:function(e,t,a){this.$root.eventHub.$off("refreshView"),a()},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}},tableX:function(){var e=0;return this.columns.forEach((function(t){e+=t.width||t.minWidth||0})),e}},methods:{reqListData:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=Object(r["a"])(Object(r["a"])({},t.queryParam),{},{pageNum:e.pageNo,pageSize:e.pageSize}),a.abrupt("return",u["a"].cbCustomList(n).then((function(a){var n=a.result,i=n.customVos||[];t.handleListData(i);var l={totalCount:i.length,pageNo:e.pageNo,data:i};return l})).catch((function(e){})).finally((function(){t.onSelectChange([],[])})));case 2:case"end":return a.stop()}}),a)})))()},handleListData:function(e){this.strategyNames=e.map((function(e){return e.strategyName})),e.forEach((function(e){var t=e.principal;e._principal=Object(c["c"])(t/1e3,2)}))},handleUpdate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.modalVisible=!0;var t=this.strategyNames.filter((function(t){return t!==e.strategyName}));this.modalData=Object(r["a"])(Object(r["a"])({},e),{},{strategyNames:t})},onUpdateDone:function(){this.confirmLoading=!0,this.$refs.table.refresh(),this.onUpdateCancel()},onUpdateCancel:function(){this.modalVisible=!1,this.confirmLoading=!1},handleDelete:function(e){var t=this;this.$confirm({title:"系统提示",content:"确认删除？",okText:"确认",cancelText:"取消",onOk:function(){t.doDelete(e)},onCancel:function(){}})},doDelete:function(e){var t=this,a=[];if(e)a=[e.id];else{if(!this.selectedRowKeys.length)return;a=this.selectedRowKeys}this.spinning=!0,u["a"].cbCustomRemove({ids:a}).then((function(e){t.$refs.table.refresh().then((function(){t.onSelectChange([],[])})),t.$message.info("删除成功")})).catch((function(e){})).finally((function(){t.spinning=!1}))},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},onStatusChange:function(e,t,a,n,i){var r=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var o,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("isRecommend"!==i){e.next=7;break}if(!r.recommendObj){e.next=7;break}return e.next=4,new Promise((function(e,t){return r.$confirm({title:"确定要设为推荐吗？",content:"描述描述。",onOk:function(){e(1)},onCancel:function(){e(0)}})}));case 4:if(o=e.sent,o){e.next=7;break}return e.abrupt("return");case 7:r.switchIndex=n,s=1-t,c=Object(l["a"])({id:a.id},i,s),u["a"].cbCustomUpdateActive(c).then((function(e){a[i]=s})).catch((function(e){})).finally((function(){r.switchIndex=""}));case 11:case"end":return e.stop()}}),e)})))()},gotoBondsList:function(e){this.$router.push({name:"TACustomBondsList",params:e})}}},y=w,x=Object(b["a"])(y,n,i,!1,null,null,null);t["default"]=x.exports},f0e3:function(e,t,a){"use strict";a.d(t,"g",(function(){return i})),a.d(t,"a",(function(){return l})),a.d(t,"f",(function(){return o})),a.d(t,"c",(function(){return u})),a.d(t,"e",(function(){return v})),a.d(t,"i",(function(){return y})),a.d(t,"h",(function(){return R})),a.d(t,"d",(function(){return j})),a.d(t,"b",(function(){return $}));a("99af"),a("4de4");var n=a("ca00"),i=[{title:"顺序编号",dataIndex:"sortValue",width:90,ellipsis:!0,customRender:function(e){return Object(n["g"])(e)}},{title:"策略名称",dataIndex:"strategyName",ellipsis:!1,width:90,customRender:function(e){return Object(n["g"])(e)}},{title:"初始资金",dataIndex:"_principal",ellipsis:!1,width:90,customRender:function(e){return Object(n["g"])(e,"元")}},{title:"创建时间",dataIndex:"createTime",ellipsis:!1,width:110,customRender:function(e){return Object(n["g"])(e)}},{title:"运作天数",dataIndex:"workDays",ellipsis:!1,width:90,customRender:function(e){return Object(n["g"])(e,"天")}},{title:"持仓证券",dataIndex:"bondNums",ellipsis:!1,width:90,scopedSlots:{customRender:"action"},suffix:"支",tip:"点击管理策略持仓"},{title:"上架状态",dataIndex:"isActive",width:90,ellipsis:!0,scopedSlots:{customRender:"available"}},{title:"操作",width:110,scopedSlots:{customRender:"action"}}],l=[{title:"名称代码",dataIndex:"bondName",ellipsis:!1,width:90,customRender:function(e,t){return r(e,t)}},{title:"持仓数量",dataIndex:"stockShares",ellipsis:!1,width:90,customRender:function(e){return Object(n["g"])(e,"股")}},{title:"持仓成本",dataIndex:"_costPrice",ellipsis:!1,width:90,customRender:function(e){return Object(n["g"])(e,"元")}},{title:"条件单设置",dataIndex:"_conditionStr",ellipsis:!1,width:90,scopedSlots:{customRender:"action"},tip:"点击设置条件单"},{title:"仓位调整",width:110,scopedSlots:{customRender:"action"}}];function r(e,t){var a=t.bondName,n=t.bondCode,i="".concat(a,"(").concat(n,")");return i}var o=[{title:"可转债代码",dataIndex:"bondCode",ellipsis:!1,width:90},{title:"可转债名称",dataIndex:"bondName",ellipsis:!1,width:90},{title:"错误原因",dataIndex:"failDes",ellipsis:!1}],s=[{label:"开启",value:1},{label:"关闭",value:0}],u={price:{value:10,label:"价格条件单"},grid:{value:20,label:"网格条件单"}},c=Object(n["h"])(u),d=[{label:"1个交易日",value:1},{label:"5个交易日",value:5},{label:"20个交易日",value:20},{label:"60个交易日",value:60},{label:"长期有效",value:0}],m=[{label:"大于等于",value:1,unit:"≥"},{label:"小于等于",value:0,unit:"≤"}],f=[{label:"买入",value:1},{label:"卖出",value:0}],p=[{label:"无操作",value:10},{label:"立即按最新现价止损清仓(仅触发部分)",value:20}],b=[{label:"无操作",value:10},{label:"立即按最新现价止赢清仓(仅触发部分)",value:20}],v={percent:{value:10,label:"按百分比",unit:"%"},price:{value:20,label:"按差价",unit:"元"}},h=Object(n["h"])(v),g=[{label:"立即",value:0},{label:"回落",value:1}],w=[{label:"立即",value:0},{label:"反弹",value:1}],y={limit:{value:10,label:"限价委托"},market:{value:20,label:"市价委托"},custom:{value:30,label:"自定义价格"}},x=Object(n["h"])(y),O=x.filter((function(e,t){return t<2})),R={amount:{value:10,label:"按股数委托",unit:"股",title:"委托股数"},cost:{value:20,label:"按金额委托",unit:"元",title:"委托金额"}},k=Object(n["h"])(R),C=[{label:"涨停价",value:16},{label:"即时卖五价",value:15},{label:"即时卖四价",value:14},{label:"即时卖三价",value:13},{label:"即时卖二价",value:12},{label:"即时卖一价",value:11},{label:"即时限价",value:0},{label:"即时买一价",value:1},{label:"即时买二价",value:2},{label:"即时买三价",value:3},{label:"即时买四价",value:4},{label:"即时买五价",value:5},{label:"跌停价",value:6}],V=[{label:"最优五档即时成交剩余撤销",value:1},{label:"最优五档即时成交剩余转限",value:2}],N={time:{value:10,label:"监控时段"},deviation:{value:20,label:"偏差控制"},price:{value:30,label:"报价优化"},delay:{value:40,label:"延迟确定"},lowest:{value:50,label:"保底价触发"}},S=[{label:"周一",value:1},{label:"周二",value:2},{label:"周三",value:3},{label:"周四",value:4},{label:"周五",value:5}],j={series:{value:10,label:"连续确认"},Cumulative:{value:20,label:"累计确认"}},I=Object(n["h"])(j),$={activeOpts:s,conditionTypes:u,conditionTypeOpts:c,conditionEndOpts:d,triggerSymbolOpts:m,triggerActionOpts:f,overPriceMinOpts:p,overPriceMaxOpts:b,fluctuateTypes:v,fluctuateOpts:h,riseActionOpts:g,fallActionOpts:w,trustTypeOpts:x,trustTypeOpts2:O,trustModeOpts:k,limitPriceOpts:C,marketPriceOpts:V,advTypes:N,daysInWeek:S,delayTypeOpts:I}}}]);
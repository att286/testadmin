(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4e81b386"],{"15fd":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("a4d3"),a("b64b");function r(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}function n(e,t){if(null==e)return{};var a,n,o=r(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}},8593:function(e,t,a){"use strict";var r=a("a417"),n="https://platform.xincaitong.com/WtPlatformSysWeb/sysPlatform.jhtml",o=Object({NODE_ENV:"production",VUE_APP_PREVIEW:"false",VUE_APP_OUTPUT:"",VUE_APP_API_BASE:"https://mservice.xincaitong.com/KolPlatformWeb/kolPlatform.jhtml",VUE_APP_API_SYSTEM:"https://platform.xincaitong.com/WtPlatformSysWeb/sysPlatform.jhtml",VUE_APP_API_SMS:"https://mservice.xincaitong.com/WtSmsCenter/sms.jhtml",VUE_APP_API_RECORD:"https://mservice.xincaitong.com/WtDataWeb/data.jhtml",VUE_APP_API_TA:"https://margin.xincaitong.com/WtmpGateway",VUE_APP_API_ETFGRID:"https://mservice.xincaitong.com/WtPhoenixGateway/",VUE_APP_API_WX:"https://mservice.xincaitong.com/WtWxPluginWeb/wx.jhtml",VUE_APP_API_MOCK_URL:"/api",BASE_URL:""}).VUE_APP_GAMEID||"eagleeye";function l(e){var t=r["b"].network(e,n);return t}function s(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"1.0",n=r["b"].genParams(o,e,t,a);return n}t["a"]={captchaImage:function(e){var t=s("captchaImage",e);return l(t)},login:function(e){var t=s("login",e);return l(t)},updatePwd:function(e){var t=s("updatePwd",e);return l(t)},resetPwd:function(e){var t=s("resetPwd",e);return l(t)},userList:function(e){var t=s("userList",e);return l(t)},addUser:function(e){var t=s("addUser",e);return l(t)},userInfo:function(e){var t=s("userInfo",e);return l(t)},updateUser:function(e){var t=s("updateUser",e);return l(t)},deleteUsers:function(e){var t=s("batchRemoveUser",e);return l(t)},postList:function(e){var t=s("postList",e);return l(t)},addPost:function(e){var t=s("addPost",e);return l(t)},postInfo:function(e){var t=s("postInfo",e);return l(t)},updatePost:function(e){var t=s("updatePost",e);return l(t)},deletePosts:function(e){var t=s("batchRemovePost",e);return l(t)},deptList:function(e){var t=s("deptList",e);return l(t)},addDept:function(e){var t=s("addDept",e);return l(t)},deptInfo:function(e){var t=s("deptInfo",e);return l(t)},updateDept:function(e){var t=s("updateDept",e);return l(t)},deleteDept:function(e){var t=s("removeDept",e);return l(t)},menuList:function(e){var t=s("menuList",e);return l(t)},addMenu:function(e){var t=s("addMenu",e);return l(t)},menuInfo:function(e){var t=s("menuInfo",e);return l(t)},updateMenu:function(e){var t=s("updateMenu",e);return l(t)},deleteMenu:function(e){var t=s("removeMenu",e);return l(t)},logoout:function(e){var t=s("logout",e);return l(t)},simpleRoleList:function(e){var t=s("roleBriefList",e);return l(t)},roleList:function(e){var t=s("roleList",e);return l(t)},addRole:function(e){var t=s("addRole",e);return l(t)},updateRole:function(e){var t=s("updateRole",e);return l(t)},deleteRoles:function(e){var t=s("batchRemoveRole",e);return l(t)},roleMenuData:function(e){var t=s("roleMenuTreeSelect",e);return l(t)},roleUsersAssociated:function(e){var t=s("allocatedList",e);return l(t)},roleUsersUnassociated:function(e){var t=s("unallocatedList",e);return l(t)},associateRoleUsers:function(e){var t=s("selectAuthUserAll",e);return l(t)},disassociateRoleUsers:function(e){var t=s("cancelAuthUserAll",e);return l(t)}}},"88bc":function(e,t,a){(function(t){var a=1/0,r=9007199254740991,n="[object Arguments]",o="[object Function]",l="[object GeneratorFunction]",s="[object Symbol]",i="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,u=i||c||Function("return this")();function d(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}function f(e,t){var a=-1,r=e?e.length:0,n=Array(r);while(++a<r)n[a]=t(e[a],a,e);return n}function m(e,t){var a=-1,r=t.length,n=e.length;while(++a<r)e[n+a]=t[a];return e}var h=Object.prototype,p=h.hasOwnProperty,v=h.toString,b=u.Symbol,y=h.propertyIsEnumerable,g=b?b.isConcatSpreadable:void 0,w=Math.max;function P(e,t,a,r,n){var o=-1,l=e.length;a||(a=k),n||(n=[]);while(++o<l){var s=e[o];t>0&&a(s)?t>1?P(s,t-1,a,r,n):m(n,s):r||(n[n.length]=s)}return n}function R(e,t){return e=Object(e),I(e,t,(function(t,a){return a in e}))}function I(e,t,a){var r=-1,n=t.length,o={};while(++r<n){var l=t[r],s=e[l];a(s,l)&&(o[l]=s)}return o}function x(e,t){return t=w(void 0===t?e.length-1:t,0),function(){var a=arguments,r=-1,n=w(a.length-t,0),o=Array(n);while(++r<n)o[r]=a[t+r];r=-1;var l=Array(t+1);while(++r<t)l[r]=a[r];return l[t]=o,d(e,this,l)}}function k(e){return D(e)||S(e)||!!(g&&e&&e[g])}function _(e){if("string"==typeof e||j(e))return e;var t=e+"";return"0"==t&&1/e==-a?"-0":t}function S(e){return C(e)&&p.call(e,"callee")&&(!y.call(e,"callee")||v.call(e)==n)}var D=Array.isArray;function K(e){return null!=e&&L(e.length)&&!U(e)}function C(e){return O(e)&&K(e)}function U(e){var t=$(e)?v.call(e):"";return t==o||t==l}function L(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}function $(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function O(e){return!!e&&"object"==typeof e}function j(e){return"symbol"==typeof e||O(e)&&v.call(e)==s}var N=x((function(e,t){return null==e?{}:R(e,f(P(t,1),_))}));e.exports=N}).call(this,a("c8ba"))},f619:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page-header-wrapper",{attrs:{title:!1}},[a("a-spin",{attrs:{spinning:e.spinning}},[a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{md:4,sm:24}},[a("a-form-item",{attrs:{label:"角色名称"}},[a("a-input",{attrs:{"allow-clear":"",placeholder:""},model:{value:e.queryParam.roleName,callback:function(t){e.$set(e.queryParam,"roleName",t)},expression:"queryParam.roleName"}})],1)],1),a("a-col",{attrs:{md:4,sm:24}},[a("a-form-item",{attrs:{label:"权限字符"}},[a("a-input",{attrs:{"allow-clear":"",placeholder:""},model:{value:e.queryParam.roleKey,callback:function(t){e.$set(e.queryParam,"roleKey",t)},expression:"queryParam.roleKey"}})],1)],1),a("a-col",{attrs:{md:4,sm:24}},[a("a-form-item",{attrs:{label:"角色状态"}},[a("a-select",{attrs:{allowClear:"",placeholder:"请选择"},model:{value:e.queryParam.status,callback:function(t){e.$set(e.queryParam,"status",t)},expression:"queryParam.status"}},[a("a-select-option",{attrs:{value:"0"}},[e._v("正常")]),a("a-select-option",{attrs:{value:"1"}},[e._v("停用")])],1)],1)],1),a("a-col",{attrs:{md:4,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"reload"},on:{click:e.resetQueryParams}},[e._v("重置")])],1)])],1)],1)],1),a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("添加")]),a("a-button",{attrs:{type:"primary",icon:"edit",disabled:1!==e.selectedRowKeys.length},on:{click:function(t){return e.handleEdit()}}},[e._v("修改")]),a("a-button",{attrs:{type:"primary",icon:"delete",disabled:0===e.selectedRowKeys.length},on:{click:function(t){return e.handleDelete()}}},[e._v("删除")])],1),a("s-table",{ref:"table",attrs:{size:"default",rowKey:"roleId",columns:e.columns,data:e.loadData,alert:!1,rowSelection:e.rowSelection,showPagination:"auto"},scopedSlots:e._u([{key:"available",fn:function(t,r,n){return a("span",{},[a("a-switch",{attrs:{loading:n===e.switchIndex,checked:e._f("available")(r)},on:{change:function(a){return e.onStatusChange(a,t,r,n,"status")}}})],1)}},{key:"action",fn:function(t,r){return a("span",{},[[a("a",{on:{click:function(t){return e.handleEdit(r)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.showRoleUser(r)}}},[e._v("分配用户")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.handleDelete(r)}}},[e._v("删除")])]],2)}}])})],1)],1),a("role-edit",{ref:"createModal",attrs:{visible:e.modalVisible,loading:e.confirmLoading,model:e.modalData},on:{cancel:e.handleCancel,ok:e.handleOk}}),a("role-user",{ref:"roleUserModal",attrs:{visible:e.roleUserVisible,model:e.roleUserData},on:{cancel:e.hideRoleUser}})],1)},n=[],o=a("ade3"),l=a("15fd"),s=a("5530"),i=(a("a15b"),a("d3b7"),a("2af9")),c=a("8593"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.editType,width:740,maskClosable:!1,visible:e.visible,confirmLoading:e.loading,centered:!0,bodyStyle:{maxHeight:"80vh",overflowY:"auto"}},on:{ok:function(){e.$emit("ok")},cancel:function(){e.$emit("cancel")}}},[a("a-spin",{attrs:{spinning:e.loading||e.isLoading}},[a("a-form",e._b({attrs:{form:e.form}},"a-form",e.formLayout,!1),[a("a-row",{attrs:{gutter:1}},[a("a-col",{attrs:{span:12}},[a("a-form-item",e._b({attrs:{label:"角色名称"}},"a-form-item",e.formLayout1,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["roleName",{initialValue:e.model.roleName,rules:[{required:!0,message:"必填"}]}],expression:"['roleName', { initialValue: model.roleName, rules: [{ required: true, message: '必填' }] }]"}],attrs:{name:"roleName",placeholder:"请输入角色名称","allow-clear":""}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",e._b({attrs:{label:"显示顺序"}},"a-form-item",e.formLayout1,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["roleSort",{initialValue:e.model.roleSort,rules:[{required:!0,message:"必填"}]}],expression:"['roleSort', { initialValue: model.roleSort, rules: [{ required: true, message: '必填' }] }]"}],attrs:{name:"roleSort",placeholder:"请输入显示顺序","allow-clear":""}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",e._b({attrs:{label:"权限字符"}},"a-form-item",e.formLayout1,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["roleKey",{initialValue:e.model.roleKey,rules:[{required:!0,message:"必填"}]}],expression:"['roleKey', { initialValue: model.roleKey, rules: [{ required: true, message: '必填' }] }]"}],attrs:{name:"roleKey",placeholder:"请输入权限字符","allow-clear":""}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",e._b({attrs:{label:"备注"}},"a-form-item",e.formLayout1,!1),[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark",{initialValue:e.model.remark}],expression:"['remark', { initialValue: model.remark }]"}],attrs:{name:"remark",placeholder:"请输入备注","allow-clear":""}})],1)],1)],1),a("a-form-item",{attrs:{label:"菜单权限"}},[a("a-tree-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["checkedMenu",{initialValue:e.model.checkedMenu}],expression:"['checkedMenu', { initialValue: model.checkedMenu }]"}],attrs:{name:"checkedMenu",placeholder:"请选择菜单权限","allow-clear":"","show-search":"",multiple:"","tree-checkable":"","show-checked-strategy":"SHOW_ALL",treeNodeFilterProp:"label",treeData:e.menuData,treeDefaultExpandedKeys:["0"]},on:{change:e.onTreeChange,select:e.onTreeSelect}})],1),a("a-form-item",{attrs:{label:"是否有效"}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["status",{initialValue:e.model.status||"0",rules:[{required:!0,message:"必填"}]}],expression:"['status', { initialValue: model.status || '0', rules: [{ required: true, message: '必填' }] }]"}]},[a("a-radio",{attrs:{value:"0"}},[e._v("是")]),a("a-radio",{attrs:{value:"1"}},[e._v("否")])],1)],1)],1)],1)],1)},d=[],f=a("b85c"),m=a("2909"),h=(a("d81d"),a("caad"),a("2532"),a("a434"),a("88bc")),p=a.n(h),v=["roleName","roleKey","roleSort","status"],b={props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){return this.formLayout={labelCol:{md:{span:4},xs:{span:24}},wrapperCol:{md:{span:20},xs:{span:24}}},this.formLayout1={labelCol:{md:{span:8},xs:{span:24}},wrapperCol:{md:{span:16},xs:{span:24}}},{isLoading:!1,menuData:[],form:this.$form.createForm(this),editType:"添加"}},created:function(){var e=this;v.forEach((function(t){return e.form.getFieldDecorator(t)})),this.$watch("visible",(function(t,a){t&&(e.form.setFieldsValue(p()(e.model,v)),e.editType=e.model.id?"修改":"添加",e.getMenuData())}))},methods:{getMenuData:function(){var e=this;this.isLoading=!0;var t={roleId:this.model.roleId};c["a"].roleMenuData(t).then((function(t){e.menuInfo={},e.menuData=e.handleMenus(t.menus),e.handleKeysServer(t.checkedKeys)})).catch((function(){})).finally((function(){e.isLoading=!1}))},handleMenus:function(e,t,a){var r=this;if(!e)return[];var n=e.map((function(e){var n={value:e.id,label:e.label};return r.menuInfo[e.id]||(r.menuInfo[e.id]={id:e.id,name:e.label,pId:t,pName:a,children:[]}),t&&r.menuInfo[t].children.push({id:e.id,name:e.label}),n.children=r.handleMenus(e.children,e.id,e.label),n}));return n},handleKeysLocal:function(e){var t,a=Object(m["a"])(e),r=Object(f["a"])(a);try{for(r.s();!(t=r.n()).done;){var n=t.value,o=this.menuInfo[n].pId;o&&!a.includes(o)&&a.push(o)}}catch(l){r.e(l)}finally{r.f()}this.model.fullKeys=a},handleKeysServer:function(e){var t,a={},r=Object(f["a"])(e);try{for(r.s();!(t=r.n()).done;){var n=t.value,o=this.menuInfo[n].pId;o&&e.includes(o)&&(a[o]=a[o]||0,a[o]++)}}catch(i){r.e(i)}finally{r.f()}var l=Object(m["a"])(e);for(var s in a)this.menuInfo[s].children.length&&l.splice(l.indexOf(s),1);this.model.checkedMenu=l,this.handleKeysLocal(l)},onTreeChange:function(e,t,a){this.handleKeysLocal(e)},onTreeSelect:function(e,t,a){}}},y=b,g=a("2877"),w=Object(g["a"])(y,u,d,!1,null,null,null),P=w.exports,R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"授权用户管理",width:940,maskClosable:!0,visible:e.visible,centered:!0,bodyStyle:{maxHeight:"90vh",overflowY:"auto"},footer:null},on:{cancel:function(){e.$emit("cancel")}}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"登录名称"}},[a("a-input",{attrs:{"allow-clear":"",placeholder:""},model:{value:e.queryParam.userName,callback:function(t){e.$set(e.queryParam,"userName",t)},expression:"queryParam.userName"}})],1)],1),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"手机号"}},[a("a-input",{attrs:{"allow-clear":"",placeholder:""},model:{value:e.queryParam.phonenumber,callback:function(t){e.$set(e.queryParam,"phonenumber",t)},expression:"queryParam.phonenumber"}})],1)],1),a("a-col",{attrs:{md:4,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"reload"},on:{click:e.resetQueryParams}},[e._v("重置")])],1)])],1)],1)],1),a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("添加用户")]),a("a-button",{attrs:{type:"primary",icon:"delete",disabled:0===e.selectedRowKeys.length},on:{click:function(t){return e.handleDelete()}}},[e._v("取消授权")])],1),a("s-table",{ref:"table",attrs:{size:"small",rowKey:"userId",columns:e.columns,data:e.loadData,alert:!1,rowSelection:e.rowSelection,customRow:e.onRowEvent,pageSizeOptions:["10","20","50","100"],pageSize:10,showPagination:"auto"},scopedSlots:e._u([{key:"available",fn:function(t){return a("span",{},[a("a-badge",{attrs:{color:e._f("statusColor")(t),text:e._f("statusText")(t)}})],1)}},{key:"action",fn:function(t,r){return a("span",{},[[a("a",{on:{click:function(t){return e.handleDelete(r)}}},[e._v("取消授权")])]],2)}}])}),a("role-user-manage",{ref:"createModal",attrs:{visible:e.modalVisible,loading:e.confirmLoading,model:e.modalData},on:{cancel:e.handleCancel,ok:e.handleOk}})],1)},I=[],x=(a("c740"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"选择授权用户",width:940,maskClosable:!0,visible:e.visible,centered:!0,bodyStyle:{maxHeight:"90vh",overflowY:"auto"}},on:{ok:function(){e.$emit("ok")},cancel:function(){e.$emit("cancel")}}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"登录名称"}},[a("a-input",{attrs:{"allow-clear":"",placeholder:""},model:{value:e.queryParam.userName,callback:function(t){e.$set(e.queryParam,"userName",t)},expression:"queryParam.userName"}})],1)],1),a("a-col",{attrs:{md:6,sm:24}},[a("a-form-item",{attrs:{label:"手机号"}},[a("a-input",{attrs:{"allow-clear":"",placeholder:""},model:{value:e.queryParam.phonenumber,callback:function(t){e.$set(e.queryParam,"phonenumber",t)},expression:"queryParam.phonenumber"}})],1)],1),a("a-col",{attrs:{md:4,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:function(t){return e.$refs.table.refresh(!0)}}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"reload"},on:{click:e.resetQueryParams}},[e._v("重置")])],1)])],1)],1)],1),a("s-table",{ref:"table",attrs:{size:"small",rowKey:"userId",columns:e.columns,data:e.loadData,alert:!1,rowSelection:e.rowSelection,customRow:e.onRowEvent,pageSizeOptions:["10","20","50","100"],pageSize:10,showPagination:"auto"},scopedSlots:e._u([{key:"available",fn:function(t){return a("span",{},[a("a-badge",{attrs:{color:e._f("statusColor")(t),text:e._f("statusText")(t)}})],1)}}])})],1)}),k=[],_=[{title:"登录名称",dataIndex:"userName",ellipsis:!0},{title:"用户名称",dataIndex:"nickName",ellipsis:!0},{title:"邮箱",dataIndex:"email",ellipsis:!0},{title:"手机",dataIndex:"phonenumber",ellipsis:!0},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"available"},ellipsis:!0}],S={name:"RoleUserManage",components:{STable:i["c"]},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){var e=this;return this.columns=_,{queryParam:{},loadData:function(t){var a=Object(s["a"])({roleId:e.model.roleId,pageNum:t.pageNo,pageSize:t.pageSize},e.queryParam);return c["a"].roleUsersUnassociated(a).then((function(e){if("0000"===e.responseCode)return e.totalCount=+e.total,e.pageNo=+t.pageNo,e.data=e.userList,e})).catch((function(){}))},selectedRowKeys:[],selectedRows:[]}},filters:{statusText:function(e){return"0"===e?"正常":"停用"},statusColor:function(e){return"0"===e?"blue":"red"}},created:function(){var e=this;this.$watch("visible",(function(t,a){t&&e.$nextTick((function(){e.$refs.table.refresh(1)}))})),this.$watch("selectedRowKeys",(function(t,a){e.model.checkedUser=t}))},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},methods:{onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},onRowEvent:function(e,t){var a=this;return{on:{click:function(){var t=a.selectedRowKeys.findIndex((function(t){return t===e.userId}));t>-1?(a.selectedRowKeys.splice(t,1),a.selectedRows.splice(t,1)):(a.selectedRowKeys.push(e.userId),a.selectedRows.push(e))}}}},resetQueryParams:function(){this.queryParam={},this.$refs.table.refresh(!0)}}},D=S,K=Object(g["a"])(D,x,k,!1,null,null,null),C=K.exports,U=[{title:"登录名称",dataIndex:"userName",ellipsis:!0},{title:"用户名称",dataIndex:"nickName",ellipsis:!0},{title:"邮箱",dataIndex:"email",ellipsis:!0},{title:"手机",dataIndex:"phonenumber",ellipsis:!0},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"available"},ellipsis:!0},{title:"操作",scopedSlots:{customRender:"action"}}],L={name:"RoleUser",components:{STable:i["c"],RoleUserManage:C},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},model:{type:Object,default:function(){}}},data:function(){var e=this;return this.columns=U,{modalVisible:!1,confirmLoading:!1,modalData:{},queryParam:{},loadData:function(t){var a=Object(s["a"])({roleId:e.model.roleId,pageNum:t.pageNo,pageSize:t.pageSize},e.queryParam);return c["a"].roleUsersAssociated(a).then((function(e){if("0000"===e.responseCode)return e.totalCount=+e.total,e.pageNo=+t.pageNo,e.data=e.userList,e})).catch((function(){}))},selectedRowKeys:[],selectedRows:[]}},filters:{statusText:function(e){return"0"===e?"正常":"停用"},statusColor:function(e){return"0"===e?"blue":"red"}},created:function(){var e=this;this.$watch("visible",(function(t,a){t&&e.$nextTick((function(){e.$refs.table.refresh(1)}))}))},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},methods:{handleAdd:function(){this.modalVisible=!0,this.modalData={roleId:this.model.roleId}},handleDelete:function(e){var t=this;this.$confirm({title:"系统提示",content:"确认要取消".concat(e?"此":"选中的".concat(this.selectedRowKeys.length,"名"),"用户的授权吗？"),okText:"确认",cancelText:"取消",onOk:function(){t.doDelete(e)},onCancel:function(){}})},doDelete:function(e){var t=this,a="";if(e)a=e.userId;else{if(!this.selectedRowKeys.length)return;a=this.selectedRowKeys.join(",")}c["a"].disassociateRoleUsers({roleId:this.model.roleId,userIds:a}).then((function(e){t.$refs.table.refresh(),t.$message.info("取消授权成功")}))},handleOk:function(){var e=this,t=this.modalData.checkedUser;if(t){var a=this.modalData.roleId,r="associateRoleUsers",n={};n.roleId=a,n.userIds=t.join(","),this.confirmLoading=!0,c["a"][r](n).then((function(t){e.$message.info("操作成功"),e.handleCancel(),e.$refs.table.refresh()})).catch((function(){e.confirmLoading=!1}))}},handleCancel:function(){this.modalVisible=!1,this.confirmLoading=!1,this.modalData={}},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},onRowEvent:function(e,t){var a=this;return{on:{click:function(){var t=a.selectedRowKeys.findIndex((function(t){return t===e.userId}));t>-1?(a.selectedRowKeys.splice(t,1),a.selectedRows.splice(t,1)):(a.selectedRowKeys.push(e.userId),a.selectedRows.push(e))}}}},resetQueryParams:function(){this.queryParam={},this.$refs.table.refresh(!0)}}},$=L,O=Object(g["a"])($,R,I,!1,null,null,null),j=O.exports,N=[{title:"角色名称",dataIndex:"roleName",ellipsis:!0},{title:"权限字符",dataIndex:"roleKey",ellipsis:!0},{title:"显示顺序",dataIndex:"roleSort",ellipsis:!0},{title:"角色状态",dataIndex:"status",scopedSlots:{customRender:"available"},ellipsis:!0},{title:"操作",scopedSlots:{customRender:"action"}}],q={name:"Role",components:{STable:i["c"],RoleEdit:P,RoleUser:j},data:function(){var e=this;return this.columns=N,{spinning:!1,roleUserVisible:!1,roleUserData:{},modalVisible:!1,confirmLoading:!1,modalData:{},queryParam:{},loadData:function(t){var a=Object.assign({},t,e.queryParam);return a.pageNum=t.pageNo,delete a.pageNo,c["a"].roleList(a).then((function(a){if("0000"===a.responseCode)return a.totalCount=+a.total,a.pageNo=+t.pageNo,a.data=a.roleList,e.onSelectChange([],[]),a})).catch((function(){}))},selectedRowKeys:[],selectedRows:[],switchIndex:""}},filters:{available:function(e){return"0"===e.status}},created:function(){var e=this;this.$root.eventHub.$on("refreshView",(function(){e.$refs.table&&e.$refs.table.refresh()}))},beforeRouteLeave:function(e,t,a){this.$root.eventHub.$off("refreshView"),a()},computed:{rowSelection:function(){return{selectedRowKeys:this.selectedRowKeys,onChange:this.onSelectChange}}},methods:{handleAdd:function(){this.modalVisible=!0,this.modalData={}},handleEdit:function(e){if(e);else{if(!this.selectedRowKeys.length)return;e=this.selectedRows[0]}this.modalVisible=!0,this.modalData=Object(s["a"])({},e)},handleDelete:function(e){var t=this;this.$confirm({title:"系统提示",content:"确认要删除".concat(e?"该":"选中的".concat(this.selectedRowKeys.length),"条数据吗？"),okText:"确认",cancelText:"取消",onOk:function(){t.doDelete(e)},onCancel:function(){}})},doDelete:function(e){var t=this,a="";if(e)a=e.roleId;else{if(!this.selectedRowKeys.length)return;a=this.selectedRowKeys.join(",")}c["a"].deleteRoles({roleIds:a}).then((function(e){t.$refs.table.refresh(),t.$message.info("删除成功")}))},handleOk:function(){var e=this,t=this.$refs.createModal.form;this.confirmLoading=!0,t.validateFields((function(t,a){if(t)e.confirmLoading=!1;else{var r=e.modalData.roleId,n=r?"updateRole":"addRole",o=(a.checkedMenu,Object(l["a"])(a,["checkedMenu"])),s=e.modalData.fullKeys;r&&(o.roleId=r),s&&(o.menuIds=s.join(",")),c["a"][n](o).then((function(t){e.$message.info("操作成功"),e.handleCancel(),e.$refs.table.refresh()})).catch((function(){e.confirmLoading=!1}))}}))},handleCancel:function(){this.modalVisible=!1,this.confirmLoading=!1,this.modalData={};var e=this.$refs.createModal.form;e.resetFields()},showRoleUser:function(e){this.roleUserData=Object(s["a"])({},e),this.roleUserVisible=!0},hideRoleUser:function(){this.roleUserVisible=!1},onSelectChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},onStatusChange:function(e,t,a,r,n){var l=this;this.switchIndex=r;var s=Object(o["a"])({roleId:a.roleId},n,"0"===a[n]?"1":"0");c["a"].updateRole(s).then((function(e){a[n]="0"===a[n]?"1":"0"})).finally((function(){l.switchIndex=""}))},resetQueryParams:function(){this.queryParam={},this.$refs.table.refresh(!0)}}},V=q,A=Object(g["a"])(V,r,n,!1,null,null,null);t["default"]=A.exports}}]);
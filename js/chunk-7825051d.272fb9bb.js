(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7825051d"],{"330f":function(t,a,e){"use strict";var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("a-select",{ref:"select",attrs:{size:"default",allowClear:"",showSearch:"",placeholder:"请选择",optionFilterProp:"children",defaultValue:t.initValue,showArrow:!0,mode:t.mode},on:{popupScroll:t.handlePopupScroll,search:t.handleSearch,change:t.onChange}},t._l(t.frontDataZ,(function(a){return e("a-select-option",{key:a.value,attrs:{value:a.value}},[t._v(t._s(a.label))])})),1)},r=[],i=(e("fb6a"),e("c740"),e("159b"),{props:{dataList:{type:Array,default:function(){return[]}},decorator:{type:Array,default:function(){return[]}},mode:{type:String,default:"default"},initValue:{type:String,default:void 0}},data:function(){return{dataZ:[],frontDataZ:[],valueData:"",treePageSize:100,scrollPage:1}},watch:{dataList:function(t){this.dataZ=t,this.dataZ&&(this.frontDataZ=this.dataZ.slice(0,100))}},created:function(){this.dataZ=this.dataList,this.dataZ&&(this.frontDataZ=this.dataZ.slice(0,100))},mounted:function(){},methods:{setValue:function(t){if(t){var a=this.dataZ.findIndex((function(a){return a.value===t}));a&&(this.frontDataZ=this.dataZ.slice(a,a+100),this.$emit("change",t))}},onChange:function(t){this.$emit("change",t)},handleSearch:function(t){var a=this;this.valueData=t,t?(this.frontDataZ=[],this.scrollPage=1,this.dataZ.forEach((function(e){e.label.indexOf(t)>-1&&a.frontDataZ.push(e)})),this.allDataZ=this.frontDataZ,this.frontDataZ=this.frontDataZ.slice(0,100)):this.frontDataZ=this.dataZ.slice(0,100)},handlePopupScroll:function(t){var a=t.target,e=a.scrollHeight-a.scrollTop,n=a.clientHeight;if(0===e&&0===n)this.scrollPage=1;else if(e<n+5){this.scrollPage++;var r=this.scrollPage,i=this.treePageSize*(r||1),l=[],s="";s=this.dataZ.length>i?i:this.dataZ.length,this.valueData?this.allDataZ.forEach((function(t,a){a<s&&l.push(t)})):this.dataZ.forEach((function(t,a){a<s&&l.push(t)})),this.frontDataZ=l}}}}),l=i,s=e("2877"),o=Object(s["a"])(l,n,r,!1,null,null,null);a["a"]=o.exports},"877b":function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("page-header-wrapper",{attrs:{title:!1}},[e("channel-selector",{on:{change:t.onChannelChange},model:{value:t.curChannelId,callback:function(a){t.curChannelId=a},expression:"curChannelId"}}),e("a-space",{staticStyle:{width:"100%"},attrs:{direction:"vertical"}},[e("a-card",[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"搜索主题"}},[e("a-input",{attrs:{placeholder:"请输入",allowClear:""},model:{value:t.queryParam.liveTheme,callback:function(a){t.$set(t.queryParam,"liveTheme",a)},expression:"queryParam.liveTheme"}})],1)],1),e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"时间范围"}},[e("a-range-picker",{attrs:{placeholder:["开始时间","结束时间"],format:"MM-DD"},model:{value:t.dates,callback:function(a){t.dates=a},expression:"dates"}})],1)],1),e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"直播方式"}},[e("a-select",{attrs:{options:t.liveModeOptions,placeholder:"全部",allowClear:""},model:{value:t.queryParam.liveMode,callback:function(a){t.$set(t.queryParam,"liveMode",a)},expression:"queryParam.liveMode"}})],1)],1),e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"直播间状态"}},[e("a-select",{attrs:{options:t.liveStateOptions,placeholder:"全部",allowClear:""},model:{value:t.queryParam.liveState,callback:function(a){t.$set(t.queryParam,"liveState",a)},expression:"queryParam.liveState"}})],1)],1),e("a-col",{attrs:{md:4,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons"},[e("a-button",{attrs:{type:"primary",icon:"search"},on:{click:t.updateData}},[t._v("查询")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"reload"},on:{click:t.resetQueryParams}},[t._v("重置")])],1)])],1)],1)],1)]),e("a-card",[e("h3",[t._v("筛选结果")]),e("a-spin",{attrs:{spinning:t.spinning}},[e("a-row",{attrs:{type:"flex",justify:"space-around",align:"middle"}},[t._l(t.totalDatas,(function(a,n){return[e("a-col",{key:n,attrs:{span:3}},[e("div",{staticClass:"totalDataItem column-start-center"},[e("a-tooltip",{attrs:{title:a.tip}},[e("div",{staticClass:"title row-center-center"},[t._v(t._s(a.title)),a.tip?e("a-icon",{staticStyle:{"margin-left":"10px"},attrs:{type:"info-circle"}}):t._e()],1),e("a-statistic",{attrs:{value:a.customRender?a.customRender(a.value):a.value,precision:"amount"==a.dataType?2:0,suffix:(a.dataType,""),valueStyle:"text-align:center;"}})],1)],1)]),n!=t.totalDatas.length-1?e("a-col",{key:"line"+n,staticClass:"row-center-center",attrs:{span:0}},[e("a-divider",{staticStyle:{height:"40px"},attrs:{type:"vertical"}})],1):t._e()]}))],2)],1)],1),e("a-card",[e("s-table",{ref:"table",attrs:{size:"default",rowKey:"roomId",columns:t.columns,data:t.loadData,alert:!1,showPagination:"auto",scroll:{x:t.tableX}},scopedSlots:t._u([{key:"theme",fn:function(a,n){return e("span",{},[[n.liveState>0?e("a",{on:{click:function(a){return t.handleInfo(n)}}},[t._v(t._s(a))]):e("span",[t._v(t._s(a))])]],2)}},{key:"action",fn:function(a,n){return e("span",{},[[n.liveState>0?e("a",{on:{click:function(a){return t.handleInfo(n)}}},[t._v("查看详情")]):t._e()]],2)}}])})],1)],1)],1)},r=[],i=(e("159b"),e("c740"),e("d81d"),e("2af9")),l=e("ac8a"),s=e("330f"),o=e("0970"),c=e("4360"),u=e("4ae6"),d={name:"LiveData",components:{STable:i["c"],MySelect:s["a"],ChannelSelector:l["a"]},computed:{tableX:function(){var t=0;return this.columns.forEach((function(a){t+=a.width||100})),t},isOrgan:function(){var t=c["a"].getters.roles;return t.findIndex((function(t){return"institution"===t.roleKey}))>-1},columns:function(){return this.isOrgan?u["i"]:u["h"]}},data:function(){var t=this;return{spinning:!1,curChannelId:"",queryParam:{},dates:[],liveModeOptions:u["g"],liveStateOptions:u["j"],totalDatas:{},loadData:function(a){var e=t.curChannelId,n=t.dates,r=Object.assign({channelId:"0"===e?"":e},a,t.queryParam);return r.pageNum=a.pageNo,delete r.pageNo,void 0===r.liveMode&&(r.liveMode=-1),void 0===r.liveState&&(r.liveState=-1),n[0]&&n[1]&&(r.startDate=n[0].set("hour",0).set("minute",0).set("second",0).format("YYYY-MM-DD HH:mm:ss"),r.endDate=n[1].set("hour",23).set("minute",59).set("second",59).format("YYYY-MM-DD HH:mm:ss")),o["a"].DataCenter_liveHome(r).then((function(e){return t.proxyData(e),e.totalCount=+e.total,e.pageNo=+a.pageNo,e.data=e.liveList,e})).catch((function(e){var n={liveList:[]};return t.proxyData(n),n.totalCount=+n.total,n.pageNo=+a.pageNo,n.data=n.liveList,n}))}}},created:function(){var t=this;this.$root.eventHub.$on("refreshView",(function(){t.updateData()}))},beforeRouteLeave:function(t,a,e){this.$root.eventHub.$off("refreshView"),e()},methods:{updateData:function(){var t=this.$refs.table;t&&t.refresh(!0)},proxyData:function(t){var a=t.liveData,e=t.liveList,n=this.isOrgan?u["k"]:u["l"];return this.totalDatas=n.map((function(t){return Object.assign({},t,{value:a&&a[t.key]?a[t.key]:0})})),e||[]},resetQueryParams:function(){this.queryParam={},this.dates=[],this.updateData()},onChannelChange:function(){this.updateData()},handleInfo:function(t){this.$router.push("/data-center/live-detail/".concat(t.roomId))}}},h=d,f=e("2877"),p=Object(f["a"])(h,n,r,!1,null,null,null);a["default"]=p.exports}}]);